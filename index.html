<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/10/02/hello-world/" class="article-date">
  <time datetime="2015-10-02T07:32:05.157Z" itemprop="datePublished">2015-10-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/02/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start">Quick Start</h2><h3 id="Create_a_new_post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/10/02/hello-world/" data-id="cif9i0urn0007gco0g5ybdjne" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Computer-Graphic-Study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/08/29/Computer-Graphic-Study/" class="article-date">
  <time datetime="2015-08-29T10:28:18.000Z" itemprop="datePublished">2015-08-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Rendering/">Rendering</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/08/29/Computer-Graphic-Study/">Computer_Graphic_Study</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>参考书籍：<br>《OpenGL Programming Guide 8th Edition》 — Addison Wesley<br>《Fundamentals of Computer Graphics (3rd Edition)》 — Peter Shirley, Steve Marschnner<br>《Real-Time Rendering, Third Edition》 — Tomas Akenine-Moller, Eric Haines, Naty Hoffman</p>
<h1 id="Rendering_Knowledge">Rendering Knowledge</h1><p>在进入书籍内容的学习之前，先了解一些必要的知识</p>
<h2 id="What_is_Rendering?">What is Rendering?</h2><p>“Rendering is a process that takes as its input a set of objects and produces as its output an array of pixels.” — 《Fundamentals of Computer Graphics (3rd Edition)》</p>
<p>既然Rendering是通过处理一系列的对象数据最终输出成一组一组的像素呈现出来，那接下来的问题就是What is the rendering process(Graphic Pipeline)?</p>
<h2 id="What_is_the_rendering_process(Graphic_Pipeline)?">What is the rendering process(Graphic Pipeline)?</h2><p>首先我们来看看wiki上对pipieline的解释<br><a href="https://en.wikipedia.org/wiki/Graphics_pipeline" target="_blank" rel="external">the sequence of steps used to create a 2D raster representation of a 3D scene.</a><br>那么结合Rendering的定义，不难看出Rendering pipeline就是一系列的操作（把前一个操作的输出当做输入）使得输入的对象数据最终以像素的形式输出到屏幕上</p>
<p>Note:<br>“A chain is no stronger than its weakest link.”<br>                                        —Anonymous<br>渲染的速度是由最慢的阶段决定的。</p>
<p>图形渲染和GPU的是密不可分的。<br>渲染管线最大的变化就是从传统的固定渲染管线转变到了可编程的渲染管线。</p>
<p>在了解固定渲染管线和可编程渲染管线之前，先让我们来了解一下什么是Rendering Pipeline。</p>
<h3 id="Rendering_Pipeline_Stages">Rendering Pipeline Stages</h3><p><img src="/img/Graphic/Rendering_Stages.PNG" alt="Rendering_Stages"></p>
<ol>
<li><p>Application<br>e.g collision detection, global acceleration algorithms, animation, physics simulation….. (On CPU)<br>Acceleration algorithms, such as hierarchical view frustum culling, are also implemented in this stage. — 《Real-Time Rendering, Third Edition》<br>可以看出Application阶段主要是做一些非渲染相关的一些计算，但部分计算也可以帮助我们减少渲染数量提高渲染效率(比如:hierachical view frustum culling)</p>
</li>
<li><p>Geometry<br><img src="/img/Graphic/Geometry_Stage.PNG" alt="Geometry_Stage"><br>Deal with transforms, projection. Computes what is to be draw, how it should be drawn, and where it should be drawn (On GPU)<br>e.g. model and view transform, vertex shading, projection, clipping, and screen mapping — 《Real-Time Rendering, Third Edition》<br>可以看出Geometry阶段主要是负责3D到2D Screen的顶点运算和顶点剔除</p>
</li>
<li><p>Rasterizer<br><img src="/img/Graphic/Rasterize_Stage.PNG" alt="Rasterize_Stage"><br>Conversion from two-dimensional vertices in screen space – each with a z-value (depth value), and various shading information associated with each vertex – into pixels on the screen (On GPU) — 《Real-Time Rendering, Third Edition》<br>可以看出Rasterizer阶段主要是负责2D Screen的顶点像素运算(包括Z-Buffer test, Color computation, Alpha test, Stencil buffer等)</p>
</li>
</ol>
<p><strong>Accumulation Buffer</strong> — Images can be accumulated using a set of operators. E,g, motion blur……</p>
<p>让我们结合OpenGL Rendering Pipeline来学习理解：<br><img src="/img/OpenGL/OpenGL_Render_Pipeline.PNG" alt="OpenGL_Rendering_Pipeline"><br>从上图可以看出，OpenGL的第一个阶段Vertex Data相当于Application阶段所收集的数据</p>
<p>不难看出从Vertex Shader到Clipping都属于从3D到2D Screen的顶点运算和顶点剔除，所以这一部分处于Geometry阶段(由于后来统一架构的(US)原因，Vertex Shader, Geometry Shader, Pixel Shader很多)</p>
<p>而从Rasterization到最后的屏幕输出都是对像素的运算，所以是Rasterizer阶段<br><a href="http://tonytang1990.github.io/2015/08/26/OpenGL-Study/" target="_blank" rel="external">OpenGL更多的学习了解</a></p>
<p>了解了什么是Rendering Pipeline之后，让我们来看看什么是固定管线和可编程管线？他们之间的关系是怎样的？</p>
<h3 id="传统的固定渲染管线">传统的固定渲染管线</h3><p>什么叫做“像素渲染管线”了？<br>“<a href="http://vga.zol.com.cn/238/2386200_all.html" target="_blank" rel="external">传统的一条渲染管线是由包括Pixel Shader Unit（像素着色单元）+ TMU(纹理贴图单元) + ROP（光栅化引擎）三部分组成的。用公式表达可以简单写作：PS=PSU+TMU+ROP 。从功能上看，PSU完成像素处理，TMU负责纹理渲染，而ROP则负责像素的最终输出。所以，一条完整的像素管线意味着在一个时钟周期完成至少进行1个PS运算，并输出一次纹理。</a>”</p>
<p>那么什么是PSU(像素着色器单元)？什么是TMU(纹理贴图单元)？什么是ROP(光栅化引擎)了？<br>在统一渲染架构（US(Unified Shader)）出现之前有单独的<strong>顶点着色器单元</strong>和<strong>像素着色器单元</strong>，分别负责顶点数据和像素处理。</p>
<p><strong>TMU(纹理贴图单元 — Texture Mapping Unit)</strong><br><a href="http://vga.zol.com.cn/243/2433760_all.html" target="_blank" rel="external">归根到底就是对材质的贴图和过滤操作。根据程序的需要，在完成几何处理和光栅化之后，TMU单元会从材质库中找出合适的纹理贴在对应的位置上以实现模型的外形完整化</a>”<br>在可编程渲染管线(Shader)出现后，程序员可以实现对像素级别上的操作，可以实现更加真实的效果(预先烘焙的材质无法真实的实时渲染)。Vertex Texture Fetch(顶点纹理拾取)的出现允许Vertex Shader直接访问材质的一些信息，这也算是TMU进军GPGPU的一个契机。<br><a href="http://vga.zol.com.cn/243/2433760_all.html" target="_blank" rel="external">从DirectX 9.0C开始，TMU单元正式分割成了TA和TF两个部分，TA单元专门负责材质的定址操作，在完成定址之后，TF单元根据定址结果对材质进行拾取并完成贴图作业。</a><br>后续改进<a href="http://vga.zol.com.cn/243/2433760_all.html" target="_blank" rel="external">纹理阵列(处理材质操作的纹理单元阵列)以及Gather指令(Gather指令的作用，在于允许单元从非连续存储器地址中直接读取数据。)</a><br>Computer Shader的出现也使得纯数学的纹理计算成为了可能。</p>
<p><strong>ROP(光栅化引擎 — Render Output Units)</strong><br><a href="https://en.wikipedia.org/wiki/Render_output_unit" target="_blank" rel="external">The render output unit, often abbreviated as “ROP”, and sometimes called (perhaps more properly) raster operations pipeline.</a><br>Conversion from two-dimensional vertices in screen space – each with a z-value (depth value), and various shading information associated with each vertex – into pixels on the screen (On GPU) — 《Real-Time Rendering, Third Edition》</p>
<h3 id="可编程渲染管线">可编程渲染管线</h3><p>为什么会有可编程渲染管线了？<br>“<a href="http://vga.zol.com.cn/238/2386200_all.html" target="_blank" rel="external">由于传统的渲染管线不可编辑性，实现的图像效果受到很大限制，Shader(着色器)的引入就替代了传统的固定渲染管线，实现了可编程的渲染管线，各个Shader(着色器)替代了固定渲染管线中相应的功能。</a>”</p>
<p>那么什么是Shader(着色器)？Shader(着色器)和GPU硬件的关系是怎样的了？<br>“Shaders are programmed using C-like shading languages such as HLSL, Cg and GLSL. These are compiled to a machine-independent assembly language, also called the intermediate language(IL). This assembly language is converted to the actual machine language in a separate step, usually in the drivers. This arrangement allows compatibility across different hardware implementations.” — Real-Time Rendering, Third Edition》<br><a href="http://vga.zol.com.cn/238/2386200_all.html" target="_blank" rel="external">GPU的像素着色器单元和顶点着色器单元就对应了Shader里面的Pixel Shader和Vertex Shader。由于像素在计算机都是以RGB三种颜色构成，加上Alpha总共4个通道，所以GPU的像素着色器单元和顶点着色器单元一开始就被设计成为同时具备4次运算能力的算数逻辑运算器(ALU)</a></p>
<p>从上面可以看出Shader是machine-independent的，因为事先被编译成了与机器无关的intermediate language(This intermediate language can be seen as defining a <strong>virtual machine</strong>, which is targeted by the shading language compiler — 《Real-Time Rendering, Third Edition》)， 最后才会被机器转换成机器码来运行.</p>
<p>可编程Shading进化史可参考<br>3.3 The Evolution of Programmable Shading — 《Real-Time Rendering, Third Edition》</p>
<h2 id="计算机架构与Shader的关系">计算机架构与Shader的关系</h2><h3 id="非同一架构">非同一架构</h3><p>那么影响Pixel Shader和Vertex Shader速度的因素又是什么了？<br>数据流处理速度。</p>
<p>我们都知道计算机是通过发送指令来对数据进行处理的，而计算机架构则是对指令流和数据处理的设计，是影响数据流处理速度的关键。</p>
<p>根据Flynn分类法，计算机架构分为：</p>
<ol>
<li>SISD(Single Instruction Signle Data Stream) — 单指令单数据流<br>“<a href="http://vga.zol.com.cn/238/2386200_all.html" target="_blank" rel="external">传统的顺序执行的计算机在同一时刻只能执行一条指令（即只有一个控制流）、处理一个数据（即只有一个数据流），因此被称为单指令单数据流计算（Single Instruction Single Data Stream,SISD）</a>”</li>
<li>MIMD(Multiple Instruction Multiple Data Stream) — 多指令多数据流<br><img src="/img/Graphic/MIMD.PNG" alt="MIMD"><br>“<a href="http://vga.zol.com.cn/238/2386200_all.html" target="_blank" rel="external">而对于大多数并行计算机而言，多个处理单元都是根据不同的控制流程执行不同的操作，处理不同的数据，因此，它们被称作是多指令流多数据流计算机，即MIMD（Multiple Instruction Stream Multiple Data Stream，简称MIMD）计算机，它使用多个控制器来异步地控制多个处理器，从而实现空间上的并行性。</a>”</li>
<li>SIMD(Single Instruction Multiple Data Stream) — 单指令多数据流<br><img src="/img/Graphic/SIMD.PNG" alt="SIMD"></li>
<li>MISD(Multiple Instruction Single Data Stream) — 多指令多数据流</li>
</ol>
<p>那么各个计算机架构设计之间的优势和劣势分别是什么了？<br>还记得我们之前说的像素着色单元和顶点着色单元已开被设计成具备4次运算能力的算数逻辑运算器(ALU)吗？<br>因为数据的基本单元是Scalar(标量),GPU的ALU一个时钟周期可进行四次这种变量并行运算。<br>那么如果我们传入4D标量进行运算，SIMD可以最大程度满足我们的需求，达到GPU利用率100%。但如果我们传入1D标量进行运算，SIMD的效率就会下降到原来的四分之一（随着API的更新，1D/2D/3D等混合指令开始大幅出现），固传统的SIMD架构效率开始降低。而3D+1D/2D+2D等混合架构设计也并不能最大限度利用ALU运算能力，这也是统一架构出现的契机。</p>
<h3 id="统一架构">统一架构</h3><p>“<a href="http://vga.zol.com.cn/238/2386200_all.html" target="_blank" rel="external">为了解决ALU利用率的问题，微软在Direct X 10提出了统一渲染架构的概念。<br>核心思想是：将Vertex Shader(顶点着色器)和Pixel Shader(像素着色器)单元合并成一个具备完整执行能力的US(Unified Shader,统一渲染)单元，指令直接面向底层的ALU而非过去的特定单元，所以在硬件层面US可以同时吞吐一切shader指令，同时并不会对指令进行任何修改，也不会对shader program的编写模式提出任何的强迫性的改变要求。</a>”<br><img src="/img/Graphic/US.PNG" alt="US"></p>
<p>统一架构出来以后，因为有了US(Unified Shader)单元，指令直接面向底层的ALU而非特定单元，所以后来的N卡统一架构把原来的4D着色器单元完全打散，流处理器(SP)统统由矢量设计改为了标量运算单元(由4D矢量运算器改为了1D标量运算器)，采用的是MIMD架构。</p>
<p>MIMD架构相比SIMD架构需要占用更多的晶体管数，因为4个1D标量ALU和一个4D矢量ALU的运算能力是相当的，但前者需要4个指令发射端和4个控制单元，而后者只需要1个</p>
<p>而A卡的流处理器(SPU)依然采用的是SIMD(单指令多数据流)架构，每个SPU内包含了5个ALU。</p>
<p>“<a href="http://vga.zol.com.cn/238/2386200_all.html" target="_blank" rel="external">N卡A卡对比总结：英伟达的所采用的MIMD（多指令流多数据流）标量架构的G80核心需要占用不少额外的晶体管，所以在流处理器数量和理论运算能力方面稍显吃亏，但优点是GPU Shader执行效率很高；而AMD所采用的SIMD(单指令多数据流)超标量架构的R600核心则用较少的晶体管数实现了更多的流处理器数量和更高的理论运算能力，不过在执行效率方面则需要视情况而定了</a>”</p>
<p>N卡的第二次革新引入的atomic单元以及SIMT(Single Instruction Multiple Thread)特性对N卡并行化设计起到了先到作用。</p>
<p>“<a href="http://vga.zol.com.cn/238/2386200_all.html" target="_blank" rel="external">N卡的第三次革新引入了四大块就是GPC(Graphics Processing Cluster,图形处理器簇)，每个GPC单元包含独立的集合引擎以及光栅化流水线，GPC模块之间透过新加入的L2 cache进行通讯,kernel和Thread的协调以及数据共享。这无疑使得GF100的三角形吞吐量有了将近300%的提升，也实现了并行的分块化渲染动作，更使得DirectX 11所要求的TS单元直接融入到了整个光栅化流水线内部。</a>”<br><img src="/img/Graphic/NThird.PNG" alt="N_Third"><br><img src="/img/Graphic/N_PE_RE.PNG" alt="N_PE_RE"></p>
<p><a href="http://vga.zol.com.cn/238/2386200_all.html" target="_blank" rel="external">A卡第二第三次革新</a></p>
<h2 id="Shader_Virtual_Machine_(Shader_Model)">Shader Virtual Machine (Shader Model)</h2><p>了解了计算机架构与Shader的关系，让我们来看看Common-shader core virtual machine architecture and register layout吧<br><img src="/img/Graphic/Shader_Core_Virtual_Machine_Architecture.PNG" alt="Shader_Core_Virtual_Machine_Architecture_And_Register_Laout"></p>
<h3 id="Input_Type">Input Type</h3><ol>
<li><p>Uniform inputs<br>With values that remain constant throughout a draw call(but can be changed between draw calls) — accessed via read-only constant registers or constant buffers</p>
</li>
<li><p>Varying inputs<br>Which are different for each vertex or pixel processed by the shader — accessed via varying input registers</p>
</li>
</ol>
<h3 id="Shader_Knowledge">Shader Knowledge</h3><h4 id="Shader">Shader</h4><p>Shader programs can be compiled offline before program load or during run time. As with any compiler, there are options for generating different output files and for using different optimization levels. A compiled shader is stored as a string of text, which is passed to the GPU via the driver.</p>
<h4 id="MRT(Multiple_Render_Target)">MRT(Multiple Render Target)</h4><p><a href="https://en.wikipedia.org/wiki/Multiple_Render_Targets" target="_blank" rel="external">MRT is a feature of modern graphics processing units, that allows the programmable rendering pipeline to render images to multiple render target textures at once. These textures can then be used as inputs to other shaders or as texture maps applied to 3D models.</a><br>？不是非常明白这里。大概是一次渲染可以对象信息存储在多个buffer里，然后以texture的形式交给后续pass的pixel shader做处理<br><a href="https://en.wikipedia.org/wiki/Deferred_shading" target="_blank" rel="external">wiki上提到MRT的一个使用<strong>deferred shading</strong></a><br>在first pass的时候收集相应信息存储在特定buffer里，在second pass（真正的渲染绘制是在这里）的时候Pixel shader把这些信息用作渲染数据，把整个场景一次性渲染出来而不是针对每个空间物体进行光照，材质等渲染</p>
<h4 id="Effects">Effects</h4><h5 id="什么是Effects文件了？">什么是Effects文件了？</h5><p><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ff476136(v=vs.85" target="_blank" rel="external">A DirectX effect is a collection of pipeline state, set by expressions written in HLSL and some syntax that is specific to the effect framework</a>.aspx)</p>
<p>可以看出Effects文件主要是记录一系列的渲染状态和固定信息用于特定渲染流程里。</p>
<h5 id="为什么需要Effects文件了？">为什么需要Effects文件了？</h5><p>在我们事先特定效果的渲染时，不仅需要一系列的shader文件，我们同时会设定相应的渲染状态和一些固定的渲染信息，这些状态和信息对于特定效果来说是固定不变的，所以通过Effects文件可以有效的帮助我们记录特定效果所需的渲染状态等信息，方便重复使用。</p>
<h5 id="Effects_Languages">Effects Languages</h5><p>Such as HLSL FX, CgFX, and COLLADA FX</p>
<h3 id="Shader_Models_Comparision">Shader Models Comparision</h3><p><img src="/img/Graphic/Shader_Model_Comparision.PNG" alt="Shader_Models_Comparision"></p>
<h2 id="渲染总结">渲染总结</h2><p>可编程管线的出现主要是由于固定管线能实现的渲染效果有限不够灵活，Shader的出现象征着可编程管线的诞生。</p>
<p>统一渲染架构主要是为了提高ALU(算数逻辑运算器)利用率的问题。US(Unified Shader)单元的出现象征则统一渲染架构的开始，指令直接面向底层的ALU而非特定单元，流处理器的数量成为了性能的关键，流处理器的设计和架构紧密相关。（并行分块花渲染也随之出现）</p>
<p>“<a href="http://vga.zol.com.cn/238/2386200_all.html" target="_blank" rel="external">DX9到DX10是一大转折点：结束管线时代，开启GPU统一渲染架构时代。在DX9时代，大家都是通过“(像素)管线”来衡量显卡的性能等级，而到了DX10时代，统一渲染架构的引入使得显卡不再区分“像素”和“顶点”，因此“管线”这种说法逐渐淡出了大家的视野，取而代之的是全新统一渲染架构的“流处理器”，“流处理器”的数量直接影响着显卡的性能。</a>”</p>
<p><a href="http://tonytang1990.github.io/2015/08/26/OpenGL-Study/" target="_blank" rel="external">OpenGL更多的学习了解</a></p>
<h1 id="Reference_Website">Reference Website</h1><p><a href="https://en.wikipedia.org/wiki/Pipeline" target="_blank" rel="external">Pipeline</a><br><a href="http://vga.zol.com.cn/238/2386200_all.html" target="_blank" rel="external">GPU架构</a><br><a href="http://vga.zol.com.cn/243/2433760_all.html" target="_blank" rel="external">TMU(纹理贴图单元)</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/08/29/Computer-Graphic-Study/" data-id="cif9i0us1000ngco0e1foajn6" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenGL/">OpenGL</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-OpenGL-Study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/08/26/OpenGL-Study/" class="article-date">
  <time datetime="2015-08-26T15:57:05.000Z" itemprop="datePublished">2015-08-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Rendering/">Rendering</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/08/26/OpenGL-Study/">OpenGL_Study</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>时隔将近一年了，再次拾起了还未学完的OpenGL，这一年工作生活学习状态都不好，希望这一次能重新好好的把OpenGL学好，把图形渲染的基础知识掌握好</strong>  — 游戏梦</p>
<p>参考书籍：<br>《OpenGL Programming Guide 8th Edition》 — Addison Wesley<br>《Fundamentals of Computer Graphics (3rd Edition)》 — Peter Shirley, Steve Marschnner<br>《Real-Time Rendering, Third Edition》 — Tomas Akenine-Moller, Eric Haines, Naty Hoffman</p>
<p><a href="http://blog.sina.com.cn/tonytang1990" target="_blank" rel="external">旧博客地址</a></p>
<p><a href="http://tonytang1990.github.io/2015/08/29/Computer-Graphic-Study/" target="_blank" rel="external">渲染相关概念学习</a></p>
<h1 id="OpenGL">OpenGL</h1><h2 id="Introdction_to_OpenGL">Introdction to OpenGL</h2><h3 id="What_is_OpenGL?">What is OpenGL?</h3><ol>
<li>OpenGL is an application programming interface – “API” for short – which is merely a software library for accessing features in graphics hardware.(访问图形硬件设备功能的API)</li>
<li>OpenGL is a “C” language library(OpenGL是一个C语言库)</li>
</ol>
<h3 id="History">History</h3><p>It was first developed at Silicon Graphics Computer Systems with Version 1,0 released in July of 1994(<a href="https://zh.wikipedia.org/zh/OpenGL" target="_blank" rel="external">wiki</a>)</p>
<h2 id="OpenGL_relative_knowledge">OpenGL relative knowledge</h2><ol>
<li>Install the appropriate graphic driver which enables usage of the functionality provided.<br> check the graphic drive update.(更新显卡驱动获得最新的OpenGL版本支持)</li>
<li>Using OpenGL extensions viewer to check which OpenGL version is supported(查看当前硬件所支持的OpenGL版本)<br> <a href="http://www.realtech-vr.com/glview/download.php" target="_blank" rel="external">download website</a></li>
<li><p>Extention tools  — help us to quick start to learn OpenGL</p>
<ol>
<li><p><a href="http://zh.wikipedia.org/wiki/GLUT" target="_blank" rel="external">Glut (OpenGL Utility Toolkit)</a><br> GLUT（英文全写：OpenGL Utility Toolkit）是一个处理OpenGL程式的工具库，负责处理和底层操作系统的呼叫以及I/O，并包括了以下常见的功能：</p>
<ol>
<li>定义以及控制视窗</li>
<li>侦测并处理键盘及鼠标的事件</li>
<li>以一个函数呼叫绘制某些常用的立体图形，例如长方体、球、以及犹他茶壶（实心或只有骨架，如glutWireTeapot()）</li>
<li><p>提供了简单选单列的实现</p>
<p>GLUT是由Mark J. Kilgard在Silicon Graphics工作时所写，此人同时也是OpenGL Programming for the X Window System以及The Cg Tutorial: The Definitive Guide to Programmable Real-Time Graphics两书的作者。</p>
<p>GLUT的两个主要目的是建立一个跨平台的函式库（事实上GLUT就是跨平台的），以及简化学习OpenGL的条件。透过GLUT编写OpenGL通常只需要增加几行额外GLUT的程式码，而且不需要知道每个不同操作系统处理视窗的API。</p>
<p>所有的GLUT函数都以glut作为开头，例如glutPostRedisplay()。</p>
</li>
</ol>
</li>
<li><a href="http://en.wikipedia.org/wiki/OpenGL_Extension_Wrangler_Library" target="_blank" rel="external">Glew ( OpenGL Extension Wrangler Library)</a><br> The OpenGL Extension Wrangler Library (GLEW) is a cross-platform C/C++ library that helps in querying and loading OpenGL extensions. GLEW provides efficient run-time mechanisms for determining which OpenGL extensions are supported on the target platform. All OpenGL extensions are exposed in a single header file, which is machine-generated from the official extension list.(Glew是一个支持跨平台的C/C++库，用于运行时鉴别OpenGL扩展所支持的版本)<br> <a href="http://www.opengl.org/sdk/tools/" target="_blank" rel="external">more info for extention tools</a></li>
</ol>
</li>
<li><p>Using extention tools — Glu &amp; Glew</p>
<ol>
<li>add glu.lib &amp; glew.lib into additional dependencies</li>
<li>add the directory that includes glu.h &amp; glew.h into include dirctory</li>
</ol>
</li>
<li><p>Understand OpenGL render pipeline<br><img src="/img/OpenGL/OpenGL_Render_Pipeline.PNG" alt="OpenGL Render Pipeline"></p>
<ol>
<li><p>Vertex Data<br> Sending Data to OpenGL</p>
</li>
<li><p>Vertex Shader<br> Process the data associated with that vertex</p>
</li>
<li><p>Tessellation Shader<br> Tessellation uses patchs to describe an object’s shape, and allows relatively simple collections of patch geometry to be tessellated to increase the number of geometric primitives providing better-looking models (eg: LOD) </p>
</li>
<li><p>Geometry Shader<br> Allows additional processing of individual geometric primitives, including creating new ones, before rasterization</p>
</li>
<li><p>Primitive Assembly<br>Organizes the vertices into their associated geometric primitives in preparation for clipping and rasterization </p>
</li>
<li><p>Clipping<br> Clip the vertex and pixels are outside of the viewport – this operation is handled automatically by OpenGL</p>
</li>
<li><p>Rasterization<br> Fragment generation. Pixels have a home in the framebuffer, while a fragment still can be rejected and never update its associated pixel location. </p>
</li>
<li><p>Fragment Shading<br> Use a fragment shading to determine the fragment’s final color, and potentially its depth value</p>
</li>
<li><p>Per-Fragment Operations<br> If a fragment successfully makes it through all of the enabled tests (eg: depth testing, stencil testing), it may be written directly to the framebuffer, updating the color of its pixel, or if blending is enabled, the fragment’s color will be combined with the pixel’s current color to generate a new color that is written into the framebuffer</p>
</li>
</ol>
<p>Note:<br>Fragment’s visibility is determined using depth testing and stencil testing<br>Pixel data is usually stored in texture map for use with texture mapping, which allows any texture stage to look up data values from one or more texture maps.</p>
</li>
<li><p><a href="http://zh.wikipedia.org/wiki/GLSL" target="_blank" rel="external">Understand OpenGL Shader Language (GLSL)</a><br> GLSL - OpenGL Shading Language 也称作 GLslang，是一个以C语言为基础的高阶着色语言。它是由 OpenGL ARB 所建立，提供开发者对绘图管线更多的直接控制，而无需使用汇编语言或硬件规格语言。</p>
<p> 编译和执行<br> GLSL 着色器不是独立的应用程式；其需要使用 OpenGL API 的应用程式。C、C++、C#、Delphi 和 Java 皆支援 OpenGL API，且支援 OpenGL 着色语言。<br> GLSL 着色器本身只是简单的字串集，这些字串集会传送到硬件厂商的驱动程式，并从程式内部的 OpenGL API 进入点编译。着色器可从程式内部或读入纯文字档来即时建立，但必须以字串形式传送到驱动程式。</p>
<p> 工具<br> GLSL 着色器可以事先建立和测试，现有以下 GLSL 开发工具：<br> RenderMonkey - 这个软件是由 ATI 制作的，提供界面用以建立、编译和除错 GLSL 着色器，和 DirectX 着色器一样。仅能在 Windows 平台上执行。<br> GLSLEditorSample - 在 Mac OS X 上，它是目前唯一可用的程式，其提供着色器的建立和编译，但不能除错。它是 cocoa 应用程式，仅能在 Mac OS X 上执行。<br> Lumina - Lumina 是新的 GLSL 开发工具。其使用 QT 界面，可以跨平台。</p>
</li>
<li><p>OpenGL Shader Fundamentals</p>
</li>
<li><p>The color space that is used by OpenGL<br> In OpenGL, colors are represented in what’s called the RGB color space</p>
</li>
</ol>
<h2 id="OpenGL_learning_journal">OpenGL learning journal</h2><h3 id="API">API</h3><ol>
<li>查看哪些错误标志位被设置<br>了解：<br>  OpenGL在内部保留了一组错误标志位(共4个),其中每一个标志位代表一种不同类型的错误。当错误一个发生时，与这个错误对应的标志就会被设置。如果被设置的标志不止一个，glGetError仍然只返回一个唯一的值。当glGetError函数被调用时，这个值随后被清除，然后在glGetError再次被调用时将返回一个错误标志或GL_NO_ERROR为止</li>
</ol>
<p>函数：<br>Glenum glGetError(void); </p>
<ol>
<li><p>查询OpenGL的渲染引擎（OpenGL驱动程序）的生产商和版本号<br>了解：<br> OpenGL允许提供商通过它的扩展机制进行创新。为了使用特定供应商所提供的一些特定扩展功能，我们希望限制这个特定供应商所提供驱动程序的最低版本号。<br>函数：<br>const Glubyte *glGetString(GLenum name);</p>
</li>
<li><p>设置和查询管线的状态<br>了解：<br>  OpenGL使用状态模型来跟踪所有的OpenGL状态变量来实现对OpenGL渲染状态的控制<br>函数：<br>void glEnable(GLenum capability);<br>void glDisable(GLenum capability);<br>void glGet<em>(Type)v(GLenum pname, GLboolean </em>params);</p>
</li>
<li><p>查询program的一些相关信息和一些错误信息<br>了解：<br> OpenGL的pragram链接可能由于GLSL里面的一些错误导致出错，我们需要知道关于program object的一些相关错误信息，同时我们也想知道我们现有的program相关的一些信息<br>函数：<br>void glGetProgramiv(GLuint program, GLenum pname, GLint *params);</p>
</li>
<li><p>得到shader链接出错的log信息<br>了解：<br> OpenGL的shader object可能链接失败，我们需要知道shader里面出错的信息<br>函数：<br>void glGetProgramInfoLog(GLuint program, GLsizei maxLength, GLsizei <em>length, GLchar </em>infoLog);</p>
</li>
</ol>
<p>注意:<br>可以通过glGetProgramiv()去得到program的一些log相关信息，比如GL_INFO_LOG_LENGTH</p>
<h3 id="OpenGL_Knowledge:">OpenGL Knowledge:</h3><pre><code>1. "OpenGL <span class="operator"><span class="keyword">Execute</span> Model: 
    The model <span class="keyword">for</span> interpretation <span class="keyword">of</span> OpenGL commands <span class="keyword">is</span> client-<span class="keyword">server</span>. An application (the client) issues commands, which <span class="keyword">are</span> interpreted <span class="keyword">and</span> processed <span class="keyword">by</span> OpenGL (the <span class="keyword">server</span>). The <span class="keyword">server</span> may <span class="keyword">or</span> may <span class="keyword">not</span> operate <span class="keyword">on</span> the same computer <span class="keyword">as</span> the client. <span class="keyword">In</span> this sense, OpenGL <span class="keyword">is</span> network-transparent. <span class="string">"

2. "</span>client-<span class="keyword">server</span> 模式:
    OpenGL 是一种 client-<span class="keyword">server</span> 模式，当你的应用程序调用 OpenGL 函数时， 它将告诉OpenGL client， 然后 client 将渲染命令传送给 <span class="keyword">server</span>. 这里client 和 <span class="keyword">server</span>可能是不同的计算机，或是同一台计算机上的不同进程。一般来说 <span class="keyword">server</span> 是在 GPU上处理的， 而 client 是在 CPU 上处理的，这样分担了 CPU 的负担， 同时高效利用了GPU.<span class="string">"</span></span>
</code></pre><p>但如果Client和Server没在同一个机器上，我们就需要一种一种网络传输协议框架来实现他们之间的交流：<br><a href="http://blog.chinaunix.net/uid-28959509-id-3762988.html" target="_blank" rel="external">X Window System</a></p>
<p>但X Window System里的client和server与传统的C/S模式相反，client是负责运算的，server是负责显示的。<br>但OpenGL的client和server的交流原理是与X Window System相似的</p>
<h1 id="Reference_Website:">Reference Website:</h1><p><a href="http://www.opengl.org/sdk/docs/man4/" target="_blank" rel="external">OpenGL 4 reference page</a><br><a href="http://blog.csdn.net/guolihui112/article/details/5702915" target="_blank" rel="external">client-server 模式</a><br><a href="http://www.glprogramming.com/blue/ch01.html" target="_blank" rel="external">OpenGL Execute Model</a><br><a href="http://blog.chinaunix.net/uid-28959509-id-3762988.html" target="_blank" rel="external">X Window System</a></p>
<p>Note:<br><strong>OpenGL uses right-handed coordinate system (OpenGL使用右手坐标系)</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/08/26/OpenGL-Study/" data-id="cif9i0ury000igco0pmo6cjiw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenGL/">OpenGL</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-CSharp-Study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/08/15/CSharp-Study/" class="article-date">
  <time datetime="2015-08-15T06:30:53.000Z" itemprop="datePublished">2015-08-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Programming-Language/">Programming Language</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/08/15/CSharp-Study/">C# Study</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="-Net_Framework">.Net Framework</h1><h2 id="Introduction">Introduction</h2><p>.Net Framework是Microsoft为开发应用程序而创建创的一个具有革命意义的平台。</p>
<h2 id="Content">Content</h2><p>.Net Framework主要包含一个非常大的代码库，可以在客户语言中通过面向对象编程技术来使用这些代码。这个库分为多个不同的模块。</p>
<p>.Net Framework还包含.NET公共语言运行库(Common Language Runtime, CLR)，它负责管理用.NET库开发的所有应用程序的执行</p>
<h2 id="Using_-NET_Framework">Using .NET Framework</h2><h3 id="Tools">Tools</h3><ol>
<li>Visual Studio</li>
<li>VCE(for C#)</li>
</ol>
<h3 id="Compile_process">Compile process</h3><ol>
<li><p>CIL(Common Intermediate Language)<br>首先把代码编译成通用中间语言(Common Intermediate Language, CIL)代码<br><img src="/img/CSharp/CSharp_Compile_Process1.PNG" alt="编译到程序集"></p>
</li>
<li><p>JIT(Just-In-Time)<br>把CIL编译为专用于OS和目标机器结构的机器代码<br><img src="/img/CSharp/CSharp_Compile_Process2.PNG" alt="编译为本机代码"></p>
</li>
</ol>
<h3 id="程序集">程序集</h3><p>编译程序时所创建的CIL代码存储在一个程序集中（e.g. .exe .dll）<br>程序集包含程序用到的相关数据信息</p>
<h3 id="托管代码">托管代码</h3><p>CLR管理着应用程序，其方式是管理内存，处理安全性以及允许进行跨语言调试等。相反，不受CLR控制运行着的应用程序属于非托管类型。<br><img src="/img/CSharp/CSharp_Compile_Process3.PNG" alt="托管到CLR运行"></p>
<h3 id="垃圾回收">垃圾回收</h3><p>托管代码中的一个功能GC(garbage collection)</p>
<h3 id="链接">链接</h3><p>模块化</p>
<h1 id="CSharp">CSharp</h1><h2 id="Introduction-1">Introduction</h2><p>C#是可用于创建要运行在.NET CLR上的应用程序的语言之一，它从C和C++语言演化而来，是Microsoft专门为使用.NET平台而创建的。</p>
<h2 id="Features">Features</h2><ol>
<li>语法简单</li>
<li>类型安全</li>
<li>为.NET Framework设计的语言</li>
</ol>
<h2 id="Development">Development</h2><p>Application Type</p>
<ol>
<li>Windows Appliaction Program</li>
<li>Web Application Program</li>
<li>Web Service</li>
</ol>
<h2 id="Language_Study">Language Study</h2><p>Only record some difference between C# and C++/Java</p>
<h3 id="1-_delegate">1. delegate</h3><p>(C++里用函数指针实现,Java里通过内部类的闭包和interface去实现)<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">CSharpStudy</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">delegate</span> <span class="keyword">void</span> <span class="title">testDelegate</span>(<span class="params"><span class="keyword">string</span> para</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">doSomething</span>(<span class="params"><span class="keyword">string</span> para</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            Console.WriteLine(<span class="string">"doSomething:"</span> + para);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="keyword">string</span>[] args</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="preprocessor">#<span class="keyword">region</span> method 1 to use delegate</span></span><br><span class="line">	        testDelegate delegate1;</span><br><span class="line">            delegate1 = <span class="keyword">new</span> testDelegate(doSomething);</span><br><span class="line">            <span class="preprocessor">#<span class="keyword">endregion</span></span></span><br><span class="line">            delegate1(<span class="string">"delegate1"</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="preprocessor">#<span class="keyword">region</span> method 2 to use delegate(lambda expression)</span></span><br><span class="line">            testDelegate delegate2 = s =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">"doSomething:"</span> + s);</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="preprocessor">#<span class="keyword">endregion</span></span></span><br><span class="line">            delegate2(<span class="string">"delegate2"</span>);</span><br><span class="line">              </span><br><span class="line">           <span class="preprocessor">#<span class="keyword">region</span> method 3 to use delegate(anonymous method)</span></span><br><span class="line">            testDelegate delegate3 = <span class="keyword">delegate</span>(<span class="keyword">string</span> para)</span><br><span class="line">           &#123;</span><br><span class="line">               Console.WriteLine(<span class="string">"delegate3's para = "</span> + para);</span><br><span class="line">           &#125;;</span><br><span class="line">           <span class="preprocessor">#<span class="keyword">endregion</span></span></span><br><span class="line">           delegate3(<span class="string">"delegate3"</span>);</span><br><span class="line">           Console.ReadKey();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Output:<br><img src="/img/CSharp/CSharp_Delegate.PNG" alt="CSharp_Delegate"></p>
<h3 id="2-_Class_&amp;_interface">2. Class &amp; interface</h3><ol>
<li>Class qualifier<br>internal class — only code in current project can access (default)<br>public class — other project code can access</li>
</ol>
<p>abstract class — abstract class<br>sealed class — cant not be inheritated</p>
<p>Note:<br>Compiler is not allowed derived class’s access privileges higher than parent class</p>
<p>e.g.<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">MyBase</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">MyBase</span>(<span class="params"></span>)</span><br><span class="line">   </span>&#123;</span><br><span class="line">       </span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Cant do like this due to Child class access previlage is higher than parent class</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyChild</span> <span class="comment">/*: MyBase*/</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">MyChild</span>(<span class="params"></span>)</span><br><span class="line">   </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>support extends multiple interface<br>Note:<br>base class must be write down first when we inherites from one class and extends several interface<br>abstract &amp; sealed can not be used by interface due to no implementation in interface (abstract &amp; sealed qualifier are meaningless)</p>
<ol>
<li>Static constructor &amp; Static class<br>静态构造函数只会被调用一次且属于整个类<br>静态类不能拥有实例构造函数且只能有static成员<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">CSharpStudy</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">class</span> <span class="title">StaticConstructor</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function"><span class="keyword">static</span> <span class="title">StaticConstructor</span>(<span class="params"></span>)</span><br><span class="line">            </span>&#123;</span><br><span class="line">                Console.WriteLine(<span class="string">"Static StaticConstructor()"</span>);</span><br><span class="line">                m_ID = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="title">StaticConstructor</span>(<span class="params"></span>)</span><br><span class="line">            </span>&#123;</span><br><span class="line">                Console.WriteLine(<span class="string">"Normal StaticConstructor()"</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> m_ID;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">StaticClass</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">/*</span><br><span class="line">            //Cant have instance constructor (do not know why static constructor neither)</span><br><span class="line">            static StaticClass()</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine("StaticClass()");</span><br><span class="line">                m_ID = 2;</span><br><span class="line">                m_Type = "Static";</span><br><span class="line">            &#125;</span><br><span class="line">            */</span></span><br><span class="line">            <span class="comment">//Can not non static member</span></span><br><span class="line">            <span class="comment">//public int m_Test = 3; </span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> m_ID = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">string</span> m_Type = <span class="string">"Static"</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="keyword">string</span>[] args</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">           StaticConstructor sc = <span class="keyword">new</span> StaticConstructor();</span><br><span class="line">           Console.WriteLine(<span class="string">"StaticConstructor::m_ID = "</span> + StaticConstructor.m_ID);</span><br><span class="line"></span><br><span class="line">           Console.WriteLine(<span class="string">"StaticClass::m_ID = "</span> + StaticClass.m_ID);</span><br><span class="line">           Console.WriteLine(<span class="string">"StaticClass::m_Type = "</span> + StaticClass.m_Type);</span><br><span class="line"></span><br><span class="line">           Console.ReadKey();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>Output:<br><img src="/img/CSharp/Static_Constructor_And_Static_Class.PNG" alt="Static_Constructor_And_Static_Class"></p>
<h3 id="3-_Not_supported_multiple_inherit">3. Not supported multiple inherit</h3><p>C++支持多重继承，Java通过extend多个Interface来实现多重继承<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Base1</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Base1</span>(<span class="params"></span>)</span><br><span class="line">   </span>&#123;</span><br><span class="line">       Console.WriteLine(<span class="string">"Base1()"</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Base2</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Base2</span>(<span class="params"></span>)</span><br><span class="line">   </span>&#123;</span><br><span class="line">       Console.WriteLine(<span class="string">"Base1()"</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Child</span> : <span class="title">Base1</span><span class="comment">/*, Base2*/</span><span class="comment">//Not support multiple inherit</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Child</span>(<span class="params"></span>)</span><br><span class="line">   </span>&#123;</span><br><span class="line">       Console.WriteLine(<span class="string">"Child()"</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">   Child c = <span class="keyword">new</span> Child();</span><br></pre></td></tr></table></figure></p>
<h3 id="4-_Class_member">4. Class member</h3><p>access qualifier<br>public, private, internal, protected</p>
<p>readonly — only can be initilized in constructor or declaration</p>
<p>property &amp; field<br>property gives more control to field access</p>
<p>accessor privilege — can not be higher than the access privilege that it is belonged to<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Accessor</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Accessor</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        m_A = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> IntA</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> m_A;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//Can not be public due to IntA's access privilege is lower than public</span></span><br><span class="line">        <span class="comment">//public set</span></span><br><span class="line">        <span class="keyword">set</span></span><br><span class="line">        &#123;</span><br><span class="line">            m_A = <span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> m_A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol>
<li><p>member function<br> override key word can hide base function(works with polymorphism)<br> Access base function that has been hiden uses base key word in child class</p>
</li>
<li><p>Interface member<br> all interface member must be public<br> can not use static, virtual, abstract, sealed</p>
</li>
<li><p>Interface implementation<br>explicit implementation — only can be accessed through interface (return type interface.functionanme(para))<br>implicit implementation — can be accessd through both interface and class</p>
</li>
<li><p>partial class definition &amp; partial property<br> can put class member, property, method, field into several files(partial key word)<br> Partial property is always static and withought return value</p>
</li>
</ol>
<h3 id="3-_Struct_&amp;_Class">3. Struct &amp; Class</h3><p>Struct is value type<br>Class is reference type</p>
<p>Shallow copy &amp; Deep copy<br>Shallow copy will only copy value type member, reference type member will use original one(System.Object.MemberwiseClone())</p>
<p>Deep copy  will copy all member value instead of reference(implememnt ICloneable::Clone())</p>
<h3 id="4-_Collection_class_(System-Collection)">4. Collection class (System.Collection)</h3><p>好比C++里的STL里的container<br>Our own collection (extends CollectionBase Class || DictionaryBase)</p>
<h3 id="5-_Comparasion">5. Comparasion</h3><ol>
<li><p>Type comparasion<br>System.Object.GetType()<br>&amp;&amp;<br>typeof()<br>&amp;&amp;<br>is operator — is specific type or type can be cast</p>
<ol>
<li>boxing — cast value type into System.Object type(shollow copy) or interface type that is implemented by value type</li>
<li>unboxing — boxing reverse process</li>
</ol>
</li>
<li><p>Value comparasion<br>operator overloading — must be static<br>IComparable — compare object’s data with the same type<br>&amp;&amp;<br>IComparer — compare two object with different type or the same type</p>
</li>
</ol>
<h3 id="6-_Conversion">6. Conversion</h3><p>Conversion operator<br>implici<br>explicit<br>e.g.<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">A</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">implicit</span> <span class="keyword">operator</span> <span class="title">B</span>(<span class="params">A a</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		......</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">B</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">explicit</span> <span class="keyword">operator</span> <span class="title">A</span>(<span class="params">B b</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		......</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>as operator</p>
<p><operand> as <type><br>Suit case</type></operand></p>
<ol>
<li>operand type is type</li>
<li>operand type can be casted into type implicitly</li>
<li>operand can be boxing into type</li>
</ol>
<h3 id="7-_Generics">7. Generics</h3><p>C++里是template实现<br>System.Collections.Generic<br>value type can not be initilized with null<br>Problem</p>
<ol>
<li>null (value type or reference type)<ol>
<li>default key word — if it is reference type, initilized with null. otherwise use default value</li>
</ol>
</li>
<li>type<ol>
<li>constraining<br> where key words<br> e.g.<br> class A<t>: where T:B 9( T must inherite from B)<br>Code e.g.<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">   using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Text;</span><br><span class="line">using System.Collections;</span><br><span class="line"></span><br><span class="line">namespace CSharpStudy</span><br><span class="line">&#123;</span><br><span class="line">    class Program</span><br><span class="line">    &#123;</span><br><span class="line">        //Can not instantiation with int when where T1 : class </span><br><span class="line">        //public class GenericClass&lt;T1&gt; where T1 : class</span><br><span class="line">        public class GenericClass&lt;T1&gt; : IEnumerable&lt;T1&gt; where T1 : struct</span><br><span class="line">        &#123;</span><br><span class="line">            private List&lt;T1&gt; m_Member = new List&lt;T1&gt;();</span><br><span class="line"></span><br><span class="line">            public GenericClass()</span><br><span class="line">            &#123;</span><br><span class="line">                //use T1's default value</span><br><span class="line">                //m_Member.Add(default(T1));</span><br><span class="line">            &#125;</span><br><span class="line">            public List&lt;T1&gt; GetMember</span><br><span class="line">            &#123;</span><br><span class="line">                get</span><br><span class="line">                &#123;</span><br><span class="line">                    return m_Member;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            public IEnumerator&lt;T1&gt; GetEnumerator()</span><br><span class="line">            &#123;</span><br><span class="line">                return m_Member.GetEnumerator();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            IEnumerator IEnumerable.GetEnumerator()</span><br><span class="line">            &#123;</span><br><span class="line">                return m_Member.GetEnumerator();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            public static implicit operator List&lt;T1&gt;(GenericClass&lt;T1&gt; gc)</span><br><span class="line">            &#123;</span><br><span class="line">                List&lt;T1&gt; result = new List&lt;T1&gt;();</span><br><span class="line">                foreach (T1 i in gc)</span><br><span class="line">                &#123;</span><br><span class="line">                    result.Add(i);</span><br><span class="line">                &#125;</span><br><span class="line">                return result;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            public static GenericClass&lt;T1&gt; operator +(GenericClass&lt;T1&gt; gc, List&lt;T1&gt; l)</span><br><span class="line">            &#123;</span><br><span class="line">                GenericClass&lt;T1&gt; result = new GenericClass&lt;T1&gt;();</span><br><span class="line">                foreach (T1 m in gc)</span><br><span class="line">                &#123;</span><br><span class="line">                    result.GetMember.Add(m);</span><br><span class="line">                &#125;</span><br><span class="line">                foreach (T1 m in l)</span><br><span class="line">                &#123;</span><br><span class="line">                    if (!result.GetMember.Contains(m))</span><br><span class="line">                    &#123;</span><br><span class="line">                        result.GetMember.Add(m);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                return result;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        static void Main(string[] args)</span><br><span class="line">        &#123;</span><br><span class="line">           //Nullable problem, </span><br><span class="line">           //value type can not be initiated with null</span><br><span class="line">           //int normalint = null;</span><br><span class="line">           System.Nullable&lt;int&gt; nullableint = null;</span><br><span class="line">           //nullable</span><br><span class="line">           int? nullalbleint = null;</span><br><span class="line">           int? result = nullalbleint ?? 5;</span><br><span class="line">           Console.WriteLine("result = " + result);</span><br><span class="line">           List&lt;int&gt; list = new List&lt;int&gt;(2);</span><br><span class="line">           list.Add(1);</span><br><span class="line">           list.Add(2);</span><br><span class="line">           foreach (int i in list)</span><br><span class="line">           &#123;</span><br><span class="line">               Console.WriteLine("list value = " + i);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           GenericClass&lt;int&gt; gc = new GenericClass&lt;int&gt;();</span><br><span class="line">           Console.WriteLine("gc.m_Member = " + gc.GetMember);</span><br><span class="line"></span><br><span class="line">           GenericClass&lt;int&gt; gc2 = new GenericClass&lt;int&gt;();</span><br><span class="line">           gc2.GetMember.Add(11);</span><br><span class="line">           gc2.GetMember.Add(111);</span><br><span class="line">           GenericClass&lt;int&gt; gc3 = new GenericClass&lt;int&gt;();</span><br><span class="line">           gc3.GetMember.Add(11);</span><br><span class="line">           gc3.GetMember.Add(22);</span><br><span class="line">           gc3.GetMember.Add(222);</span><br><span class="line"></span><br><span class="line">           gc = gc2 + gc3;</span><br><span class="line">           foreach (int i in gc)</span><br><span class="line">           &#123;</span><br><span class="line">               Console.WriteLine("gc member = " + i);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           Console.ReadKey();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</t></li>
</ol>
</li>
</ol>
<p>Output:<br><img src="/img/CSharp/Generic.PNG" alt="Generic"></p>
<p>Variance (变体)</p>
<ol>
<li>Convariance — 协变 out key word<br>主要用于Interface和delegate的返回类型或者参数类型的隐士转换（子类到父类）</li>
<li>Contravariance — 抗变 int key word<br>与协变相反（父类到子类）<br>Code e.g.<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Covariance</span></span><br><span class="line">   <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ListAnimals</span>(<span class="params">IEnumerable&lt;Animal&gt; animals</span>)</span><br><span class="line">   </span>&#123;</span><br><span class="line">       <span class="keyword">foreach</span> (Animal animal <span class="keyword">in</span> animals)</span><br><span class="line">       &#123;</span><br><span class="line">          Console.WriteLine(animal.ToString());</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FeeAnimal</span>(<span class="params">Func&lt;Animal&gt; animalCreator</span>)</span><br><span class="line">   </span>&#123;</span><br><span class="line">       <span class="keyword">var</span> animal = animalCreator();</span><br><span class="line">       Console.WriteLine(<span class="string">"animal.name = "</span> + animal.Name);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FeeAnimal</span>(<span class="params">Func&lt;Cow&gt; animalCreator</span>)</span><br><span class="line">   </span>&#123;</span><br><span class="line">       <span class="keyword">var</span> animal = animalCreator();</span><br><span class="line">       Console.WriteLine(<span class="string">"animal.name = "</span> + animal.Name);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">static</span> Cow <span class="title">CreateCow</span>(<span class="params"></span>)</span><br><span class="line">   </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> Cow(<span class="string">"DelegateCow"</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//Contravariance</span></span><br><span class="line">   <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FeeAnimal</span>(<span class="params">Animal animal</span>)</span><br><span class="line">   </span>&#123;</span><br><span class="line">       Console.WriteLine(<span class="string">"FeeAnimal:"</span> + animal.Name);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Execute</span>(<span class="params">Action&lt;Cow&gt; cact</span>)</span><br><span class="line">   </span>&#123;</span><br><span class="line">       cact(<span class="keyword">new</span> Cow(<span class="string">"ExecuteCow"</span>));</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//Covariance</span></span><br><span class="line">   List&lt;Cow&gt; cows = <span class="keyword">new</span> List&lt;Cow&gt;();</span><br><span class="line">   cows.Add(<span class="keyword">new</span> Cow(<span class="string">"Cow1"</span>));</span><br><span class="line">   ListAnimals(cows);</span><br><span class="line"></span><br><span class="line">   FeeAnimal(CreateCow);</span><br><span class="line">   Func&lt;Cow&gt; cFunc = CreateCow;</span><br><span class="line">   Func&lt;Animal&gt; aFunc = cFunc;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//Contravariance</span></span><br><span class="line">   Action&lt;Animal&gt; aAct = FeeAnimal;</span><br><span class="line">   Action&lt;Cow&gt; cAct = aAct;</span><br><span class="line"></span><br><span class="line">   Execute(aAct);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>Output:<br><img src="/img/CSharp/Variance_Contravariance.PNG" alt="Variance_Contravariance"></p>
<p>Note:<br>C++是通过编译器检测出模板使用的特定类型<br>C#是运行时进行</p>
<ol>
<li>Event<br>C#里的Event响应delegate好比C++里的回调 — 当事件发生时调用<br>event key word</li>
</ol>
<p>待续……</p>
<p>参考书籍下载：<br><a href="http://download.csdn.net/download/baiyu9821179/4282298" target="_blank" rel="external">C#入门经典第五版</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/08/15/CSharp-Study/" data-id="cif9i0uk30000gco0oecmgk10" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Programming/">Programming</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Unity-Study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/15/Unity-Study/" class="article-date">
  <time datetime="2015-07-15T15:48:26.000Z" itemprop="datePublished">2015-07-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Game-Engine/">Game_Engine</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/15/Unity-Study/">Unity Study</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Unity_Introduction">Unity Introduction</h1><h2 id="What_is_Unity?">What is Unity?</h2><p>Unity is a cross-platform game engine developed by Unity Technologies and used to develop video games for PC, consoles, mobile devices and websites. First released on June 8, 2005<br>(<a href="https://en.wikipedia.org/wiki/Unity_(game_engine" target="_blank" rel="external">from wiki</a>))</p>
<h2 id="Why_should_we_study_Unity?">Why should we study Unity?</h2><ol>
<li>Cross-platform</li>
<li>Free</li>
<li>Complete SDK documentation</li>
<li>Many free assets</li>
</ol>
<h2 id="Which_programming_language_are_we_using?">Which programming language are we using?</h2><ol>
<li>C# (推荐入门书籍《C#入门经典》)</li>
<li>Javascript</li>
<li>Boo</li>
</ol>
<h1 id="Unity_Tutorial_Study">Unity Tutorial Study</h1><p>Website: <a href="https://unity3d.com/learn/tutorials" target="_blank" rel="external">Unity Tutorials</a></p>
<h2 id="ROLL-A-BALL">ROLL-A-BALL</h2><p><strong>Game Introduction</strong><br>控制小球移动收集场景里的方块，UI会显示当前收集的方块数量，当所有方块通过碰撞收集后游戏UI提示You Win</p>
<p><strong>Code</strong><br>PlayerController.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.UI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">PlayerController</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> m_Speed;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Text m_CountText;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Text m_WinText;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Rigidbody m_RB;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> m_Count;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		m_RB = GetComponent&lt;Rigidbody&gt; ();</span><br><span class="line">		m_Count = <span class="number">0</span>;</span><br><span class="line">		SetCountText();</span><br><span class="line">		m_WinText.text = <span class="string">""</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">FixedUpdate</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">float</span> moveHorizontal = Input.GetAxis (<span class="string">"Horizontal"</span>);</span><br><span class="line">		<span class="keyword">float</span> moveVertical = Input.GetAxis (<span class="string">"Vertical"</span>);</span><br><span class="line"></span><br><span class="line">		Vector3 movement = <span class="keyword">new</span> Vector3(moveHorizontal, <span class="number">0.0</span>f, moveVertical);</span><br><span class="line">		m_RB.AddForce (movement * m_Speed);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">OnTriggerEnter</span>(<span class="params">Collider other</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (other.gameObject.CompareTag (<span class="string">"Pickup"</span>)) </span><br><span class="line">		&#123;</span><br><span class="line">			other.gameObject.SetActive(<span class="keyword">false</span>);</span><br><span class="line">			m_Count++;</span><br><span class="line">			SetCountText();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">SetCountText</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		m_CountText.text = <span class="string">"Count: "</span> + m_Count.ToString();</span><br><span class="line">		<span class="keyword">if</span> (m_Count &gt;= <span class="number">12</span>) </span><br><span class="line">		&#123;</span><br><span class="line">			m_WinText.text = <span class="string">"You Win!"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>CameraController.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CameraController</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> GameObject m_Player;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Vector3 m_Offset;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Use this for initialization</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		m_Offset = transform.position - m_Player.transform.position;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Update is called once per frame</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">LateUpdate</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		transform.position = m_Player.transform.position + m_Offset;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Rotator.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Rotator</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Use this for initialization</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Update is called once per frame</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		transform.Rotate (<span class="keyword">new</span> Vector3 (<span class="number">15</span>, <span class="number">35</span>, <span class="number">45</span>) * Time.deltaTime);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>Captures</strong><br><em>Game Play</em><br><img src="/img/Unity/Roll_A_Ball_Game_Play.PNG" alt="Roll_A_Ball_Game_Play"><br><em>Win Game</em><br><img src="/img/Unity/Roll_A_Ball_Game_Win.PNG" alt="Roll_A_Ball_Game_Win"></p>
<h2 id="SPACE_SHOOTER">SPACE SHOOTER</h2><p><strong>Game Introduction</strong><br>Top Down Game<br>好比全民打飞机</p>
<p><strong>Code</strong><br>ShipController.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line">[System.Serializable]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Boundary</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> m_MinX,m_MaxX,m_MinZ,m_MaxZ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ShipController</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> m_Speed = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> m_Tilt = <span class="number">4</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> fireRate = <span class="number">0.5</span>F;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">float</span> nextFire = <span class="number">0.0</span>F;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Boundary m_Boundary;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> GameObject m_Shot;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Transform m_ShotSpawn;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> AudioSource m_FireAudio;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Rigidbody m_ShipRB;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> GameController m_GameController;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Use this for initialization</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		m_ShipRB = GetComponent&lt;Rigidbody&gt; ();</span><br><span class="line">		m_FireAudio = GetComponent&lt;AudioSource&gt; ();</span><br><span class="line">		GameObject gamecontrollerobject = GameObject.FindGameObjectWithTag (<span class="string">"GameController"</span>);</span><br><span class="line">		<span class="keyword">if</span> (gamecontrollerobject != <span class="keyword">null</span>) &#123;</span><br><span class="line">			m_GameController = gamecontrollerobject.GetComponent&lt;GameController&gt;();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (m_GameController == <span class="keyword">null</span>) &#123;</span><br><span class="line">			Debug.Log(<span class="string">"m_GameController == null in ShipController::Start()"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (Input.GetKey(KeyCode.J) &amp;&amp; Time.time &gt; nextFire) &#123;</span><br><span class="line">			nextFire = Time.time + fireRate;</span><br><span class="line">			GameObject clone = Instantiate (m_Shot, m_ShotSpawn.position, m_ShotSpawn.rotation) <span class="keyword">as</span> GameObject;</span><br><span class="line">			m_FireAudio.Play();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">FixedUpdate</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (!m_GameController.IsGameEnd ()) &#123;</span><br><span class="line">			<span class="keyword">float</span> moveHorizontal = Input.GetAxis (<span class="string">"Horizontal"</span>);</span><br><span class="line">			<span class="keyword">float</span> moveVertical = Input.GetAxis (<span class="string">"Vertical"</span>);</span><br><span class="line">			Vector3 movement = <span class="keyword">new</span> Vector3 (moveHorizontal, <span class="number">0.0</span>f, moveVertical);</span><br><span class="line">			m_ShipRB.velocity = movement * m_Speed;</span><br><span class="line"></span><br><span class="line">			m_ShipRB.position = <span class="keyword">new</span> Vector3 (</span><br><span class="line">				Mathf.Clamp (m_ShipRB.position.x, m_Boundary.m_MinX, m_Boundary.m_MaxX),</span><br><span class="line">				<span class="number">0.0</span>f,</span><br><span class="line">				Mathf.Clamp (m_ShipRB.position.z, m_Boundary.m_MinZ, m_Boundary.m_MaxZ)</span><br><span class="line">			);</span><br><span class="line">			m_ShipRB.rotation = Quaternion.Euler (<span class="number">0.0</span>f, <span class="number">0.0</span>f, -m_ShipRB.velocity.x * m_Tilt);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			m_ShipRB.rotation = Quaternion.Euler(<span class="number">0.0</span>f,<span class="number">0.0</span>f,<span class="number">0.0</span>f);</span><br><span class="line">			m_ShipRB.velocity = <span class="keyword">new</span> Vector3(<span class="number">0.0</span>f,<span class="number">0.0</span>f,<span class="number">0.0</span>f);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>GameController.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.UI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GameController</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> GameObject m_Hazard;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Vector3 m_SpawnValue = <span class="keyword">new</span> Vector3(<span class="number">5.5</span>f,<span class="number">0.0</span>f,<span class="number">8.0</span>f);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> m_HazardCount = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> m_SpawnWait = <span class="number">1.0</span>f;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> m_StartWait = <span class="number">3.0</span>f;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> m_WaveWait = <span class="number">4.0</span>f;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Text m_ScoreText;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Text m_WinText;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Button m_RestartButton;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> m_WinningScore = <span class="number">200</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> m_Score = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">bool</span> m_IsGameEnd = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">bool</span> m_RestartGame = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> AudioSource m_BackgroundAudio;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Use this for initialization</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		StartCoroutine (SpawnAsteriod());</span><br><span class="line">		UpdateScore ();</span><br><span class="line">		m_WinText.text = <span class="string">""</span>;</span><br><span class="line">		m_RestartButton.gameObject.SetActive (<span class="keyword">false</span>);</span><br><span class="line">		m_RestartButton.onClick.AddListener (RestartGame);</span><br><span class="line">		m_BackgroundAudio = GetComponent&lt;AudioSource&gt; ();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (m_RestartGame) &#123;</span><br><span class="line">			Debug.Log(<span class="string">"Restart Game Now"</span>);</span><br><span class="line">			Application.LoadLevel(Application.loadedLevel);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">bool</span> <span class="title">IsGameEnd</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> m_IsGameEnd;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">RestartGame</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		Debug.Log(<span class="string">"Restart Button clicked"</span>);</span><br><span class="line">		m_RestartGame = <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">IEnumerator <span class="title">SpawnAsteriod</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">yield</span> return new <span class="title">WaitForSeconds</span> (<span class="params">m_StartWait</span>)</span>;</span><br><span class="line">		<span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m_HazardCount; i++) &#123;</span><br><span class="line">				Vector3 spawnposition =  <span class="keyword">new</span> Vector3 (Random.Range (-m_SpawnValue.x, m_SpawnValue.x), <span class="number">0.0</span>f, m_SpawnValue.z);</span><br><span class="line">				Quaternion spawnrotation = Quaternion.identity;</span><br><span class="line">				Instantiate(m_Hazard,spawnposition,spawnrotation);</span><br><span class="line">				<span class="function"><span class="keyword">yield</span> return new <span class="title">WaitForSeconds</span> (<span class="params">m_SpawnWait</span>)</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="function"><span class="keyword">yield</span> return new <span class="title">WaitForSeconds</span> (<span class="params">m_WaveWait</span>)</span>;</span><br><span class="line">			<span class="keyword">if</span>(m_IsGameEnd)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddScore</span>(<span class="params"><span class="keyword">int</span> score</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		m_Score += score;</span><br><span class="line">		UpdateScore ();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">UpdateScore</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		m_ScoreText.text = <span class="string">"Score: "</span> + m_Score;</span><br><span class="line">		<span class="keyword">if</span> (m_Score &gt;= m_WinningScore) &#123;</span><br><span class="line">			m_WinText.text = <span class="string">"Congratulation! You Win"</span>;</span><br><span class="line">			m_IsGameEnd = <span class="keyword">true</span>;</span><br><span class="line">			m_RestartButton.gameObject.SetActive (<span class="keyword">true</span>);</span><br><span class="line">			m_BackgroundAudio.Stop();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>DestroyByContact.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DestroyByContact</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> GameObject m_ExplosionObject;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> GameObject m_PlayerExplosionObject;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> GameController m_GameController;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> m_ScoreValue = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		GameObject gamecontrollerobject = GameObject.FindGameObjectWithTag (<span class="string">"GameController"</span>);</span><br><span class="line">		<span class="keyword">if</span> (gamecontrollerobject != <span class="keyword">null</span>) &#123;</span><br><span class="line">			m_GameController = gamecontrollerobject.GetComponent&lt;GameController&gt;();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (m_GameController == <span class="keyword">null</span>) &#123;</span><br><span class="line">			Debug.Log(<span class="string">"m_GameController == null"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">OnTriggerEnter</span>(<span class="params">Collider other</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (other.tag == <span class="string">"Boundary"</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> ;</span><br><span class="line">		&#125;</span><br><span class="line">		Debug.Log (<span class="string">"other.tag = "</span> + other.tag);</span><br><span class="line"></span><br><span class="line">		Instantiate (m_ExplosionObject, transform.position, transform.rotation);</span><br><span class="line">		<span class="keyword">if</span> (other.tag == <span class="string">"Player"</span>) &#123;</span><br><span class="line">			Instantiate (m_PlayerExplosionObject, other.transform.position, other.transform.rotation);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (other.tag == <span class="string">"Bullet"</span>) &#123;</span><br><span class="line">			Debug.Log(<span class="string">"Asteriod is destroied by Bullet"</span>);</span><br><span class="line">			m_GameController.AddScore(m_ScoreValue);</span><br><span class="line">		&#125;</span><br><span class="line">		Destroy(other.gameObject);</span><br><span class="line">		Destroy (gameObject);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>DestroyByTime.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DestroyByTime</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> m_LifeTime = <span class="number">5.0</span>f;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Use this for initialization</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		Destroy (gameObject,m_LifeTime);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>GameBoundary.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GameBoundary</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">OnTriggerExit</span>(<span class="params">Collider other</span>) </span>&#123;</span><br><span class="line">		Destroy(other.gameObject);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Mover.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Mover</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> m_Speed = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Rigidbody m_RigidBody;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> GameController m_GameController;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Use this for initialization</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		m_RigidBody = GetComponent&lt;Rigidbody&gt; ();</span><br><span class="line">		m_RigidBody.velocity = transform.forward * m_Speed;</span><br><span class="line">		GameObject gamecontrollerobject = GameObject.FindGameObjectWithTag (<span class="string">"GameController"</span>);</span><br><span class="line">		<span class="keyword">if</span> (gamecontrollerobject != <span class="keyword">null</span>) &#123;</span><br><span class="line">			m_GameController = gamecontrollerobject.GetComponent&lt;GameController&gt;();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (m_GameController == <span class="keyword">null</span>) &#123;</span><br><span class="line">			Debug.Log(<span class="string">"m_GameController == null in ShipController::Start()"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (m_GameController.IsGameEnd ()) </span><br><span class="line">		&#123;</span><br><span class="line">			m_RigidBody.rotation = Quaternion.Euler(<span class="number">0.0</span>f,<span class="number">0.0</span>f,<span class="number">0.0</span>f);</span><br><span class="line">			m_RigidBody.velocity = <span class="keyword">new</span> Vector3(<span class="number">0.0</span>f,<span class="number">0.0</span>f,<span class="number">0.0</span>f);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>RandomRotator.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">RandomRotator</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> m_Tumble = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Rigidbody m_Rigidbody;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Use this for initialization</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		m_Rigidbody = GetComponent&lt;Rigidbody&gt; ();</span><br><span class="line">		m_Rigidbody.angularVelocity = Random.insideUnitSphere * m_Tumble;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Update is called once per frame</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>Captures</strong><br><em>Game Play</em><br><img src="/img/Unity/Space_Shooter_Game_Play.PNG" alt="Space_Shooter_Game_Play"><br><em>Win Game</em><br><img src="/img/Unity/Space_Shooter_Game_Win.PNG" alt="Space_Shooter_Game_Win"></p>
<p>Survival Shooter<br><strong>Game Introduction</strong><br>固定(2.5D — isometric projection)第三人称视角游戏</p>
<p><strong>Code</strong><br>CameraFollow.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CameraFollow</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> Transform m_Target;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> m_Smoothing = <span class="number">5.0</span>f;</span><br><span class="line"></span><br><span class="line">	Vector3 m_Offset;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Use this for initialization</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		m_Offset = transform.position - m_Target.position;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Update is called once per frame</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		Vector3 targetCamPos = m_Target.position + m_Offset;</span><br><span class="line">		transform.position = Vector3.Lerp (transform.position, targetCamPos, m_Smoothing * Time.deltaTime);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>PlayerShooting.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">PlayerShooting</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> damagePerShot = <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> timeBetweenBullets = <span class="number">0.15</span>f;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> range = <span class="number">100</span>f;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">float</span> timer;</span><br><span class="line">    Ray shootRay;</span><br><span class="line">    RaycastHit shootHit;</span><br><span class="line">    <span class="keyword">int</span> shootableMask;</span><br><span class="line">    ParticleSystem gunParticles;</span><br><span class="line">    LineRenderer gunLine;</span><br><span class="line">    AudioSource gunAudio;</span><br><span class="line">    Light gunLight;</span><br><span class="line">    <span class="keyword">float</span> effectsDisplayTime = <span class="number">0.2</span>f;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Awake</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        shootableMask = LayerMask.GetMask (<span class="string">"Shootable"</span>);</span><br><span class="line">        gunParticles = GetComponent&lt;ParticleSystem&gt; ();</span><br><span class="line">        gunLine = GetComponent &lt;LineRenderer&gt; ();</span><br><span class="line">        gunAudio = GetComponent&lt;AudioSource&gt; ();</span><br><span class="line">        gunLight = GetComponent&lt;Light&gt; ();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        timer += Time.deltaTime;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(Input.GetButton (<span class="string">"Fire1"</span>) &amp;&amp; timer &gt;= timeBetweenBullets &amp;&amp; Time.timeScale != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Shoot ();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(timer &gt;= timeBetweenBullets * effectsDisplayTime)</span><br><span class="line">        &#123;</span><br><span class="line">            DisableEffects ();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DisableEffects</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        gunLine.enabled = <span class="keyword">false</span>;</span><br><span class="line">        gunLight.enabled = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Shoot</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        timer = <span class="number">0</span>f;</span><br><span class="line"></span><br><span class="line">        gunAudio.Play ();</span><br><span class="line"></span><br><span class="line">        gunLight.enabled = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">        gunParticles.Stop ();</span><br><span class="line">        gunParticles.Play ();</span><br><span class="line"></span><br><span class="line">        gunLine.enabled = <span class="keyword">true</span>;</span><br><span class="line">        gunLine.SetPosition (<span class="number">0</span>, transform.position);</span><br><span class="line"></span><br><span class="line">        shootRay.origin = transform.position;</span><br><span class="line">        shootRay.direction = transform.forward;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(Physics.Raycast (shootRay, <span class="keyword">out</span> shootHit, range, shootableMask))</span><br><span class="line">        &#123;</span><br><span class="line">            EnemyHealth enemyHealth = shootHit.collider.GetComponent &lt;EnemyHealth&gt; ();</span><br><span class="line">			Debug.Log(<span class="string">"Shootting"</span>);</span><br><span class="line">			Debug.Log(<span class="string">"shootHit.collider.name = "</span> + shootHit.collider.name);</span><br><span class="line">			<span class="keyword">if</span>(enemyHealth != <span class="keyword">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">				Debug.Log(<span class="string">"enermyHealth != null"</span>);</span><br><span class="line">                enemyHealth.TakeDamage (damagePerShot, shootHit.point);</span><br><span class="line">            &#125;</span><br><span class="line">            gunLine.SetPosition (<span class="number">1</span>, shootHit.point);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">			Debug.Log(<span class="string">"Not shot"</span>);</span><br><span class="line">            gunLine.SetPosition (<span class="number">1</span>, shootRay.origin + shootRay.direction * range);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>PlayerMovement.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">PlayerMovement</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> m_Speed = <span class="number">6.0</span>f;</span><br><span class="line"></span><br><span class="line">	Vector3 m_Movement;</span><br><span class="line"></span><br><span class="line">	Animator m_Anim;</span><br><span class="line"></span><br><span class="line">	Rigidbody m_PlayerRigidbody;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> m_FloorMask;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">float</span> m_CamRayLength = <span class="number">100.0</span>f;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		m_FloorMask = LayerMask.GetMask (<span class="string">"Floor"</span>);</span><br><span class="line"></span><br><span class="line">		m_Anim = GetComponent&lt;Animator&gt; ();</span><br><span class="line"></span><br><span class="line">		m_PlayerRigidbody = GetComponent&lt;Rigidbody&gt; ();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">FixedUpdate</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">float</span> h = Input.GetAxisRaw (<span class="string">"Horizontal"</span>);</span><br><span class="line">		<span class="keyword">float</span> v = Input.GetAxisRaw (<span class="string">"Vertical"</span>);</span><br><span class="line"></span><br><span class="line">		Move (h, v);</span><br><span class="line">		Turning ();</span><br><span class="line">		Animating(h,v);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Move</span>(<span class="params"><span class="keyword">float</span> h, <span class="keyword">float</span> v</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		m_Movement.Set (h, <span class="number">0.0</span>f, v);</span><br><span class="line">		m_Movement = m_Movement.normalized * m_Speed * Time.deltaTime;</span><br><span class="line">		m_PlayerRigidbody.MovePosition (transform.position + m_Movement);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Turning</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		Ray camRay = Camera.main.ScreenPointToRay (Input.mousePosition);</span><br><span class="line"></span><br><span class="line">		RaycastHit floorHit;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(Physics.Raycast(camRay,<span class="keyword">out</span> floorHit,m_CamRayLength, m_FloorMask))</span><br><span class="line">	   &#123;</span><br><span class="line">		Vector3 playerToMouse = floorHit.point - transform.position;</span><br><span class="line">		playerToMouse.y = <span class="number">0.0</span>f;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		Quaternion newRotation = Quaternion.LookRotation(playerToMouse);</span><br><span class="line">		m_PlayerRigidbody.MoveRotation(newRotation);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Animating</span>(<span class="params"><span class="keyword">float</span> h, <span class="keyword">float</span> v</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">bool</span> walking = (h != <span class="number">0.0</span>f || v != <span class="number">0.0</span>f);</span><br><span class="line">		m_Anim.SetBool (<span class="string">"IsWalking"</span>, walking);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>PlayerHealth.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.UI;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">PlayerHealth</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> startingHealth = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> currentHealth;</span><br><span class="line">    <span class="keyword">public</span> Slider healthSlider;</span><br><span class="line">    <span class="keyword">public</span> Image damageImage;</span><br><span class="line">    <span class="keyword">public</span> AudioClip deathClip;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> flashSpeed = <span class="number">5</span>f;</span><br><span class="line">    <span class="keyword">public</span> Color flashColour = <span class="keyword">new</span> Color(<span class="number">1</span>f, <span class="number">0</span>f, <span class="number">0</span>f, <span class="number">0.1</span>f);</span><br><span class="line"></span><br><span class="line">    Animator anim;</span><br><span class="line">    AudioSource playerAudio;</span><br><span class="line">    PlayerMovement playerMovement;</span><br><span class="line">    <span class="comment">//PlayerShooting playerShooting;</span></span><br><span class="line">    <span class="keyword">bool</span> isDead;</span><br><span class="line">    <span class="keyword">bool</span> damaged;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Awake</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        anim = GetComponent &lt;Animator&gt; ();</span><br><span class="line">        playerAudio = GetComponent &lt;AudioSource&gt; ();</span><br><span class="line">        playerMovement = GetComponent &lt;PlayerMovement&gt; ();</span><br><span class="line">        <span class="comment">//playerShooting = GetComponentInChildren &lt;PlayerShooting&gt; ();</span></span><br><span class="line">        currentHealth = startingHealth;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(damaged)</span><br><span class="line">        &#123;</span><br><span class="line">            damageImage.color = flashColour;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            damageImage.color = Color.Lerp (damageImage.color, Color.clear, flashSpeed * Time.deltaTime);</span><br><span class="line">        &#125;</span><br><span class="line">        damaged = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TakeDamage</span> (<span class="params"><span class="keyword">int</span> amount</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        damaged = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">        currentHealth -= amount;</span><br><span class="line"></span><br><span class="line">        healthSlider.<span class="keyword">value</span> = currentHealth;</span><br><span class="line"></span><br><span class="line">        playerAudio.Play ();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(currentHealth &lt;= <span class="number">0</span> &amp;&amp; !isDead)</span><br><span class="line">        &#123;</span><br><span class="line">            Death ();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Death</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        isDead = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//playerShooting.DisableEffects ();</span></span><br><span class="line"></span><br><span class="line">        anim.SetTrigger (<span class="string">"Die"</span>);</span><br><span class="line"></span><br><span class="line">        playerAudio.clip = deathClip;</span><br><span class="line">        playerAudio.Play ();</span><br><span class="line"></span><br><span class="line">        playerMovement.enabled = <span class="keyword">false</span>;</span><br><span class="line">        <span class="comment">//playerShooting.enabled = false;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RestartLevel</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        Application.LoadLevel (Application.loadedLevel);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>EnemyMovement.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EnemyMovement</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    Transform player;</span><br><span class="line">    PlayerHealth playerHealth;</span><br><span class="line">    EnemyHealth enemyHealth;</span><br><span class="line">    NavMeshAgent nav;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Awake</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        player = GameObject.FindGameObjectWithTag (<span class="string">"Player"</span>).transform;</span><br><span class="line">        playerHealth = player.GetComponent &lt;PlayerHealth&gt; ();</span><br><span class="line">        enemyHealth = GetComponent &lt;EnemyHealth&gt; ();</span><br><span class="line">        nav = GetComponent &lt;NavMeshAgent&gt; ();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(enemyHealth.currentHealth &gt; <span class="number">0</span> &amp;&amp; playerHealth.currentHealth &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            nav.SetDestination (player.position);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            nav.enabled = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>EnemyHealth.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EnemyHealth</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> startingHealth = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> currentHealth;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> sinkSpeed = <span class="number">2.5</span>f;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> scoreValue = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">public</span> AudioClip deathClip;</span><br><span class="line"></span><br><span class="line">    Animator anim;</span><br><span class="line">    AudioSource enemyAudio;</span><br><span class="line">    ParticleSystem hitParticles;</span><br><span class="line">    CapsuleCollider capsuleCollider;</span><br><span class="line">    <span class="keyword">bool</span> isDead;</span><br><span class="line">    <span class="keyword">bool</span> isSinking;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Awake</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        anim = GetComponent &lt;Animator&gt; ();</span><br><span class="line">        enemyAudio = GetComponent &lt;AudioSource&gt; ();</span><br><span class="line">        hitParticles = GetComponentInChildren &lt;ParticleSystem&gt; ();</span><br><span class="line">        capsuleCollider = GetComponent &lt;CapsuleCollider&gt; ();</span><br><span class="line"></span><br><span class="line">        currentHealth = startingHealth;</span><br><span class="line">		isDead = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(isSinking)</span><br><span class="line">        &#123;</span><br><span class="line">            transform.Translate (-Vector3.up * sinkSpeed * Time.deltaTime);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TakeDamage</span> (<span class="params"><span class="keyword">int</span> amount, Vector3 hitPoint</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">		Debug.Log (<span class="string">"isDead = "</span> + isDead);</span><br><span class="line">        <span class="keyword">if</span>(isDead)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        enemyAudio.Play ();</span><br><span class="line"></span><br><span class="line">        currentHealth -= amount;</span><br><span class="line">            </span><br><span class="line">        hitParticles.transform.position = hitPoint;</span><br><span class="line">        hitParticles.Play();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(currentHealth &lt;= <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Death ();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Death</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        isDead = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">        capsuleCollider.isTrigger = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">        anim.SetTrigger (<span class="string">"Dead"</span>);</span><br><span class="line"></span><br><span class="line">        enemyAudio.clip = deathClip;</span><br><span class="line">        enemyAudio.Play ();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">StartSinking</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        GetComponent &lt;NavMeshAgent&gt; ().enabled = <span class="keyword">false</span>;</span><br><span class="line">        GetComponent &lt;Rigidbody&gt; ().isKinematic = <span class="keyword">true</span>;</span><br><span class="line">        isSinking = <span class="keyword">true</span>;</span><br><span class="line">        ScoreManager.score += scoreValue;</span><br><span class="line">        Destroy (gameObject, <span class="number">2</span>f);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>EnemyAttack.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EnemyAttack</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> timeBetweenAttacks = <span class="number">0.5</span>f;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> attackDamage = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> validAttackDistance = <span class="number">1.0</span>f;</span><br><span class="line"></span><br><span class="line">    Animator anim;</span><br><span class="line">    GameObject player;</span><br><span class="line">    PlayerHealth playerHealth;</span><br><span class="line">    EnemyHealth enemyHealth;</span><br><span class="line">    <span class="keyword">bool</span> playerInRange;</span><br><span class="line">    <span class="keyword">float</span> timer;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Awake</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        player = GameObject.FindGameObjectWithTag (<span class="string">"Player"</span>);</span><br><span class="line">        playerHealth = player.GetComponent &lt;PlayerHealth&gt; ();</span><br><span class="line">        enemyHealth = GetComponent&lt;EnemyHealth&gt;();</span><br><span class="line">        anim = GetComponent &lt;Animator&gt; ();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span><br><span class="line">    void OnTriggerEnter (Collider other)</span><br><span class="line">    &#123;</span><br><span class="line">        if(other.gameObject == player)</span><br><span class="line">        &#123;</span><br><span class="line">            playerInRange = true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void OnTriggerExit (Collider other)</span><br><span class="line">    &#123;</span><br><span class="line">        if(other.gameObject == player)</span><br><span class="line">        &#123;</span><br><span class="line">            playerInRange = false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">*/</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">OnCollisionEnter</span>(<span class="params">Collision collision</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(collision.gameObject == player)</span><br><span class="line">		&#123;</span><br><span class="line">			playerInRange = <span class="keyword">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">OnCollisionExit</span>(<span class="params">Collision collision</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(collision.gameObject == player)</span><br><span class="line">		&#123;</span><br><span class="line">			playerInRange = <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        timer += Time.deltaTime;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(timer &gt;= timeBetweenAttacks &amp;&amp; playerInRange &amp;&amp; enemyHealth.currentHealth &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Attack ();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(playerHealth.currentHealth &lt;= <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            anim.SetTrigger (<span class="string">"PlayerDead"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Attack</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        timer = <span class="number">0</span>f;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(playerHealth.currentHealth &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            playerHealth.TakeDamage (attackDamage);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ScoreManager.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.UI;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ScoreManager</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> score;</span><br><span class="line"></span><br><span class="line">    Text text;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Awake</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        text = GetComponent &lt;Text&gt; ();</span><br><span class="line">        score = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        text.text = <span class="string">"Score: "</span> + score;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>EnemyManager.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EnemyManager</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> PlayerHealth playerHealth;</span><br><span class="line">    <span class="keyword">public</span> GameObject enemy;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> spawnTime = <span class="number">3</span>f;</span><br><span class="line">    <span class="keyword">public</span> Transform[] spawnPoints;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        InvokeRepeating (<span class="string">"Spawn"</span>, spawnTime, spawnTime);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Spawn</span> (<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(playerHealth.currentHealth &lt;= <span class="number">0</span>f)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> spawnPointIndex = Random.Range (<span class="number">0</span>, spawnPoints.Length);</span><br><span class="line"></span><br><span class="line">        Instantiate (enemy, spawnPoints[spawnPointIndex].position, spawnPoints[spawnPointIndex].rotation);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>GameOverManager.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GameOverManager</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> PlayerHealth playerHealth;</span><br><span class="line"></span><br><span class="line">    Animator anim;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        anim = GetComponent&lt;Animator&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">		Debug.Log (<span class="string">"playerHealth.currentHealth = "</span> + playerHealth.currentHealth);</span><br><span class="line">        <span class="keyword">if</span> (playerHealth.currentHealth &lt;= <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            anim.SetTrigger(<span class="string">"GameOver"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>Captures</strong><br><em>Game(因为一些原因没有截图)</em><br><img src="/img/Unity/Survival_Shooter_Game.PNG" alt="Survival_Shooter_Game"><br><a href="https://unity3d.com/learn/tutorials/projects/survival-shooter-project" target="_blank" rel="external">图片来源</a></p>
<h2 id="2D-ROGUELIKE-TUTORIAL">2D-ROGUELIKE-TUTORIAL</h2><p><strong>Game Introduction</strong><br>Over the course of the project will create procedural tile based levels, implement turn based movement, add a hunger system, audio and mobile touch controls. </p>
<p><strong>Code</strong><br>BoardManager.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> Random = UnityEngine.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BoardManager</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line">	[Serializable]</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Count</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">int</span> minimum;</span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">int</span> maximum;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="title">Count</span>(<span class="params"><span class="keyword">int</span> min, <span class="keyword">int</span> max</span>)</span><br><span class="line">		</span>&#123;</span><br><span class="line">			minimum = min;</span><br><span class="line">			maximum = max;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> columns = <span class="number">8</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> rows = <span class="number">8</span>;</span><br><span class="line">	<span class="keyword">public</span> Count wallCount = <span class="keyword">new</span> Count(<span class="number">5</span>,<span class="number">9</span>);</span><br><span class="line">	<span class="keyword">public</span> Count foodCount = <span class="keyword">new</span> Count(<span class="number">1</span>,<span class="number">5</span>);</span><br><span class="line">	<span class="keyword">public</span> GameObject exit;</span><br><span class="line">	<span class="keyword">public</span> GameObject[] floorTiles;</span><br><span class="line">	<span class="keyword">public</span> GameObject[] wallTiles;</span><br><span class="line">	<span class="keyword">public</span> GameObject[] foodTiles;</span><br><span class="line">	<span class="keyword">public</span> GameObject[] enemyTiles;</span><br><span class="line">	<span class="keyword">public</span> GameObject[] outerwallTiles;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Transform boardHolder;</span><br><span class="line">	<span class="keyword">private</span> List&lt;Vector3&gt; gridPositions = <span class="keyword">new</span> List&lt;Vector3&gt;();</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">InitialiseList</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		gridPositions.Clear ();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">1</span>; x &lt; columns - <span class="number">1</span>; x++) </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> y = <span class="number">1</span>; y &lt; rows - <span class="number">1</span>; y++)</span><br><span class="line">			&#123;</span><br><span class="line">				gridPositions.Add(<span class="keyword">new</span> Vector3(x,y,<span class="number">0</span>f));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">BoardSetup</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		boardHolder = <span class="keyword">new</span> GameObject (<span class="string">"Board"</span>).transform;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> x = -<span class="number">1</span>; x &lt; columns + <span class="number">1</span>; x++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> y = -<span class="number">1</span>; y &lt; rows + <span class="number">1</span>; y++)</span><br><span class="line">			&#123;</span><br><span class="line">				GameObject toInstantiate = floorTiles[Random.Range (<span class="number">0</span>,floorTiles.Length)];</span><br><span class="line">				<span class="keyword">if</span>(x == -<span class="number">1</span> || x == columns || y == -<span class="number">1</span> || y == rows)</span><br><span class="line">				&#123;</span><br><span class="line">					toInstantiate = outerwallTiles[Random.Range(<span class="number">0</span>,outerwallTiles.Length)];</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				GameObject instance = Instantiate (toInstantiate, <span class="keyword">new</span> Vector3(x,y,<span class="number">0</span>f),Quaternion.identity) <span class="keyword">as</span> GameObject;</span><br><span class="line"></span><br><span class="line">				instance.transform.SetParent(boardHolder);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">Vector3 <span class="title">RandomPosition</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">int</span> randomIndex = Random.Range (<span class="number">0</span>, gridPositions.Count);</span><br><span class="line">		Vector3 randomPosition = gridPositions [randomIndex];</span><br><span class="line">		gridPositions.RemoveAt(randomIndex);</span><br><span class="line">		<span class="keyword">return</span> randomPosition;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">LayoutObjectAtRandom</span>(<span class="params">GameObject[] tileArray, <span class="keyword">int</span> minimum, <span class="keyword">int</span> maximum</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">int</span> objectCount = Random.Range (minimum, maximum + <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; objectCount; i++) &#123;</span><br><span class="line">			Vector3 randomPosition = RandomPosition();</span><br><span class="line">			GameObject tileChoice = tileArray[Random.Range (<span class="number">0</span>, tileArray.Length)];</span><br><span class="line">			Instantiate(tileChoice, randomPosition, Quaternion.identity);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetupScene</span>(<span class="params"><span class="keyword">int</span> level</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		BoardSetup ();</span><br><span class="line">		InitialiseList ();</span><br><span class="line">		LayoutObjectAtRandom (wallTiles, wallCount.minimum, wallCount.maximum);</span><br><span class="line">		LayoutObjectAtRandom (foodTiles, foodCount.minimum, foodCount.maximum);</span><br><span class="line">		<span class="keyword">int</span> enemyCount = (<span class="keyword">int</span>)Mathf.Log (level, <span class="number">2</span>f);</span><br><span class="line">		LayoutObjectAtRandom (enemyTiles, enemyCount, enemyCount);</span><br><span class="line">		Instantiate (exit, <span class="keyword">new</span> Vector3 (columns - <span class="number">1</span>, rows - <span class="number">1</span>, <span class="number">0</span>f), Quaternion.identity);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>GameManager.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.UI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GameManager</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> levelStartDelay = <span class="number">2</span>f;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> turnDelay = <span class="number">0.1</span>f;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> GameManager instance = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> BoardManager boardScript;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> playerFoodPoints = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">	[HideInInspector]<span class="keyword">public</span> <span class="keyword">bool</span> playerTurn = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Text levelText;</span><br><span class="line">	<span class="keyword">private</span> GameObject levelImage;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> level = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">bool</span> doingSetup;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> List&lt;Enemy&gt; enemies;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">bool</span> enemiesMoving;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (instance == <span class="keyword">null</span>) </span><br><span class="line">		&#123;</span><br><span class="line">			instance = <span class="keyword">this</span>;</span><br><span class="line">		&#125; <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">instance != <span class="keyword">this</span></span>) </span><br><span class="line">		</span>&#123;</span><br><span class="line">			Destroy (gameObject);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		DontDestroyOnLoad(gameObject);</span><br><span class="line"></span><br><span class="line">		enemies = <span class="keyword">new</span> List&lt;Enemy&gt; ();</span><br><span class="line"></span><br><span class="line">		boardScript = GetComponent&lt;BoardManager&gt; ();</span><br><span class="line">		InitGame ();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnLevelWasLoaded</span>(<span class="params"><span class="keyword">int</span> index</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		level++;</span><br><span class="line"></span><br><span class="line">		InitGame ();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">InitGame</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		doingSetup = <span class="keyword">true</span>;</span><br><span class="line">		levelImage = GameObject.Find (<span class="string">"LevelImage"</span>);</span><br><span class="line">		levelText = GameObject.Find (<span class="string">"LevelText"</span>).GetComponent&lt;Text&gt; ();</span><br><span class="line">		levelText.text = <span class="string">"Day "</span> + level;</span><br><span class="line">		levelImage.SetActive (<span class="keyword">true</span>);</span><br><span class="line">		Invoke (<span class="string">"HideLevelImage"</span>, levelStartDelay);</span><br><span class="line"></span><br><span class="line">		enemies.Clear ();</span><br><span class="line">		boardScript.SetupScene (level);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">HideLevelImage</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		levelImage.SetActive (<span class="keyword">false</span>);</span><br><span class="line">		doingSetup = <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GameOver</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		levelText.text = <span class="string">"After "</span> + level + <span class="string">" days, you starved."</span>;</span><br><span class="line">		levelImage.SetActive (<span class="keyword">true</span>);</span><br><span class="line">		enabled = <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Update is called once per frame</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (playerTurn || enemiesMoving || doingSetup ) &#123;</span><br><span class="line">			<span class="keyword">return</span> ;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		StartCoroutine (MoveEnemies ());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddEnemyToList</span>(<span class="params">Enemy script</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		enemies.Add (script);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">IEnumerator <span class="title">MoveEnemies</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		enemiesMoving = <span class="keyword">true</span>;</span><br><span class="line">		<span class="function"><span class="keyword">yield</span> return new <span class="title">WaitForSeconds</span>(<span class="params">turnDelay</span>)</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (enemies.Count == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="function"><span class="keyword">yield</span> return new <span class="title">WaitForSeconds</span>(<span class="params">turnDelay</span>)</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; enemies.Count; i++) &#123;</span><br><span class="line">			enemies[i].MoveEnemy();</span><br><span class="line">			<span class="function"><span class="keyword">yield</span> return new <span class="title">WaitForSeconds</span>(<span class="params">turnDelay</span>)</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		Debug.Log (<span class="string">"GameManager::MoveEnemies"</span>);</span><br><span class="line">		playerTurn = <span class="keyword">true</span>;</span><br><span class="line">		enemiesMoving = <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>MovingObject.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>BoardManager.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">MovingObject</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> moveTime = <span class="number">0.1</span>f;</span><br><span class="line">	<span class="keyword">public</span> LayerMask blockingLayer;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> BoxCollider2D BoxCollider;</span><br><span class="line">	<span class="keyword">private</span> Rigidbody2D rb2D;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">float</span> inverseMoveTime;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Use this for initialization</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		BoxCollider = GetComponent&lt;BoxCollider2D&gt; ();</span><br><span class="line">		rb2D = GetComponent&lt;Rigidbody2D&gt; ();</span><br><span class="line">		inverseMoveTime = <span class="number">1</span>f / moveTime;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">bool</span> <span class="title">Move</span>(<span class="params"><span class="keyword">int</span> xDir, <span class="keyword">int</span> yDir, <span class="keyword">out</span> RaycastHit2D hit</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		Vector2 start = transform.position;</span><br><span class="line">		Vector2 end = start + <span class="keyword">new</span> Vector2 (xDir, yDir);</span><br><span class="line"></span><br><span class="line">		BoxCollider.enabled = <span class="keyword">false</span>;</span><br><span class="line">		hit = Physics2D.Linecast (start, end, blockingLayer);</span><br><span class="line">		BoxCollider.enabled = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>( hit.transform == <span class="keyword">null</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			StartCoroutine(SmoothMovement(end));</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> IEnumerator <span class="title">SmoothMovement</span>(<span class="params">Vector3 end</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">float</span> sqrRemainingDistance = (transform.position - end).sqrMagnitude;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> (sqrRemainingDistance &gt; <span class="keyword">float</span>.Epsilon) &#123;</span><br><span class="line">			Vector3 newPosition = Vector3.MoveTowards(rb2D.position, end, inverseMoveTime * Time.deltaTime);</span><br><span class="line">			rb2D.MovePosition(newPosition);</span><br><span class="line">			sqrRemainingDistance = (transform.position - end).sqrMagnitude;</span><br><span class="line">			<span class="keyword">yield</span> <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">virtual</span> <span class="keyword">void</span> AttemptMove&lt;T&gt;(<span class="keyword">int</span> xDir, <span class="keyword">int</span> yDir) <span class="keyword">where</span> T : Component</span><br><span class="line">	&#123;</span><br><span class="line">		RaycastHit2D hit;</span><br><span class="line">		<span class="keyword">bool</span> canMove = Move (xDir, yDir, <span class="keyword">out</span> hit);</span><br><span class="line">		<span class="keyword">if</span> (hit.transform == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> ;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		T hitComponent = hit.transform.GetComponent&lt;T&gt; ();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (!canMove &amp;&amp; hitComponent != <span class="keyword">null</span>) &#123;</span><br><span class="line">			OnCanMove(hitComponent);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> OnCanMove&lt;T&gt;(T component) <span class="keyword">where</span> T : Component;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Player.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.UI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Player</span> : <span class="title">MovingObject</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> wallDamage = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> pointsPerFood = <span class="number">10</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> pointsPerSoda = <span class="number">20</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> restartLevelDelay = <span class="number">1</span>f;</span><br><span class="line">	<span class="keyword">public</span> Text foodText;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> AudioClip moveSound1;</span><br><span class="line">	<span class="keyword">public</span> AudioClip moveSound2;</span><br><span class="line">	<span class="keyword">public</span> AudioClip eatSound1;</span><br><span class="line">	<span class="keyword">public</span> AudioClip eatSound2;</span><br><span class="line">	<span class="keyword">public</span> AudioClip drinkSound1;</span><br><span class="line">	<span class="keyword">public</span> AudioClip drinkSound2;</span><br><span class="line">	<span class="keyword">public</span> AudioClip gameOverSound;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Animator animator;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> food;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Vector2 touchOrigin = -Vector2.one;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		foodText.text = <span class="string">"Food:"</span> + food;</span><br><span class="line"></span><br><span class="line">		animator = GetComponent&lt;Animator&gt; ();</span><br><span class="line"></span><br><span class="line">		food = GameManager.instance.playerFoodPoints;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">base</span>.Start();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnDisable</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		GameManager.instance.playerFoodPoints = food;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Update is called once per frame</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (!GameManager.instance.playerTurn) &#123;</span><br><span class="line">			<span class="keyword">return</span> ;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		Debug.Log (<span class="string">"Player::Update() called"</span>);</span><br><span class="line">		<span class="keyword">int</span> horizontal = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> vertical = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="preprocessor">#<span class="keyword">if</span> UNITY_EDITOR || UNITY_STANDLONE || UNITY_WEBPLAYER</span></span><br><span class="line">		horizontal = (<span class="keyword">int</span>)Input.GetAxisRaw (<span class="string">"Horizontal"</span>);</span><br><span class="line">		vertical = (<span class="keyword">int</span>)Input.GetAxisRaw (<span class="string">"Vertical"</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (horizontal != <span class="number">0</span>) &#123;</span><br><span class="line">			vertical = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="preprocessor">#<span class="keyword">else</span></span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(Input.touchCount &gt; <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			Touch myTouch = Input.touches[<span class="number">0</span>];</span><br><span class="line">			<span class="keyword">if</span>(myTouch.phase == TouchPhase.Began)</span><br><span class="line">			&#123;</span><br><span class="line">				touchOrigin = myTouch.position;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="function"><span class="keyword">else</span> <span class="title">if</span>(<span class="params">myTouch.phase == TouchPhase.Ended &amp;&amp; touchOrigin.x &gt;= <span class="number">0</span></span>)</span><br><span class="line">			</span>&#123;</span><br><span class="line">				Vector2 touchEnd = myTouch.position;</span><br><span class="line">				<span class="keyword">float</span> x = touchEnd.x - touchOrigin.x;</span><br><span class="line">				<span class="keyword">float</span> y = touchEnd.y - touchOrigin.y;</span><br><span class="line">				touchOrigin.x = -<span class="number">1</span>;</span><br><span class="line">				<span class="keyword">if</span>(Mathf.Abs(x) &gt; Mathf.Abs(y))</span><br><span class="line">				&#123;</span><br><span class="line">					horizontal = x &gt; <span class="number">0</span> ? <span class="number">1</span> : -<span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">				&#123;</span><br><span class="line">					vertical = y &gt; <span class="number">0</span> ? <span class="number">1</span> : -<span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="preprocessor">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (horizontal != <span class="number">0</span> || vertical != <span class="number">0</span> ) &#123;</span><br><span class="line">			AttemptMove&lt;Wall&gt;(horizontal, vertical);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> AttemptMove&lt;T&gt;(<span class="keyword">int</span> xDir, <span class="keyword">int</span> yDir)</span><br><span class="line">	&#123;</span><br><span class="line">		food--;</span><br><span class="line">		foodText.text = <span class="string">"Food:"</span> + food;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">base</span>.AttemptMove&lt;T&gt; (xDir, yDir);</span><br><span class="line"></span><br><span class="line">		RaycastHit2D hit;</span><br><span class="line">		<span class="keyword">if</span>(Move (xDir, yDir, <span class="keyword">out</span> hit))</span><br><span class="line">		&#123;</span><br><span class="line">			SoundManager.instance.RandomizeSfx(moveSound1,moveSound2);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		CheckIfGameOver ();</span><br><span class="line"></span><br><span class="line">		GameManager.instance.playerTurn = <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnTriggerEnter2D</span>(<span class="params">Collider2D other</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (other.tag == <span class="string">"Exit"</span>) &#123;</span><br><span class="line">			Invoke (<span class="string">"Restart"</span>, restartLevelDelay);</span><br><span class="line">			enabled = <span class="keyword">false</span>;</span><br><span class="line">		&#125; <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">other.tag == <span class="string">"Food"</span></span>) </span>&#123;</span><br><span class="line">			food += pointsPerFood;</span><br><span class="line">			other.gameObject.SetActive(<span class="keyword">false</span>);</span><br><span class="line">			foodText.text = <span class="string">"+:"</span> + pointsPerFood + <span class="string">"Food: "</span> + food;</span><br><span class="line">			SoundManager.instance.RandomizeSfx(drinkSound1,drinkSound2);</span><br><span class="line">		&#125; <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">other.tag == <span class="string">"Soda"</span></span>) </span>&#123;</span><br><span class="line">			food += pointsPerSoda;</span><br><span class="line">			other.gameObject.SetActive(<span class="keyword">false</span>);</span><br><span class="line">			foodText.text = <span class="string">"+:"</span> + pointsPerSoda + <span class="string">"Food: "</span> + food;			</span><br><span class="line">			SoundManager.instance.RandomizeSfx(drinkSound1,drinkSound2);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> OnCanMove&lt;T&gt;(T component)</span><br><span class="line">	&#123;</span><br><span class="line">		Wall hitWall = component <span class="keyword">as</span> Wall;</span><br><span class="line">		hitWall.DamageWall (wallDamage);</span><br><span class="line">		animator.SetTrigger (<span class="string">"PlayerChop"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Restart</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		Application.LoadLevel (Application.loadedLevel);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LoseFood</span>(<span class="params"><span class="keyword">int</span> loss</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		animator.SetTrigger (<span class="string">"PlayerHit"</span>);</span><br><span class="line">		food -= loss;</span><br><span class="line">		foodText.text = <span class="string">"-:"</span> + loss + <span class="string">"Food: "</span> + food;</span><br><span class="line">		CheckIfGameOver();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">CheckIfGameOver</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (food &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">			SoundManager.instance.PlaySingle(gameOverSound);</span><br><span class="line">			SoundManager.instance.musicSource.Stop();</span><br><span class="line">			GameManager.instance.GameOver();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Enemy.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Enemy</span> : <span class="title">MovingObject</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> playerDamager;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Animator animator;</span><br><span class="line">	<span class="keyword">private</span> Transform target;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">bool</span> skipMove;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> AudioClip enemyAttack1;</span><br><span class="line">	<span class="keyword">public</span> AudioClip enemyAttack2;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		GameManager.instance.AddEnemyToList (<span class="keyword">this</span>);</span><br><span class="line">		animator = GetComponent&lt;Animator&gt; ();</span><br><span class="line">		target = GameObject.FindGameObjectWithTag (<span class="string">"Player"</span>).transform;</span><br><span class="line">		<span class="keyword">base</span>.Start ();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> AttemptMove&lt;T&gt;(<span class="keyword">int</span> xDir, <span class="keyword">int</span> yDir)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (skipMove) &#123;</span><br><span class="line">			skipMove = <span class="keyword">false</span>;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">base</span>.AttemptMove&lt;T&gt; (xDir, yDir);</span><br><span class="line"></span><br><span class="line">		skipMove = <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MoveEnemy</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">int</span> xDir = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> yDir = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (Mathf.Abs (target.position.x - transform.position.x) &lt; <span class="keyword">float</span>.Epsilon) &#123;</span><br><span class="line">			yDir = target.position.y &gt; transform.position.y ? <span class="number">1</span> : -<span class="number">1</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			xDir = target.position.x &gt; transform.position.x ? <span class="number">1</span> : -<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		AttemptMove&lt;Player&gt; (xDir, yDir);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> OnCanMove&lt;T&gt;(T component)</span><br><span class="line">	&#123;</span><br><span class="line">		Player hitPlayer = component <span class="keyword">as</span> Player;</span><br><span class="line"></span><br><span class="line">		animator.SetTrigger (<span class="string">"enemyAttack"</span>);</span><br><span class="line"></span><br><span class="line">		hitPlayer.LoseFood (playerDamager);</span><br><span class="line"></span><br><span class="line">		SoundManager.instance.RandomizeSfx (enemyAttack1, enemyAttack2);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>SoundManager.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SoundManager</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> AudioSource efxSource;</span><br><span class="line">	<span class="keyword">public</span> AudioSource musicSource;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> SoundManager instance = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> lowPitchRange = <span class="number">0.95</span>f;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> highPitchRange = <span class="number">1.05</span>f;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">			instance = <span class="keyword">this</span>;</span><br><span class="line">		&#125; <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">instance != <span class="keyword">this</span></span>) </span>&#123;</span><br><span class="line">			Destroy(gameObject);</span><br><span class="line">		&#125;</span><br><span class="line">		DontDestroyOnLoad (gameObject);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PlaySingle</span>(<span class="params">AudioClip clip</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		efxSource.clip = clip;</span><br><span class="line">		efxSource.Play ();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RandomizeSfx</span>(<span class="params"><span class="keyword">params</span> AudioClip[] clips</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">int</span> randomIndex = Random.Range (<span class="number">0</span>, clips.Length);</span><br><span class="line">		<span class="keyword">float</span> randomPitch = Random.Range (lowPitchRange, highPitchRange);</span><br><span class="line"></span><br><span class="line">		efxSource.pitch = randomPitch;</span><br><span class="line">		efxSource.clip = clips [randomIndex];</span><br><span class="line">		efxSource.Play ();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Use this for initialization</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Update is called once per frame</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Wall.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Wall</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Sprite dmgSprite;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> hp = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> SpriteRenderer spriteRenderer;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> AudioClip wallChop1;</span><br><span class="line">	<span class="keyword">public</span> AudioClip wallChop2;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		spriteRenderer = GetComponent&lt;SpriteRenderer&gt; ();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DamageWall</span>(<span class="params"><span class="keyword">int</span> loss</span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		spriteRenderer.sprite = dmgSprite;</span><br><span class="line">		hp -= loss;</span><br><span class="line">		SoundManager.instance.RandomizeSfx (wallChop1, wallChop2);</span><br><span class="line">		<span class="keyword">if</span> (hp &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">			gameObject.SetActive(<span class="keyword">false</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Loder.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Loader</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> GameObject gameManager;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (GameManager.instance == <span class="keyword">null</span>) </span><br><span class="line">		&#123;</span><br><span class="line">			Instantiate (gameManager);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Update is called once per frame</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>Captures</strong><br><em>Game Start</em><br><img src="/img/Unity/2DRogueLike_Game_Start.PNG" alt="2DRogueLike_Game_Start"><br><em>Game Play</em><br><img src="/img/Unity/2DRogueLike_Game_Play.PNG" alt="2DRogueLike_Game_Play"><br><em>lose Game</em><br><img src="/img/Unity/2DRogueLike_Game_Lose.PNG" alt="2DRogueLike_Game_Lose"></p>
<h1 id="编辑器界面">编辑器界面</h1><ol>
<li><p><strong>Hierachy</strong><br>游戏组成元素(这个tutorial里，好比小球，方块，地面，摄像机，灯光，墙等)<br>主要用于对物件的归类管理</p>
<ol>
<li>Create Empty可以用于层次管理归类</li>
</ol>
</li>
<li><p><strong>Project</strong><br>游戏原件管理（这个tutorial里，好比材质，C#脚本）<br>主要用于对一次性资源的归类管理</p>
<ol>
<li>可通过创建Folder进行资源整理归类</li>
</ol>
</li>
<li><p><strong>Scene</strong><br>编辑场景</p>
<ol>
<li>右上角可以切换视角</li>
<li>可以切换Local和Global模式进行移动物体</li>
</ol>
</li>
<li><p><strong>Game</strong><br>运行时场景（可动态编辑查看物体属性）</p>
</li>
<li><p><strong>Inspector</strong><br>对象属性查看</p>
<ol>
<li>通过物体名字左边的Active勾选框可以决定物体是否在编辑器可见可选</li>
<li>可以通过点击界面的？来打开相应面板的介绍页面</li>
</ol>
</li>
</ol>
<h1 id="工具">工具</h1><h2 id="MonoDevelop">MonoDevelop</h2><p>C#,Js脚本编辑器(也可自己设定编辑器为VS  Edit-&gt;Preference-&gt;External Tools-&gt;External Script Editor)</p>
<h1 id="相关概念学习">相关概念学习</h1><ol>
<li><strong>Layout</strong> — 排版，可用于存储我们在Unity里面的面板排版设置，通过制定layout使用特定排版</li>
<li><strong>Prefab</strong> — 原件，可在场景里重复利用，而且Prefab的改变可以通过点击Inspector界面的Apply影响到所有从该Prefab里创建出的对象</li>
<li><strong>Tag</strong>  — Scene里面所有物体的唯一标识，用于确保正确识别物体，通过对物体添加tag可以在程序里用于身份判别</li>
<li><strong>Static collider</strong> — will not be affected by collision (not cause collide). Unity keep static collider mesh in cach</li>
<li><strong>Dynamic collider</strong> — will be affected by collision</li>
<li><strong>Is Trigger</strong> — when no collide caused(e.g. static collider), we can use trigger to enter collide event(只有没有物理碰撞的物体才会触发Trigger的)</li>
<li><strong>Rigibody body</strong> — Moved by using physical force, use dynamic collider</li>
<li><strong>Kinematic body</strong> — Moved by using the transform instead of physical force</li>
<li><strong>Mesh Collider</strong> — Use Model mesh as collider mesh (一般只用于简单的三角形数量少的mesh)</li>
<li><strong>AudioSource</strong> — 声音在Unity里也是组件的形式存在</li>
<li><strong>C# Script</strong> — 每个物体可以绑定多个脚本用于不同逻辑，特别是用于原件一些特有的逻辑特性</li>
<li><strong>2.5D</strong> — 在3D的世界里通过平行投影(Orthographic Projection - isometric projection)实现</li>
<li><strong>Raycast</strong> — 射线碰撞检测（Physics.Raycast()在物体是is triiger on的时候不会触发）</li>
<li><strong>LayerMask</strong> — 可以用于选择和射线检测过滤</li>
<li><strong>NavMeshAgent</strong> — Unity的Navigation system可以提供最基本的路径AI寻址(只需要指定agent相关参数，在代码里设定跟踪目标) — 添加后需要Bake Navigation</li>
<li><strong>Animation Controller</strong> — 动画管理，通过给物体添加Animator并设定动画状态机之间的切换规则来实现动画状态切换管理(通过给UI添加Animator我们也可以在Anmation面板设置简单动画)</li>
<li><strong>LineRenderer</strong> — 可以用于在3D世界里绘制线条，实现可视化一些射线检测物体碰撞等</li>
<li><strong>Select icon</strong> — 可以给没有实际物体或透明物体一个颜色标记(容易看到3D世界位置)</li>
<li><strong>Canvas</strong> — 画布是所有UI所应该在的区域(UI的层级关系会影响渲染顺序) — 通过设定Render Mode实现不同的效果(Screen Space - Overlay不会受Camera的投影方式影响，永远在场景上. Screen Space - Camera会受Camera的投影方式影响，比如在透视投影里就会有近大远小的效果. World Space会把UI当做3D空间里的物体来对待，有深度概念会被遮挡 ))</li>
<li><strong>Physics2D.Linecast</strong> — 可用于检测特定layer的射线检测</li>
<li><p><em>**Input</em> — 不同平台要使用不同平台的AIP<br>e.g.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">if</span> UNITY_EDITOR || UNITY_STANDLONE || UNITY_WEBPLAYER</span></span><br><span class="line">	horizontal = (<span class="keyword">int</span>)Input.GetAxisRaw (<span class="string">"Horizontal"</span>);</span><br><span class="line">	vertical = (<span class="keyword">int</span>)Input.GetAxisRaw (<span class="string">"Vertical"</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (horizontal != <span class="number">0</span>) &#123;</span><br><span class="line">		vertical = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="preprocessor">#<span class="keyword">else</span></span></span><br><span class="line">	<span class="keyword">if</span>(Input.touchCount &gt; <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		Touch myTouch = Input.touches[<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">if</span>(myTouch.phase == TouchPhase.Began)</span><br><span class="line">		&#123;</span><br><span class="line">			touchOrigin = myTouch.position;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">else</span> <span class="title">if</span>(<span class="params">myTouch.phase == TouchPhase.Ended &amp;&amp; touchOrigin.x &gt;= <span class="number">0</span></span>)</span><br><span class="line">		</span>&#123;</span><br><span class="line">			Vector2 touchEnd = myTouch.position;</span><br><span class="line">			<span class="keyword">float</span> x = touchEnd.x - touchOrigin.x;</span><br><span class="line">			<span class="keyword">float</span> y = touchEnd.y - touchOrigin.y;</span><br><span class="line">			touchOrigin.x = -<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(Mathf.Abs(x) &gt; Mathf.Abs(y))</span><br><span class="line">			&#123;</span><br><span class="line">				horizontal = x &gt; <span class="number">0</span> ? <span class="number">1</span> : -<span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				vertical = y &gt; <span class="number">0</span> ? <span class="number">1</span> : -<span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;	</span><br><span class="line"><span class="preprocessor">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>DontDestroyOnLoad()</strong> — 加载新的scene的时候保证对象不会被销毁</p>
</li>
<li><strong>Invoke()</strong> — 延时调用方法</li>
</ol>
<h1 id="快捷键学习">快捷键学习</h1><p>F — 在Scene界面选中对象后可以快速聚焦到该物体<br>Ctrl + ‘ — 打开脚本的类Reference page<br>Ctrl + D — Duplicated（复制）物体</p>
<h1 id="项目编译发布">项目编译发布</h1><ol>
<li>File -&gt; Build Setting 设置平台</li>
<li>Drag Scene file to Scenes to build 选择要编译的场景</li>
<li>点击Build 编译游戏</li>
</ol>
<h1 id="C#脚本">C#脚本</h1><p>public成员 — 编辑器可见可编辑<br>[System.Serializable] — 标志该类可以被序列化到Inspector<br>[HideInInspector] — 标志该成员在编辑器不可见<br>StartCoroutine（Function()） &amp;&amp;  yield &amp;&amp; WaitForSeconds — 联合使用可以实现对游戏逻辑的等待判断（多线程访问控制）<br>GameObject.FindGameObjectWithTag(Name) — 用于寻找特定tag的对象<br>Virtual Method — Virtual Method使该方法可以被重写<br>abstract — 定义该类是抽象类 &amp;&amp; 该方法是抽象方法（需要被子类实现）</p>
<h2 id="Persistence_-_Saving_and_Loading_Data">Persistence - Saving and Loading Data</h2><h3 id="PlayerPrefs">PlayerPrefs</h3><p>Stores and accesses player preferences between game sessions. (用于存储一些不重要的用户设定的数据，比如游戏分辨率，游戏难度等)</p>
<p>IOS里面的.plist文件，Andoid里面的Preference(程序数据文件)</p>
<h3 id="Seralization"><a href="http://docs.unity3d.com/Manual/script-Serialization.html" target="_blank" rel="external">Seralization</a></h3><h4 id="What_is_seralization?">What is seralization?</h4><p>serialization is the process of converting the state an object to a set of bytes in order to store (or transmit) the object into memory, a database or a file.</p>
<h4 id="C#_Serialization">C# Serialization</h4><p>GameController.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Runtime.Serialization.Formatters.Binary;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> UnityEngine.UI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GameController</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> GameController mController;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> PlayerData mPlayerData;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> mPreferenceHealth = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">string</span> mPlayerSavePath;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (mController == <span class="keyword">null</span>) &#123;</span><br><span class="line">			DontDestroyOnLoad (gameObject);</span><br><span class="line">			mController = <span class="keyword">this</span>;</span><br><span class="line">		&#125; <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">mController != <span class="keyword">this</span></span>) </span>&#123;</span><br><span class="line">			Destroy(gameObject);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		mPlayerData = <span class="keyword">new</span> PlayerData ();</span><br><span class="line"></span><br><span class="line">		mPlayerSavePath = Application.persistentDataPath + <span class="string">"/playerInfo.dat"</span>;</span><br><span class="line">		Debug.Log (<span class="string">"mPlayerSavePath = "</span> + mPlayerSavePath);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">OnGUI</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		GUI.Label (<span class="keyword">new</span> Rect (<span class="number">10</span>, <span class="number">10</span>, <span class="number">200</span>, <span class="number">30</span>), <span class="string">"Preference Health: "</span> + mPreferenceHealth);</span><br><span class="line">		GUI.Label (<span class="keyword">new</span> Rect (<span class="number">10</span>, <span class="number">50</span>, <span class="number">200</span>, <span class="number">30</span>), <span class="string">"mPlayerData.mHealth: "</span> + mPlayerData.mHealth);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (GUI.Button (<span class="keyword">new</span> Rect (<span class="number">10</span>, <span class="number">90</span>, <span class="number">120</span>, <span class="number">30</span>), <span class="string">"Increase Health"</span>)) &#123;</span><br><span class="line">			mPreferenceHealth += <span class="number">10</span>;</span><br><span class="line">			mPlayerData.mHealth += <span class="number">10</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> (GUI.Button (<span class="keyword">new</span> Rect (<span class="number">10</span>, <span class="number">130</span>, <span class="number">120</span>, <span class="number">30</span>), <span class="string">"Decrease Health"</span>)) &#123;</span><br><span class="line">			mPreferenceHealth -= <span class="number">10</span>;</span><br><span class="line">			mPlayerData.mHealth -= <span class="number">10</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (GUI.Button (<span class="keyword">new</span> Rect (<span class="number">10</span>, <span class="number">170</span>, <span class="number">120</span>, <span class="number">30</span>), <span class="string">"Save File"</span>)) &#123;</span><br><span class="line">			Save ();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (GUI.Button (<span class="keyword">new</span> Rect (<span class="number">10</span>, <span class="number">210</span>, <span class="number">120</span>, <span class="number">30</span>), <span class="string">"Load File"</span>)) &#123;</span><br><span class="line">			Load ();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (GUI.Button (<span class="keyword">new</span> Rect (<span class="number">10</span>, <span class="number">250</span>, <span class="number">120</span>, <span class="number">30</span>), <span class="string">"Save Preference"</span>)) &#123;</span><br><span class="line">			SavePreference ();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (GUI.Button (<span class="keyword">new</span> Rect (<span class="number">10</span>, <span class="number">290</span>, <span class="number">120</span>, <span class="number">30</span>), <span class="string">"Load Preference"</span>)) &#123;</span><br><span class="line">			LoadPreference ();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Save</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		Debug.Log (<span class="string">"Application.persistentDataPath = "</span> + Application.persistentDataPath);</span><br><span class="line">		<span class="keyword">if</span> (!File.Exists (mPlayerSavePath)) &#123;</span><br><span class="line">			FileStream fsc = File.Create(mPlayerSavePath);</span><br><span class="line">			fsc.Close();</span><br><span class="line">		&#125;</span><br><span class="line">		BinaryFormatter bf = <span class="keyword">new</span> BinaryFormatter ();</span><br><span class="line">		FileStream fs = File.Open (mPlayerSavePath, FileMode.Open);</span><br><span class="line">		</span><br><span class="line">		bf.Serialize (fs, mPlayerData);</span><br><span class="line">		fs.Close ();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Load</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(File.Exists(mPlayerSavePath))</span><br><span class="line">	    &#123;</span><br><span class="line">			BinaryFormatter bf = <span class="keyword">new</span> BinaryFormatter();</span><br><span class="line">			FileStream fs = File.Open(mPlayerSavePath,FileMode.Open);</span><br><span class="line">			mPlayerData = (PlayerData)bf.Deserialize(fs);</span><br><span class="line">			fs.Close();</span><br><span class="line">			Debug.Log(<span class="string">"Load: mPlayerData.mHealth = "</span> + mPlayerData.mHealth);</span><br><span class="line">			Debug.Log(<span class="string">"Load: mPlayerData.mB.BuildingType = "</span> + mPlayerData.mB.mBT);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SavePreference</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="comment">//Player preference</span></span><br><span class="line">		PlayerPrefs.SetFloat (<span class="string">"Health"</span>, mPreferenceHealth);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LoadPreference</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		Debug.Log(<span class="string">"Pre Health = "</span> + PlayerPrefs.GetFloat(<span class="string">"Health"</span>));</span><br><span class="line">		mPreferenceHealth = PlayerPrefs.GetFloat (<span class="string">"Health"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[Serializable]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">PlayerData</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">float</span> mHealth = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Building mB = <span class="keyword">new</span> Building();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[Serializable]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> BuildingType</span><br><span class="line">&#123;</span><br><span class="line">	E_WALL = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[Serializable]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Building</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">public</span> BuildingType mBT = BuildingType.E_WALL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="/img/Unity/Perssistence_PlayerPrefs_Serialization.PNG" alt="Screnn Shot"></p>
<p>Note:<br>Cross Platform except Web</p>
<h3 id="Unity_Editor_Window,_Menu_Item_&amp;_ScriptableObject">Unity Editor Window, Menu Item &amp; ScriptableObject</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEditor;</span><br><span class="line"></span><br><span class="line">[Serializable]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyScriptableObject</span> : <span class="title">ScriptableObject</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">string</span> mID = <span class="string">"1"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Use Editor Window to edit ScriptObject data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyEditorWindow</span> : <span class="title">EditorWindow</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">string</span> mValue = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	[MenuItem(<span class="string">"Window/MyEditorWindow"</span>)]</span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Init</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		MyEditorWindow window = (MyEditorWindow)EditorWindow.GetWindow (<span class="keyword">typeof</span>(MyEditorWindow));</span><br><span class="line">		window.Show ();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">OnGUI</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		MyScriptableObject asset = ScriptableObject.CreateInstance&lt;MyScriptableObject&gt; ();</span><br><span class="line">		asset = AssetDatabase.LoadAssetAtPath(<span class="string">"Assets/MyScriptableObject.asset"</span>,<span class="keyword">typeof</span>(MyScriptableObject)) <span class="keyword">as</span> MyScriptableObject;</span><br><span class="line">		mValue = asset.mID;</span><br><span class="line">		Debug.Log (<span class="string">"mValue = "</span> + mValue);</span><br><span class="line"></span><br><span class="line">		Debug.Log(<span class="string">"OnGUI"</span>);</span><br><span class="line">		GUILayout.Label (<span class="string">"mID"</span>, EditorStyles.boldLabel);</span><br><span class="line">		<span class="keyword">string</span> value2 = EditorGUILayout.TextField (<span class="string">"ID"</span>,mValue);</span><br><span class="line">		<span class="keyword">if</span> (GUILayout.Button (<span class="string">"Save"</span>, EditorStyles.miniButton)) &#123;</span><br><span class="line">			Debug.Log(<span class="string">"Save Button Clicked"</span>);</span><br><span class="line">			MyScriptableObject asset2 = ScriptableObject.CreateInstance&lt;MyScriptableObject&gt; ();</span><br><span class="line">			asset2.mID = value2;</span><br><span class="line">			AssetDatabase.CreateAsset (asset2, <span class="string">"Assets/MyScriptableObject.asset"</span>);</span><br><span class="line">			AssetDatabase.SaveAssets ();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Menu Item Study</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyMenuItems</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//Normal Menu Item</span></span><br><span class="line">	[MenuItem(<span class="string">"Tools/CreateScriptableAssets %q"</span>)]</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Save</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		MyScriptableObject asset = ScriptableObject.CreateInstance&lt;MyScriptableObject&gt; ();</span><br><span class="line">		asset.mID = <span class="string">"2"</span>;</span><br><span class="line">		AssetDatabase.CreateAsset (asset, <span class="string">"Assets/MyScriptableObject.asset"</span>);</span><br><span class="line">		AssetDatabase.SaveAssets ();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	[MenuItem(<span class="string">"Tools/LoadScriptableAssets %w"</span>)]</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Load</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Context Menu Item</span></span><br><span class="line">	[MenuItem(<span class="string">"Assets/ContextMenuItem"</span>)]</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ContextMenuItem</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">		Debug.Log(<span class="string">"ContextMenuItem()"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	[MenuItem(<span class="string">"CONTEXT/Transform/ContextMenuItem"</span>)]</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ContextMenuItem2</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		Debug.Log (<span class="string">"ContextMenuItem2"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	[MenuItem(<span class="string">"Assets/Create/ContextMenuItem"</span>)]</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ContextMenuItem3</span>(<span class="params"></span>)</span><br><span class="line">	</span>&#123;</span><br><span class="line">		Debug.Log (<span class="string">"ContextMenuItem3"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过自定义Menu Item的功能，我们可以快速创建一些我们所需要的原件</p>
<p>通过自定义Editor Window，我们可以用于制作特定数据的编辑框</p>
<p>ScriptableObject主要用于存储一些不重要的数据，和Monobehaviour的主要区别就是不用attach到游戏对象上，需要通过CreateInstance的方式来创建</p>
<p>结合自定义Editor Window和ScriptableObject的存储，我们可以通过自定义编辑框自定义数据并使用</p>
<p><img src="/img/Unity/EditorWindow_ScriptableObject.PNG" alt="Screnn Shot"></p>
<h1 id="C#学习">C#学习</h1><p>Book down load link: <a href="http://download.csdn.net/detail/baiyu9821179/4282298" target="_blank" rel="external">c#入门经典第五版</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/07/15/Unity-Study/" data-id="cif9i0urq0008gco0n4skxnr5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity/">Unity</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Sort-Algorithm" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/11/Sort-Algorithm/" class="article-date">
  <time datetime="2015-07-11T07:38:16.000Z" itemprop="datePublished">2015-07-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Algorithm/">Algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/11/Sort-Algorithm/">Sort Algorithm</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="排序算法概念">排序算法概念</h1><ol>
<li><p><strong>时间复杂度</strong> — 指执行算法所需要的计算工作量 </p>
<ol>
<li><em>平均时间复杂度</em> — 理论上一般情况的时间复杂度</li>
<li><em>最坏时间复杂度</em> — 特殊情况下（导致时间耗费最多的数据输入）</li>
<li><em>最优时间复杂度</em> — 特殊情况下（导致时间耗费最少的数据输入）</li>
</ol>
</li>
<li><p><strong>空间复杂度</strong> — 指执行算法所需要的内存空间</p>
</li>
</ol>
<h1 id="排序算法">排序算法</h1><hr>
<h2 id="冒泡排序(Sort_Algorithm)">冒泡排序(Sort Algorithm)</h2><p><em>基本思想：</em></p>
<ol>
<li>比较相邻的元素。如果第一个比第二个大，就交换他们两个。</li>
<li>对每一对相邻元素作同样的工作，从开始第一对到结尾的最后一对。这步做完后，最后的元素会是最大的数。</li>
<li>针对所有的元素重复以上的步骤，除了最后一个。</li>
<li>持续每次对越来越少的元素重复上面的步骤，直到没有任何一对数字需要比较。</li>
</ol>
<p><em>Code</em><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="keyword">int</span>* sortarray)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="comment">//双重循环都跟数据大小有关</span></span><br><span class="line">    <span class="comment">//所以冒泡排序平均时间复杂度是O(square(n))</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; intArraySize(sortarray); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; intArraySize(sortarray); j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>( sortarray[i] &gt; sortarray[j] )</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">swap_t</span>ime++;</span><br><span class="line">                swap(sortarray[i], sortarray[j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>冒泡排序时间复杂度</em><br>平均时间复杂度：O(square(n))<br>最坏时间复杂度：O(square(n)) （每一次比较都需要交换）<br>最优时间复杂度：O(n) （第一次循环就完成所有排序而无需进行后面的，需要判断结束条件）</p>
<h2 id="堆排序(Heap_Sort)">堆排序(Heap Sort)</h2><p><em>相关概念</em></p>
<ol>
<li>完全二叉树<br>除最后一层外，每一层的节点数均达到最大值；在最后一层上只缺右边的若干结点</li>
<li>堆<br>ki&lt;=k(2i）且ki&lt;=k(2i+1)(1≤i≤ n/2），当然，这是小根堆，大根堆则换成&gt;=号。//k(i）相当于二叉树的非叶子结点，K(2i）则是左子节点，k(2i+1）是右子节点 </li>
</ol>
<p><em>基本思想</em><br>利用最大堆最小堆的特性，我们可以很容易的拿到最大或最小值，通过构建最大最小堆我们可以得到排序后的值</p>
<ol>
<li>最大堆调整（Max_Heapify）：将堆的末端子节点作调整，使得子节点永远小于父节点</li>
<li>创建最大堆（Build_Max_Heap）：将堆所有数据重新排序</li>
<li>堆排序（HeapSort）：移除位在第一个数据的根节点，并做最大堆调整的递归运算</li>
</ol>
<p><em>Code</em><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//调整堆确保堆是最大堆，这里花O(log(n))，跟堆的深度有关</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">heapAdjust</span><span class="params">(<span class="keyword">int</span>* sortarray, <span class="keyword">int</span> parentindex, <span class="keyword">int</span> length)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> max_index = parentindex;</span><br><span class="line">	<span class="keyword">int</span> left_child_index = parentindex * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> right_child_index = parentindex * <span class="number">2</span> + <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Chose biggest one between parent and left&amp;right child</span></span><br><span class="line">	<span class="keyword">if</span>( left_child_index &lt; length &amp;&amp; sortarray[left_child_index] &gt; sortarray[max_index] )</span><br><span class="line">	&#123;</span><br><span class="line">		max_index = left_child_index;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( right_child_index &lt; length &amp;&amp; sortarray[right_child_index] &gt; sortarray[max_index] )</span><br><span class="line">	&#123;</span><br><span class="line">		max_index = right_child_index;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//If any child is bigger than parent, </span></span><br><span class="line">	<span class="comment">//then we swap it and do adjust for child again to make sure meet max heap definition</span></span><br><span class="line">	<span class="keyword">if</span>( max_index != parentindex )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">swap_t</span>ime++;</span><br><span class="line">		swap(sortarray[max_index], sortarray[parentindex]);</span><br><span class="line">		heapAdjust(sortarray, max_index, length);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过初试数据构建最大堆</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">buildingHeap</span><span class="params">(<span class="keyword">int</span>* sortarray)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="keyword">int</span>(intArraySize(sortarray)/<span class="number">2</span>) - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//1.2 Adjust heap</span></span><br><span class="line">		<span class="comment">//Make sure meet max heap definition</span></span><br><span class="line">		<span class="comment">//Max Heap definition:</span></span><br><span class="line">		<span class="comment">// (k(i) &gt;= k(2i) &amp;&amp; k(i) &gt;= k(2i+1))   (1 &lt;= i &lt;= n/2)</span></span><br><span class="line">		heapAdjust(sortarray, i, intArraySize(sortarray));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">heapSort</span><span class="params">(<span class="keyword">int</span>* sortarray)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="comment">//Steps:</span></span><br><span class="line">	<span class="comment">// 1. Build heap</span></span><br><span class="line">	<span class="comment">// 1.1 Init heap</span></span><br><span class="line">	<span class="comment">// 1.2 Adjust heap</span></span><br><span class="line">	<span class="comment">// 2. Sort heap</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//1. Build max heap</span></span><br><span class="line">	<span class="comment">// 1.1 Init heap</span></span><br><span class="line">	<span class="comment">//Assume we construct max heap</span></span><br><span class="line">	buildingHeap(sortarray);</span><br><span class="line">	<span class="comment">//2. Sort heap</span></span><br><span class="line">	<span class="comment">//这里花O(n)，跟数据数量有关</span></span><br><span class="line">	<span class="keyword">for</span>( <span class="keyword">int</span> i = intArraySize(sortarray) - <span class="number">1</span>; i &gt; <span class="number">0</span>; i-- )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//swap first element and last element</span></span><br><span class="line">		<span class="comment">//do adjust heap process again to make sure the new array are still max heap</span></span><br><span class="line">		swap(sortarray[i],sortarray[<span class="number">0</span>]);</span><br><span class="line">		<span class="comment">//Due to we already building max heap before,</span></span><br><span class="line">		<span class="comment">//so  we just need to adjust for index 0 after we swap first and last element</span></span><br><span class="line">		heapAdjust(sortarray, <span class="number">0</span>, i);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>堆排序时间复杂度</em><br>平均时间复杂度：O(n <em> log(n))<br>最坏时间复杂度：O(n </em> log(n))<br>最优时间复杂度：O(n <em> log(n)) (时间复杂度都跟堆的深度和数据长度相关，无可避免的需要去做堆调整和堆排序<br>所以最坏时间复杂度和最优时间复杂度都是O(n</em>log(n)</p>
<h2 id="快速排序(Quick_Sort)">快速排序(Quick Sort)</h2><p><em>基本思想</em></p>
<ol>
<li>选择一个值作为基准后，通过比较把小于基准值的值放到基准值左边，大于基准值的放到基准值右边，这样一来就有一个数据放在了正确位置。</li>
<li>通过分治的思想，将数据组不断细分成小数据组进行基准值的排序直到细分到只剩一个数据为止</li>
</ol>
<p><em>Code</em><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">partition</span><span class="params">(<span class="keyword">int</span>* sortarray, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="comment">//choose pivot</span></span><br><span class="line">	<span class="keyword">int</span> pivot = sortarray[r];</span><br><span class="line">	<span class="keyword">int</span> i = l;</span><br><span class="line">	<span class="keyword">for</span>( <span class="keyword">int</span> j = l; j &lt; r; j++ )</span><br><span class="line">	&#123;</span><br><span class="line">		time_complexity++;</span><br><span class="line">		<span class="keyword">if</span>( sortarray[j] &lt;= pivot )</span><br><span class="line">		&#123;</span><br><span class="line">			swap(sortarray[i],sortarray[j]);</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	swap(sortarray[i], sortarray[r]);</span><br><span class="line">	<span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">quicksort</span><span class="params">(<span class="keyword">int</span>* sortarray, <span class="keyword">int</span> low, <span class="keyword">int</span> high, <span class="keyword">bool</span> benableoptimize)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="comment">//partition</span></span><br><span class="line">	<span class="comment">//Here we use last element of array as pivot</span></span><br><span class="line">	<span class="comment">//recursion</span></span><br><span class="line">	<span class="comment">//Pivot chosen to optimize quicksort</span></span><br><span class="line">	<span class="comment">// median-of-three</span></span><br><span class="line">	<span class="keyword">int</span> pivotpos; </span><br><span class="line">	<span class="keyword">int</span> middlepos = (high + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">if</span>( benableoptimize )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>( sortarray[low] &gt; sortarray[middlepos] )</span><br><span class="line">		&#123;</span><br><span class="line">			swap(sortarray[low],sortarray[middlepos]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>( sortarray[middlepos] &gt; sortarray[high] )</span><br><span class="line">		&#123;</span><br><span class="line">			swap(sortarray[middlepos],sortarray[high]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>( sortarray[low] &gt; sortarray[middlepos] )</span><br><span class="line">		&#123;</span><br><span class="line">			swap(sortarray[low], sortarray[middlepos]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		pivotpos = middlepos;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		pivotpos = high;</span><br><span class="line">	&#125;</span><br><span class="line">	 </span><br><span class="line">	pivotpos=partition(sortarray,low,pivotpos);</span><br><span class="line">	quicksort(sortarray,low,pivotpos-<span class="number">1</span>,benableoptimize);</span><br><span class="line">	quicksort(sortarray,pivotpos+<span class="number">1</span>,high,benableoptimize);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>时间复杂度</em><br>平均时间复杂度：O(n <em> log(n)) (细分的时候每一次都对半分)<br>最坏时间复杂度：O(n </em> square(n)) （细分的时候每一次都分成一个和其他所有,所以在比较有序数据组面前快排效率不高）</p>
<p>最优时间复杂度：<br>快速排序可以通过选择更有效的基准值来提高效率<br>基准值会影响数据组的细分也就是影响后半部分分治的效率，所以最优时间复杂度取决于如何取基准值（上面提到median-of-three方式选基准值就是通过把第一和中间和最后元素排序后选取中间元素作为基准值来确保在细分的时候尽可能满足对半分从而提高效率）</p>
<h2 id="归并排序(Merge_Sort)">归并排序(Merge Sort)</h2><p><em>基本思想</em></p>
<ol>
<li>通过分治思想，把数据组的排列细分成排序多个的小数据组后合并</li>
<li>通过比较两两有序的小数据组完成合并后的数据排序，然后和其他有序数据组再次进行比较合并，最终完成所有数据的排列和合并</li>
</ol>
<p><em>Code</em><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="built_in">vector</span>&amp; sortarray, <span class="keyword">int</span> start, <span class="keyword">int</span> middle, <span class="keyword">int</span> end)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> left_size = middle - start + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> right_size = end - middle;</span><br><span class="line">	<span class="built_in">vector</span> left;</span><br><span class="line">	<span class="built_in">vector</span> right;</span><br><span class="line">	<span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; left_size; i++ )</span><br><span class="line">	&#123;</span><br><span class="line">		left.push_back(sortarray[start + i]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>( <span class="keyword">int</span> j = <span class="number">0</span>; j &lt; right_size; j++ )</span><br><span class="line">	&#123;</span><br><span class="line">		right.push_back(sortarray[j + middle + <span class="number">1</span>]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> index = start;</span><br><span class="line">	<span class="comment">//The worst condition is compare n * log(n) - n + 1</span></span><br><span class="line">	<span class="comment">//The best condition is compare n * log(n) / 2</span></span><br><span class="line">	<span class="keyword">while</span>( k &lt; left_size &amp;&amp; l &lt; right_size )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>( left[k] &lt; right[l] )</span><br><span class="line">		&#123;</span><br><span class="line">			sortarray[index] = left[k];</span><br><span class="line">			k++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			sortarray[index] = right[l];</span><br><span class="line">			l++;</span><br><span class="line">		&#125;</span><br><span class="line">		index++;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>( k &lt; left_size )</span><br><span class="line">	&#123;</span><br><span class="line">		sortarray[index] = left[k];</span><br><span class="line">		k++;</span><br><span class="line">		index++;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>( l &lt; right_size )</span><br><span class="line">	&#123;</span><br><span class="line">		sortarray[index] = right[l];</span><br><span class="line">		l++;</span><br><span class="line">		index++;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mergesort</span><span class="params">(<span class="built_in">vector</span>&amp; sortarray, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="comment">//sort first (subdivide array)</span></span><br><span class="line">	<span class="comment">//then merge (finally merge to together recursively)</span></span><br><span class="line">	<span class="keyword">if</span>( start &lt; end )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> middle = (end + start) / <span class="number">2</span>;</span><br><span class="line">		mergesort(sortarray, start, middle);</span><br><span class="line">		mergesort(sortarray, middle + <span class="number">1</span>, end);</span><br><span class="line">		merge(sortarray, start, middle, end);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>时间复杂度</em><br>平均时间复杂度：O( n <em> log(n) )<br>最优时间复杂度：O( n )（数据组已经有序，只需要把细分数据合并）<br>最坏时间复杂度：O( n </em> log(n) )</p>
<p><em>Note</em><br>因为归并排序需要存储细分后的数据组，所以归并排序比较占内存<br>归并比较次数 n介于 n <em> log(n) - n + 1 和 n </em> log(n) / 2<br>归并赋值次数2n <em> log(n)<br>归并平均时间复杂度和最坏时间复杂度都是n </em> log(n)<br>相比快速排序归并排序更稳定(最坏情况下)，而且更适合局部数据有序的情况</p>
<h2 id="插入排序(Insert_Sort)">插入排序(Insert Sort)</h2><p><em>基本思想</em><br>通过构建有序序列，对于未排序数据，在已排序序列中从后向前扫描，找到相应位置并插入</p>
<ol>
<li>从第一个元素开始，该元素可以认为已经被排序</li>
<li>取出下一个元素，在已经排序的元素序列中从后向前扫描</li>
<li>如果该元素（已排序）大于新元素，将该元素移到下一位置</li>
<li>重复步骤3，直到找到已排序的元素小于或者等于新元素的位置</li>
<li>将新元素插入到该位置后</li>
<li>重复步骤2~5</li>
</ol>
<p><em>Code</em><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insertSort</span><span class="params">(<span class="keyword">int</span>* sortarray)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="keyword">int</span> temp;</span><br><span class="line">	<span class="comment">//从第二个数开始取，依次插入，O(n)</span></span><br><span class="line">	<span class="keyword">for</span>( i = <span class="number">1</span>; i &lt; intArraySize(sortarray); i++ )</span><br><span class="line">	&#123;</span><br><span class="line">		temp = sortarray[i];</span><br><span class="line">		<span class="comment">//依次跟之前已经排序好的数组元素比较O(n)</span></span><br><span class="line">		<span class="keyword">for</span>( j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span> &amp;&amp; sortarray[j] &gt; temp; j-- )</span><br><span class="line">		&#123;</span><br><span class="line">			sortarray[j+<span class="number">1</span>] = sortarray[j];</span><br><span class="line">		&#125;</span><br><span class="line">		sortarray[j+<span class="number">1</span>] = temp;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>时间复杂度</em><br>平均时间复杂度：O(square(n))<br>最坏时间复杂度：O(square(n))<br>最优时间复杂度：O(n)（数据已经是有序的情况下，不需要比较，直接插入）</p>
<h1 id="总结">总结</h1><p>各排序算法有各自的优势，适合不同的情况。<br>相对稳定且时间复杂度低的排序算法：<br>堆排序，快速排序，归并排序</p>
<p>而归并排序相比快速排序更稳定（最坏情况下），更适合局部数据有序的情况，但归并的内存占用比较多</p>
<p>插入排序虽然时间复杂度比较高，但在已经排好序的数据面前，时间复杂度是O(n)<br>插入排序适合有序数据组且经常需要插入数据的情况</p>
<p>各排序算法时间复杂度总结：<br>来源：<a href="http://bost.ocks.org/mike/algorithms/" target="_blank" rel="external">Visualizing Algorithms</a><br><img src="/img/Algorithem/Sort-Algorithem.PNG" alt="Sort-Algorithem"></p>
<p>参考：<br><a href="http://www.cricode.com/3212.html" target="_blank" rel="external">8大排序算法图文讲解</a></p>
<p>推荐网站：<br><a href="http://bost.ocks.org/mike/algorithms/" target="_blank" rel="external">Visualizing Algorithms</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/07/11/Sort-Algorithm/" data-id="cif9i0uru000dgco0o845oncs" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Sort/">Sort</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm/">Algorithm</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Game-Engine/">Game_Engine</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Programming-Language/">Programming Language</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Rendering/">Rendering</a><span class="category-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenGL/">OpenGL</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Programming/">Programming</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sort/">Sort</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unity/">Unity</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/OpenGL/" style="font-size: 20px;">OpenGL</a> <a href="/tags/Programming/" style="font-size: 10px;">Programming</a> <a href="/tags/Sort/" style="font-size: 10px;">Sort</a> <a href="/tags/Unity/" style="font-size: 10px;">Unity</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/10/02/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2015/08/29/Computer-Graphic-Study/">Computer_Graphic_Study</a>
          </li>
        
          <li>
            <a href="/2015/08/26/OpenGL-Study/">OpenGL_Study</a>
          </li>
        
          <li>
            <a href="/2015/08/15/CSharp-Study/">C# Study</a>
          </li>
        
          <li>
            <a href="/2015/07/15/Unity-Study/">Unity Study</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>