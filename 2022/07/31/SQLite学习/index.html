
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>SQLite学习 | 走停人生路</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Tony Tang">
    

    
    <meta name="description" content="数据库数据存储对于游戏开发来说是必不可少的，在常规的游戏开发中，后端服务器会采用MySQL(关系型数据库),MongoDB(非关系型数据库)等作为数据库存储。
关于关系型和菲关系型数据库的学习理解参考:
网络通信和服务器学习
本章节是在没有后端但又有玩家数据存储需求的前提下诞生的，通过调研SQLite(关系型数据库)正是定位本地高效数据库而非CS结构的数据库，所以本章节通过深入学习SQLite，弄">
<meta property="og:type" content="article">
<meta property="og:title" content="SQLite学习">
<meta property="og:url" content="http://tonytang1990.github.io/2022/07/31/SQLite学习/index.html">
<meta property="og:site_name" content="走停人生路">
<meta property="og:description" content="数据库数据存储对于游戏开发来说是必不可少的，在常规的游戏开发中，后端服务器会采用MySQL(关系型数据库),MongoDB(非关系型数据库)等作为数据库存储。
关于关系型和菲关系型数据库的学习理解参考:
网络通信和服务器学习
本章节是在没有后端但又有玩家数据存储需求的前提下诞生的，通过调研SQLite(关系型数据库)正是定位本地高效数据库而非CS结构的数据库，所以本章节通过深入学习SQLite，弄">
<meta property="og:image" content="http://tonytang1990.github.io/img/Database/SQLiteUserInterface.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Database/SQLitePlugin.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Database/CreateDatabase.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Database/CreatePlayerTable.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Database/PlayerTableView.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Database/InsertPlayerTableData.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Database/DeletePlayerTableData.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Database/ModifyPlayerTableAgeData.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Database/DeleteAllPlayerTableData.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Database/DatabaseAfterDeleteAllPlayerTableData.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Database/DeletePlayerTable.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Database/DatabaseViewAfterDeletePlayerTable.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Database/AndroidSQLiteUsing.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Database/AndroidDatabaseView.png">
<meta property="og:updated_time" content="2022-07-31T12:56:43.077Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SQLite学习">
<meta name="twitter:description" content="数据库数据存储对于游戏开发来说是必不可少的，在常规的游戏开发中，后端服务器会采用MySQL(关系型数据库),MongoDB(非关系型数据库)等作为数据库存储。
关于关系型和菲关系型数据库的学习理解参考:
网络通信和服务器学习
本章节是在没有后端但又有玩家数据存储需求的前提下诞生的，通过调研SQLite(关系型数据库)正是定位本地高效数据库而非CS结构的数据库，所以本章节通过深入学习SQLite，弄">

    
    <link rel="alternative" href="/atom.xml" title="走停人生路" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.jpg" alt="走停人生路" title="走停人生路"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="走停人生路">走停人生路</a></h1>
				<h2 class="blog-motto">做着独立游戏梦，坚持走在游戏开发道路上的人</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜單">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:tonytang1990.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2022/07/31/SQLite学习/" title="SQLite学习" itemprop="url">SQLite学习</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Tony Tang" target="_blank" itemprop="author">Tony Tang</a>
		
  <p class="article-time">
    <time datetime="2022-07-31T06:35:00.000Z" itemprop="datePublished"> 發表於 2022-07-31</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目錄</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#数据库"><span class="toc-number">1.</span> <span class="toc-text">数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SQLite"><span class="toc-number">1.1.</span> <span class="toc-text">SQLite</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#What"><span class="toc-number">1.1.1.</span> <span class="toc-text">What</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Why"><span class="toc-number">1.1.2.</span> <span class="toc-text">Why</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How"><span class="toc-number">1.1.3.</span> <span class="toc-text">How</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQLite4Unity3d实战"><span class="toc-number">1.2.</span> <span class="toc-text">SQLite4Unity3d实战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PC实战"><span class="toc-number">1.2.1.</span> <span class="toc-text">PC实战</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Android实战"><span class="toc-number">1.2.2.</span> <span class="toc-text">Android实战</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQLite4Unity3d进阶"><span class="toc-number">1.2.3.</span> <span class="toc-text">SQLite4Unity3d进阶</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#结论"><span class="toc-number">1.3.</span> <span class="toc-text">结论</span></a></li></ol></li></ol>
		
		</div>
		
		<h1 id="数据库">数据库</h1><p>数据存储对于游戏开发来说是必不可少的，在常规的游戏开发中，后端服务器会采用<strong>MySQL(关系型数据库)</strong>,<strong>MongoDB(非关系型数据库)</strong>等作为数据库存储。</p>
<p>关于关系型和菲关系型数据库的学习理解参考:</p>
<p><a href="http://tonytang1990.github.io/2019/05/20/%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AD%A6%E4%B9%A0/">网络通信和服务器学习</a></p>
<p>本章节是在没有后端但又有玩家数据存储需求的前提下诞生的，通过调研<strong>SQLite(关系型数据库)</strong>正是定位本地高效数据库而非CS结构的数据库，所以本章节通过深入学习SQLite，弄懂如何正确高效的把本地玩家数据存储到本地数据库。</p>
<h2 id="SQLite">SQLite</h2><h3 id="What">What</h3><p>首先来看看SQLite官网的一个介绍:<br><a href="https://www.sqlite.org/whentouse.html" target="_blank" rel="external">SQLite is not directly comparable to client/server SQL database engines such as MySQL, Oracle, PostgreSQL, or SQL Server since SQLite is trying to solve a different problem.<br>Client/server SQL database engines strive to implement a shared repository of enterprise data. They emphasize scalability, concurrency, centralization, and control. SQLite strives to provide local data storage for individual applications and devices. SQLite emphasizes economy, efficiency, reliability, independence, and simplicity.<br>SQLite does not compete with client/server databases. SQLite competes with fopen().</a><br>从上面的介绍可以看出，SQLite(C语言编写的库)虽然也是关系型数据库，但他的定位和MySQL不一样，定位的是本地高效数据库而非CS结构的数据库。</p>
<h3 id="Why">Why</h3><p>那么什么时候适用于SQLite?什么时候适用于MySQL(CS)了？<br>SQLite官网也给出了明确的介绍，详情参见官网<a href="https://www.sqlite.org/whentouse.html" target="_blank" rel="external">SQLite</a><br>这里只列举下官网介绍的什么时候适用于MYSQL:</p>
<ol>
<li>Client/Server Applications(CS结构的程序—需要大量客户端服务器通信存储)</li>
<li>High-volume Websites(高吞吐量的网站)</li>
<li>Very large datasets(数据存储量大—数据大)</li>
<li>High Concurrency(高并发—很多人同时写入)</li>
</ol>
<h3 id="How">How</h3><p>这里本人明确了暂时是打算用于单机版游戏的本地数据库，所以倾向于用SQLite来做。<br>接下来会接触以下几个知识点：</p>
<ol>
<li>Unity(游戏开发引擎)</li>
<li>SQLite4Unity3d(第三方给Unity封装好的SQLite库—支持Window，Android(ARM64貌似也支持了)和IOS)</li>
<li>Navicat(可视化数据库工具)</li>
<li>SQL(数据库查询语言)</li>
</ol>
<p><strong>目标</strong>:</p>
<ol>
<li>编写一个数据库操作UI界面，支持数据库的增删改查操作(方便学习使用SQLite4Unity3d提供的接口访问SQLite数据库)</li>
<li>利用Navicat查看Window本地存储的数据库数据(学会Navicat的基本使用和数据库SQL相关操作)</li>
<li>打包编译Window和Android版本到真机上查看效果(确保多平台的兼容性)</li>
</ol>
<h2 id="SQLite4Unity3d实战">SQLite4Unity3d实战</h2><p><strong>环境准备</strong>:<br>Unity版本：2018.4.8f1<br>SQLite4Unity3d: <a href="https://github.com/robertohuertasm/SQLite4Unity3d" target="_blank" rel="external">SQLite4Unity3d</a><br>Navivat: <a href="https://www.navicat.com/en/download/navicat-premium" target="_blank" rel="external">Navicat Premium</a><br>SQL:<a href="https://www.runoob.com/sql/sql-tutorial.html" target="_blank" rel="external">SQL学习1</a> or <a href="https://www.w3schools.com/sql/" target="_blank" rel="external">SQL学习2</a></p>
<p>Note:</p>
<ol>
<li><a href="https://github.com/robertohuertasm/SQLite4Unity3d" target="_blank" rel="external"><strong>SQLite4Unity3d uses only the synchronous part of sqlite-net, so all the calls to the database are synchronous.</strong></a>(<strong>SQLite4Unity3d有这么一句官方提示，可以看出所有的数据库操作都是同步的。这里考虑到都是单机本地存储同时数据量也不会很大，所以同步异步不是很重要，所以并不影响个人使用。</strong>)</li>
</ol>
<h3 id="PC实战">PC实战</h3><p>接下来结合SQLite4Unity3d来实战学习数据库的增删改查等操作。<br><strong>第1步</strong><br>创建空的Unity工程，制作简单的交互UI<br><img src="/img/Database/SQLiteUserInterface.png" alt="SQLiteUserInterface"></p>
<p><strong>第2步</strong><br>拷贝SQLite相关库文件：<br><img src="/img/Database/SQLitePlugin.png" alt="SQLitePlugin"><br>还要拷贝SQLite.cs(SQLite4Unity3d作者封装的访问SQLite的相关接口)<br>通过查看SQLite.cs的源代码可以看出,作者封装的这一层通过CS层多抽象了一层数据库访问(增删改查)和表格数据结构，然后结合反射(反射查找对应类的数据库)和Linq(实现快速的数据库查询)来实现通用的数据访问。</p>
<p><strong>第4步</strong><br>定义数据库表结构:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> 玩家信息</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Player</span></span><br><span class="line">&#123;</span><br><span class="line">    [PrimaryKey]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> UID &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> FirstName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> LastName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">string</span> <span class="title">ToString</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="string">"[Player: UId=&#123;UID&#125;, FirstName=&#123;FirstName&#125;,  LastName=&#123;LastName&#125;, Age=&#123;Age&#125;]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>第4步</strong><br>建立SQLite数据库连接(不存在的话会根据Flag决定是否自动创建):</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">if</span> UNITY_EDITOR</span></span><br><span class="line">        DatabaseFolderPath = <span class="string">"Assets/StreamingAssets/"</span>;</span><br><span class="line"><span class="preprocessor">#<span class="keyword">else</span></span></span><br><span class="line">        DatabaseFolderPath = $<span class="string">"&#123;Application.persistentDataPath&#125;/"</span>;</span><br><span class="line"><span class="preprocessor">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="comment">// 建立数据库连接</span></span><br><span class="line">        mSQLiteConnect = <span class="keyword">new</span> SQLiteConnection($<span class="string">"&#123;DatabaseFolderPath&#125;/&#123;DatabaseName&#125;"</span>, SQLiteOpenFlags.ReadWrite | SQLiteOpenFlags.Create);</span><br></pre></td></tr></table></figure>
<p>可以看到本来StreamingAssets目录下没有数据库文件的这一下就创建成功了。<br><img src="/img/Database/CreateDatabase.png" alt="CreateDatabase"></p>
<p><strong>第5步</strong><br>数据库里创建玩家表:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mSQLiteConnect.CreateTable&lt;Player&gt;();</span><br></pre></td></tr></table></figure>
<p><img src="/img/Database/CreatePlayerTable.png" alt="CreatePlayerTable"><br>因为还没有数据所以看不到数据打印，通过Navicat打开数据库，我们可以看到已经成功创建了Player表:<br><img src="/img/Database/PlayerTableView.png" alt="PlayerTableView"></p>
<p><strong>第6步</strong><br>玩家表插入玩家数据：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">mSQLiteConnect.Insert(<span class="keyword">new</span> Player</span><br><span class="line">        &#123;</span><br><span class="line">            UID = <span class="number">1</span>,</span><br><span class="line">            FirstName = <span class="string">"Huan"</span>,</span><br><span class="line">            LastName = <span class="string">"Tang"</span>,</span><br><span class="line">            Age = <span class="number">29</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        mSQLiteConnect.Insert(<span class="keyword">new</span> Player</span><br><span class="line">        &#123;</span><br><span class="line">            UID = <span class="number">3</span>,</span><br><span class="line">            FirstName = <span class="string">"XiaoYun"</span>,</span><br><span class="line">            LastName = <span class="string">"Zhou"</span>,</span><br><span class="line">            Age = <span class="number">28</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        mSQLiteConnect.Insert(<span class="keyword">new</span> Player</span><br><span class="line">        &#123;</span><br><span class="line">            UID = <span class="number">2</span>,</span><br><span class="line">            FirstName = <span class="string">"Jiang"</span>,</span><br><span class="line">            LastName = <span class="string">"Fan"</span>,</span><br><span class="line">            Age = <span class="number">28</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        mSQLiteConnect.Insert(<span class="keyword">new</span> Player</span><br><span class="line">        &#123;</span><br><span class="line">            UID = <span class="number">5</span>,</span><br><span class="line">            FirstName = <span class="string">"ZhenLiang"</span>,</span><br><span class="line">            LastName = <span class="string">"Li"</span>,</span><br><span class="line">            Age = <span class="number">29</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        mSQLiteConnect.Insert(<span class="keyword">new</span> Player</span><br><span class="line">        &#123;</span><br><span class="line">            UID = <span class="number">4</span>,</span><br><span class="line">            FirstName = <span class="string">"XiaoLin"</span>,</span><br><span class="line">            LastName = <span class="string">"Kuang"</span>,</span><br><span class="line">            Age = <span class="number">28</span>,</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>
<p><img src="/img/Database/InsertPlayerTableData.png" alt="InsertPlayerTableData"></p>
<p><strong>第7步</strong><br>玩家表删除指定玩家ID数据：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mSQLiteConnect.Delete&lt;Player&gt;(deleteuid);</span><br></pre></td></tr></table></figure>
<p><img src="/img/Database/DeletePlayerTableData.png" alt="DeletePlayerTableData"></p>
<p><strong>第7步</strong><br>玩家表修改指定玩家Age数据：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">valideplayer.Age = newage;</span><br><span class="line">mSQLiteConnect.Update(valideplayer);</span><br></pre></td></tr></table></figure>
<p><img src="/img/Database/ModifyPlayerTableAgeData.png" alt="ModifyPlayerTableAgeData"></p>
<p><strong>第8步</strong><br>删除玩家表所有数据：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> rownumber = mSQLiteConnect.DeleteAll&lt;Player&gt;();</span><br></pre></td></tr></table></figure>
<p><img src="/img/Database/DeleteAllPlayerTableData.png" alt="DeleteAllPlayerTableData"><br>可以看到我们成功删除了玩家表里的所有数据，接下来用Navicat验证下数据库里的情况：<br><img src="/img/Database/DatabaseAfterDeleteAllPlayerTableData.png" alt="DatabaseAfterDeleteAllPlayerTableData"></p>
<p><strong>第9步</strong><br>删除数据库里的玩家表：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> rownumberaffected = mSQLiteConnect.DropTable&lt;Player&gt;();</span><br></pre></td></tr></table></figure>
<p><img src="/img/Database/DeletePlayerTable.png" alt="DeletePlayerTable"><br>删除玩家表后通过Navicat查看数据库:<br><img src="/img/Database/DatabaseViewAfterDeletePlayerTable.png" alt="DatabaseViewAfterDeletePlayerTable"><br>通过查看源码，我们可以看到，DraopTable底层实际是通过调用SQL的Drop语句来实现删除表的:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> Executes a "drop table" on the database.  This is non-recoverable.</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span> DropTable&lt;T&gt;()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> map = GetMapping (<span class="keyword">typeof</span> (T));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> query = <span class="keyword">string</span>.Format(<span class="string">"drop table if exists \"&#123;0&#125;\""</span>, map.TableName);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Execute (query);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关于SQL更多学习参考:<br><a href="https://www.runoob.com/sql/sql-tutorial.html" target="_blank" rel="external">SQL 教程</a><br><a href="https://www.w3schools.com/sql/default.asp" target="_blank" rel="external">SQL Tutorial</a><br>可以看到通过使用SQLite4Unity3d的SQLite.cs相关的接口，成功的实现了对于数据库的创建，以及数据库表的创建，增删改查等操作。</p>
<p><strong>第10步</strong><br>关闭数据库连接:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mSQLiteConnect.Close();</span><br></pre></td></tr></table></figure>
<h3 id="Android实战">Android实战</h3><p>为了验证SQLite4Unity3d的跨平台能力，接下来打包验证真机:<br>Android真机数据库操作:<br><img src="/img/Database/AndroidSQLiteUsing.png" alt="AndroidSQLiteUsing"></p>
<p>Android真机数据库文件查看(本人使用的<strong>ES文件浏览器</strong>)：<br>![DatabaseViewAfterOperation]/img/Database/DatabaseViewAfterOperation.png)</p>
<p>Android真机数据库详细信息PC查看:<br><img src="/img/Database/AndroidDatabaseView.png" alt="AndroidDatabaseView"></p>
<p>可以看到Android真机上数据库的一些基础操作都成功了的。IOS这里就暂时不验证了，根据Github上的介绍理论上是支持的。</p>
<p>Note:</p>
<ol>
<li>真机可读取目录修改为Application.persistentDataPath,因为Application.streamingAssetsPath在真机上是只读目录。</li>
<li>真机使用<strong>ES文件浏览器</strong>来查看程序目录下的数据库文件</li>
</ol>
<h3 id="SQLite4Unity3d进阶">SQLite4Unity3d进阶</h3><p>学习了SQLite4Unity3d的基础使用，接下来要考虑的是实战使用时，如何封装一层数据库管理，方便游戏里的所有数据库数据都成功的加载读取修改保存。</p>
<p>这里主要是对于SQLite.cs的简单封装，用于支持多数据库创建，以及数据库创建路径管理。<br>DatabaseManager.cs</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * Description:             DatabaseManager.cs</span><br><span class="line"> * Author:                  TANGHUAN</span><br><span class="line"> * Create Date:             2020/03/13</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">using SQLite4Unity3d;</span><br><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.IO;</span><br><span class="line">using System.Linq.Expressions;</span><br><span class="line">using UnityEngine;</span><br><span class="line"></span><br><span class="line">namespace TH.Modules.Data</span><br><span class="line">&#123;</span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 数据库管理类</span><br><span class="line">    /// 主要功能如下:</span><br><span class="line">    /// 1. 数据库路径处理(数据库存储管理)</span><br><span class="line">    /// 2. 多数据库支持</span><br><span class="line">    /// 3. 数据库连接，关闭，CUID操作等操作依然使用SQLite的封装</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    public class DatabaseManager : SingletonTemplate&lt;DatabaseManager&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// 数据库文件夹地址</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        private readonly static string DatabaseFolderPath = Application.persistentDataPath + "/Database/";</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// 已连接的数据库映射Map</span><br><span class="line">        /// Key为数据库名，Value为对应的数据库连接</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        private Dictionary&lt;string, SQLiteConnection&gt; ConnectedDatabaseMap;</span><br><span class="line"></span><br><span class="line">        public DatabaseManager()</span><br><span class="line">        &#123;</span><br><span class="line">            //检查数据库文件目录是否存在</span><br><span class="line">            if(!Directory.Exists(DatabaseFolderPath))</span><br><span class="line">            &#123;</span><br><span class="line">                Directory.CreateDirectory(DatabaseFolderPath);</span><br><span class="line">            &#125;</span><br><span class="line">            ConnectedDatabaseMap = new Dictionary&lt;string, SQLiteConnection&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// 打开数据库连接</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;param name="databasename"&gt;&lt;/param&gt;</span><br><span class="line">        /// &lt;param name="openflags"&gt;&lt;/param&gt;</span><br><span class="line">        /// &lt;param name="storeDateTimeAsTicks"&gt;&lt;/param&gt;</span><br><span class="line">        public void openDatabase(string databasename, SQLiteOpenFlags openflags = SQLiteOpenFlags.ReadWrite | SQLiteOpenFlags.Create, bool storeDateTimeAsTicks = false)</span><br><span class="line">        &#123;</span><br><span class="line">            if(!isDatabaseConnected(databasename))</span><br><span class="line">            &#123;</span><br><span class="line">                var databasepath = DatabaseFolderPath + databasename;</span><br><span class="line">                var connection = new SQLiteConnection(databasepath, openflags, storeDateTimeAsTicks);</span><br><span class="line">                ConnectedDatabaseMap.Add(databasename, connection);</span><br><span class="line">                Debug.Log($"连接数据库:&#123;databasename&#125;");</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                Debug.Log($"数据库:&#123;databasename&#125;已连接,请勿重复连接!");</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// 获取指定数据库连接</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;param name="databasename"&gt;&lt;/param&gt;</span><br><span class="line">        /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">        public SQLiteConnection getDatabaseConnection(string databasename)</span><br><span class="line">        &#123;</span><br><span class="line">            SQLiteConnection connection;</span><br><span class="line">            if (ConnectedDatabaseMap.TryGetValue(databasename, out connection))</span><br><span class="line">            &#123;</span><br><span class="line">                return connection;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                return null;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// 关闭数据库连接</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;param name="databasename"&gt;&lt;/param&gt;</span><br><span class="line">        public void closeDatabase(string databasename)</span><br><span class="line">        &#123;</span><br><span class="line">            SQLiteConnection connection;</span><br><span class="line">            if(ConnectedDatabaseMap.TryGetValue(databasename, out connection))</span><br><span class="line">            &#123;</span><br><span class="line">                connection.Close();</span><br><span class="line">                ConnectedDatabaseMap.Remove(databasename);</span><br><span class="line">                Debug.Log($"关闭数据库:&#123;databasename&#125;");</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                Debug.LogError($"未连接数据库:&#123;databasename&#125;,关闭失败!");</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// 关闭所有已连接的数据库</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        public void closeAllDatabase()</span><br><span class="line">        &#123;</span><br><span class="line">            foreach (var databasename in ConnectedDatabaseMap.Keys)</span><br><span class="line">            &#123;</span><br><span class="line">                closeDatabase(databasename);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// 清除</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        public void clear()</span><br><span class="line">        &#123;</span><br><span class="line">            closeAllDatabase();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// 指定数据库是否已连接</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;param name="databasename"&gt;&lt;/param&gt;</span><br><span class="line">        /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">        private bool isDatabaseConnected(string databasename)</span><br><span class="line">        &#123;</span><br><span class="line">            return ConnectedDatabaseMap.ContainsKey(databasename);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        #region 辅助方法</span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// 获取指定数据库表的所有数据</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;typeparam name="T"&gt;&lt;/typeparam&gt;</span><br><span class="line">        /// &lt;param name="databasename"&gt;数据库名&lt;/param&gt;</span><br><span class="line">        /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">        public string getTableAllDatasInOneString&lt;T&gt;(string databasename) where T : new()</span><br><span class="line">        &#123;</span><br><span class="line">            SQLiteConnection sqliteconnection = getDatabaseConnection(databasename);</span><br><span class="line">            if (sqliteconnection != null)</span><br><span class="line">            &#123;</span><br><span class="line">                var querytable = sqliteconnection.Table&lt;T&gt;();</span><br><span class="line">                if (querytable != null)</span><br><span class="line">                &#123;</span><br><span class="line">                    var result = string.Empty;</span><br><span class="line">                    foreach (var data in querytable)</span><br><span class="line">                    &#123;</span><br><span class="line">                        result += data.ToString();</span><br><span class="line">                        result += "\n";</span><br><span class="line">                    &#125;</span><br><span class="line">                    return result;</span><br><span class="line">                &#125;</span><br><span class="line">                else</span><br><span class="line">                &#123;</span><br><span class="line">                    return string.Empty;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                return string.Empty;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        #endregion</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>TODO:<br>现阶段是默认存在包外的persistentDataPath，对于数据库如何做好加密管理避免被轻易修改，这个问题还有待学习思考。</p>
<h2 id="结论">结论</h2><ol>
<li><p><strong>SQLite适用于非CS结构，存储数据量不大，不会多人并发操作数据库的情况(好比单机游戏的数据库)。</strong></p>
</li>
<li><p><strong>数据量大或者多人操作频繁或者需要CS架构支持，更适合MySQL+Redis</strong></p>
</li>
<li><p><strong>SQLite4Unity3d通过反射和Linq对SQLite的封装实现了对于SQL无感和ORM(Object Relational Mapping)数据库访问方式。</strong></p>
</li>
<li><p><strong>SQLite4Unity3d支持多平台，适合单机游戏数据存储</strong></p>
</li>
</ol>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Database/">Database</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Database/">Database</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://tonytang1990.github.io/2022/07/31/SQLite学习/" data-title="SQLite学习 | 走停人生路" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 

<div class="next">
<a href="/2022/07/16/网络对时/"  title="网络对时">
 <strong>下一篇：</strong><br/> 
 <span>网络对时
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2022/07/31/SQLite学习/" data-title="SQLite学习" data-url="http://tonytang1990.github.io/2022/07/31/SQLite学习/"></div>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="顯示側邊欄"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目錄</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#数据库"><span class="toc-number">1.</span> <span class="toc-text">数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SQLite"><span class="toc-number">1.1.</span> <span class="toc-text">SQLite</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#What"><span class="toc-number">1.1.1.</span> <span class="toc-text">What</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Why"><span class="toc-number">1.1.2.</span> <span class="toc-text">Why</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How"><span class="toc-number">1.1.3.</span> <span class="toc-text">How</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQLite4Unity3d实战"><span class="toc-number">1.2.</span> <span class="toc-text">SQLite4Unity3d实战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PC实战"><span class="toc-number">1.2.1.</span> <span class="toc-text">PC实战</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Android实战"><span class="toc-number">1.2.2.</span> <span class="toc-text">Android实战</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQLite4Unity3d进阶"><span class="toc-number">1.2.3.</span> <span class="toc-text">SQLite4Unity3d进阶</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#结论"><span class="toc-number">1.3.</span> <span class="toc-text">结论</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隱藏側邊欄"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分類</p>
		<ul>
		
		  
			<li><a href="/categories/AI/" title="AI">AI<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Algorithm/" title="Algorithm">Algorithm<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android/" title="Android">Android<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Art/" title="Art">Art<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Automation/" title="Automation">Automation<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Collision/" title="Collision">Collision<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Computer/" title="Computer">Computer<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Database/" title="Database">Database<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/Editor/" title="Editor">Editor<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Excel/" title="Excel">Excel<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/HotUpdate/" title="HotUpdate">HotUpdate<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Lua/" title="Lua">Lua<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Math/" title="Math">Math<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Native/" title="Native">Native<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Network/" title="Network">Network<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Optimization/" title="Optimization">Optimization<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Other/" title="Other">Other<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Plugin/" title="Plugin">Plugin<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Programming-Language/" title="Programming Language">Programming Language<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Rendering/" title="Rendering">Rendering<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/Resource/" title="Resource">Resource<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/UI/" title="UI">UI<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Unity/" title="Unity">Unity<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/VersionControl/" title="VersionControl">VersionControl<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">標簽</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Unity/" title="Unity">Unity<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/Editor/" title="Editor">Editor<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/OpenGL/" title="OpenGL">OpenGL<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/AI/" title="AI">AI<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Other/" title="Other">Other<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Math/" title="Math">Math<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Resource/" title="Resource">Resource<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Excel/" title="Excel">Excel<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Art/" title="Art">Art<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Collision/" title="Collision">Collision<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/VersionControl/" title="VersionControl">VersionControl<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/HotUpdate/" title="HotUpdate">HotUpdate<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Algorithm/" title="Algorithm">Algorithm<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Network/" title="Network">Network<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Sort/" title="Sort">Sort<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/GameDesignPattern/" title="GameDesignPattern">GameDesignPattern<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Optimization/" title="Optimization">Optimization<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Time/" title="Time">Time<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Plugin/" title="Plugin">Plugin<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Prefab/" title="Prefab">Prefab<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情鏈接</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 訂閱</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Tony Tang. <br/>
			This is my new blog.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2022 
		
		<a href="/about" target="_blank" title="Tony Tang">Tony Tang</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"TonyTang1990"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回頂部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
