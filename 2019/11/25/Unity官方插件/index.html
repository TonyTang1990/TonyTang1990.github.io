
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>Unity官方插件 | 走停人生路</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Tony Tang">
    

    
    <meta name="description" content="前言本篇文章是为了记录学习Unity官方一些好的第三方插件，作为基础的学习了解，为未来遇到问题思考解决方案时拓宽思路。
Sprite Atlas依然从What，Why，How三个角度了学习了解Sprite Atlas。
WhatSprite Atlas是官方Sprite Packer的升级版本，是为了更好的解决图集打包加载问题而开发的，而图集是为了解决Draw Call问题。
Why老版Unity">
<meta property="og:type" content="article">
<meta property="og:title" content="Unity官方插件">
<meta property="og:url" content="http://tonytang1990.github.io/2019/11/25/Unity官方插件/index.html">
<meta property="og:site_name" content="走停人生路">
<meta property="og:description" content="前言本篇文章是为了记录学习Unity官方一些好的第三方插件，作为基础的学习了解，为未来遇到问题思考解决方案时拓宽思路。
Sprite Atlas依然从What，Why，How三个角度了学习了解Sprite Atlas。
WhatSprite Atlas是官方Sprite Packer的升级版本，是为了更好的解决图集打包加载问题而开发的，而图集是为了解决Draw Call问题。
Why老版Unity">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/SpriteAtlas/EnableSpriteAtlas.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/SpriteAtlas/SpriteAtlasSetting.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/SpriteAtlas/PackPreview.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/SpriteAtlas/IncludeInBuildCauseRedundancySpriteAtlasTexture.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/SpriteAtlas/SpriteAtlasVariants.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/SpriteAtlas/SpriteAtlasAssetBundlePreview.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/SpriteAtlas/UIPrefabReferenceNotIncludeBuildSpriteAtlas.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/SpriteAtlas/UIPrefabSpriteMissing.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/SpriteAtlas/UIPrefabDepencency.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/TimelineAssetHierachy.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/TimelineComponent.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/TimelineCustomPlayable.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/TimelinePlayableDirectorInspector.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/PlayableOutputPreview.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/PlayableGraphVisualizerPreview.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/AnimationClipMixPreview.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/MultipleAnimationInputAndOutputPreview.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/MultipleAnimationBlendAndSetPlayableState.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/TimelineCinemachineTrack.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/CustomTimelinePrefabHierachyPreview.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/CustomAudioTrackPreview.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/CustomAudioAssetBGMInspector.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/CustomAudioAssetSoundInspector.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/CustomAudioTrackWithAudioSourceBindingPreview.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/CinemachineBrain.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/CinemachineVirtualCamera.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/CinemachineBodyProperties.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/CinemachineAimProperties.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/CinemachineZone.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/Timeline_Cinemachine/CinemachineCameraTypes.PNG">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/TextMeshPro/FontAssetCreatePanel.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/TextMeshPro/SpriteAssetCreatePanel.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/TextMeshPro/TextMeshProAssignFontAssetAndSpriteAsset.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/TextMeshPro/TextMeshProUsing.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/TextMeshPro/CreateFontAssetMaterial.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/TextMeshPro/FontAssetMaterialChosen.png">
<meta property="og:image" content="http://tonytang1990.github.io/img/Unity/TextMeshPro/TMPSettings.png">
<meta property="og:updated_time" content="2021-10-15T00:55:48.661Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Unity官方插件">
<meta name="twitter:description" content="前言本篇文章是为了记录学习Unity官方一些好的第三方插件，作为基础的学习了解，为未来遇到问题思考解决方案时拓宽思路。
Sprite Atlas依然从What，Why，How三个角度了学习了解Sprite Atlas。
WhatSprite Atlas是官方Sprite Packer的升级版本，是为了更好的解决图集打包加载问题而开发的，而图集是为了解决Draw Call问题。
Why老版Unity">

    
    <link rel="alternative" href="/atom.xml" title="走停人生路" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.jpg" alt="走停人生路" title="走停人生路"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="走停人生路">走停人生路</a></h1>
				<h2 class="blog-motto">做着独立游戏梦，坚持走在游戏开发道路上的人</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜單">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:tonytang1990.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2019/11/25/Unity官方插件/" title="Unity官方插件" itemprop="url">Unity官方插件</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Tony Tang" target="_blank" itemprop="author">Tony Tang</a>
		
  <p class="article-time">
    <time datetime="2019-11-25T13:27:18.000Z" itemprop="datePublished"> 發表於 2019-11-25</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目錄</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Sprite_Atlas"><span class="toc-number">1.1.</span> <span class="toc-text">Sprite Atlas</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#What"><span class="toc-number">1.1.1.</span> <span class="toc-text">What</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Why"><span class="toc-number">1.1.2.</span> <span class="toc-text">Why</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How"><span class="toc-number">1.1.3.</span> <span class="toc-text">How</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#创建、编辑图集以及设定图集参数"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">创建、编辑图集以及设定图集参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#添加图集Variant（变种）"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">添加图集Variant（变种）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#运行时访问图集"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">运行时访问图集</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Later_Bind"><span class="toc-number">1.1.3.3.1.</span> <span class="toc-text">Later Bind</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#注意事项"><span class="toc-number">1.1.3.3.2.</span> <span class="toc-text">注意事项</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#相关概念"><span class="toc-number">1.1.3.3.3.</span> <span class="toc-text">相关概念</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Bug记录"><span class="toc-number">1.1.3.3.4.</span> <span class="toc-text">Bug记录</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#结论"><span class="toc-number">1.1.3.3.5.</span> <span class="toc-text">结论</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Timeline"><span class="toc-number">1.2.</span> <span class="toc-text">Timeline</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Timeline_Asset"><span class="toc-number">1.2.1.</span> <span class="toc-text">Timeline Asset</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#介绍"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#分类"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">分类</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Playable_Track"><span class="toc-number">1.2.1.2.1.</span> <span class="toc-text">Playable Track</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Timeline_instance"><span class="toc-number">1.2.2.</span> <span class="toc-text">Timeline instance</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#介绍-1"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">介绍</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Timeline类设计"><span class="toc-number">1.2.3.</span> <span class="toc-text">Timeline类设计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Playable"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">Playable</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PlayableGraph"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">PlayableGraph</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PlayableAsset"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">PlayableAsset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PlayableBehaviour"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">PlayableBehaviour</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PlayableOutput"><span class="toc-number">1.2.3.5.</span> <span class="toc-text">PlayableOutput</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PlayableBinding"><span class="toc-number">1.2.3.6.</span> <span class="toc-text">PlayableBinding</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ExposedReference"><span class="toc-number">1.2.3.7.</span> <span class="toc-text">ExposedReference</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#辅助工具(GraphVisualizer)"><span class="toc-number">1.2.3.8.</span> <span class="toc-text">辅助工具(GraphVisualizer)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#单AnimationClip单AniamtionOuput的动画播放"><span class="toc-number">1.2.3.8.1.</span> <span class="toc-text">单AnimationClip单AniamtionOuput的动画播放</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#多AnimationClip混合"><span class="toc-number">1.2.3.8.2.</span> <span class="toc-text">多AnimationClip混合</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#多AnimationClip多AnimationOuput"><span class="toc-number">1.2.3.8.3.</span> <span class="toc-text">多AnimationClip多AnimationOuput</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#多AnimationClip混合并控制权重加播放状态"><span class="toc-number">1.2.3.8.4.</span> <span class="toc-text">多AnimationClip混合并控制权重加播放状态</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Timeline实战"><span class="toc-number">1.2.4.</span> <span class="toc-text">Timeline实战</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#进阶"><span class="toc-number">1.2.5.</span> <span class="toc-text">进阶</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cinemachine"><span class="toc-number">1.3.</span> <span class="toc-text">Cinemachine</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cinemachine_Brain"><span class="toc-number">1.3.1.</span> <span class="toc-text">Cinemachine Brain</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Virtual_Cameras"><span class="toc-number">1.3.2.</span> <span class="toc-text">Virtual Cameras</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Virtual_Camera_States"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">Virtual Camera States</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Virtual_Camera_Params"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">Virtual Camera Params</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cinemachine_Camera_Types"><span class="toc-number">1.3.3.</span> <span class="toc-text">Cinemachine Camera Types</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Virtual_Camera"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">Virtual Camera</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#FreeLook_Camera"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">FreeLook Camera</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#State-Driven_Camera"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">State-Driven Camera</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Collision_Avoidance_and_Shot_Evaluation"><span class="toc-number">1.3.4.</span> <span class="toc-text">Collision Avoidance and Shot Evaluation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CinemachineCollider"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">CinemachineCollider</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CinemachineConfiner"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">CinemachineConfiner</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实战"><span class="toc-number">1.3.5.</span> <span class="toc-text">实战</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TextMeshPro"><span class="toc-number">1.4.</span> <span class="toc-text">TextMeshPro</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#What-1"><span class="toc-number">1.4.1.</span> <span class="toc-text">What</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Why-1"><span class="toc-number">1.4.2.</span> <span class="toc-text">Why</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-1"><span class="toc-number">1.4.3.</span> <span class="toc-text">How</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#引用"><span class="toc-number">2.</span> <span class="toc-text">引用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Sprite_Atlas-1"><span class="toc-number">2.1.</span> <span class="toc-text">Sprite Atlas</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Timeline-1"><span class="toc-number">2.2.</span> <span class="toc-text">Timeline</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TextMesh_Pro"><span class="toc-number">2.3.</span> <span class="toc-text">TextMesh Pro</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cinemachine-1"><span class="toc-number">2.4.</span> <span class="toc-text">Cinemachine</span></a></li></ol></li></ol>
		
		</div>
		
		<h1 id="前言">前言</h1><p>本篇文章是为了记录学习Unity官方一些好的第三方插件，作为基础的学习了解，为未来遇到问题思考解决方案时拓宽思路。</p>
<h2 id="Sprite_Atlas">Sprite Atlas</h2><p>依然从What，Why，How三个角度了学习了解Sprite Atlas。</p>
<h3 id="What">What</h3><p>Sprite Atlas是官方Sprite Packer的升级版本，是为了更好的解决图集打包加载问题而开发的，而图集是为了解决Draw Call问题。</p>
<h3 id="Why">Why</h3><p>老版Unity的时候，图集打包功能(SpritePacker,打Tag的方式)并不完善，更多的是采用第三方好比TexturePacker打包图集在放到Unity项目里的工作流。</p>
<p>Sprite Atlas主要提供了以下三个功能:<br>1.创建、编辑图集以及设定图集参数<br>2.添加图集Variant（变种）<br>3.运行时访问图集</p>
<p>新版Sprite Atals已经很完善了，考虑到以下几个原因，决定学习官方的打包图集工具跟着官方走:</p>
<ol>
<li>TexturePacker是付费的,Sprite Atlas免费</li>
<li>Sprite Atlas是官方的，跟官方走一般来说不会错</li>
<li>Spritre Atlas已经成熟可以商用的级别</li>
</ol>
<h3 id="How">How</h3><p>使用Sprite Atlas之前，我们需要打开Sprite Atlas功能开关：<br>Edit -&gt; Project Setting -&gt; Editor -&gt; Sprite Packer -&gt; Mode(Always Enable)<br><img src="/img/Unity/SpriteAtlas/EnableSpriteAtlas.png" alt="EnableSpriteAtlas"></p>
<h4 id="创建、编辑图集以及设定图集参数">创建、编辑图集以及设定图集参数</h4><p>在Sprite Atlas里Sprite Atlas是作为一种资源(Asset)存在。<br>创建Sprite Atlas：<br>右键 -&gt; Sprite Atlas</p>
<p>选中创建的Sprite Atlas我们能看到相关设置:<br><img src="/img/Unity/SpriteAtlas/SpriteAtlasSetting.png" alt="SpriteAtlasSetting"><br>这里的设置基本都和图集打包相关，这里就不一一详解了。<br>详情参见官网:<br><a href="https://docs.unity3d.com/Manual/class-SpriteAtlas.html" target="_blank" rel="external">Sprite Atlas</a></p>
<p>点击Sprite Atlas -&gt; Pack Preview即可查看打包后的结果:<br><img src="/img/Unity/SpriteAtlas/PackPreview.png" alt="PackPreview"></p>
<p>这里关于Include in Build这个参数要详细说明一下，这个参数会决定一下几方面:</p>
<ol>
<li>影响使用SpriteAtlas图集资源的资源是如何关联SpriteAtlas的(会决定使用该SpriteAtlas资源加载时加载哪一个图集资源—这里指的是有图集Variant的情况)</li>
<li>影响SpriteAtlas是否需要采用Later Bind(触不触发SpriteAtlasManager.atlasRequested接口,通过这个接口结合图集Variant我们可以做到例如不同平台加载不同图集的适配)。反之勾选Include in Build在依赖使用时会自动加载依赖的Sprite Atlas。<br><strong>这里貌似有些Unity版本有个Bug，勾选Include in Build会导致资源打包冗余</strong><br><img src="/img/Unity/SpriteAtlas/IncludeInBuildCauseRedundancySpriteAtlasTexture.png" alt="IncludeInBuildCauseRedundancySpriteAtlasTexture"></li>
</ol>
<p>针对第一条详情参考:<br><a href="https://docs.unity3d.com/Manual/SpriteAtlasScenarios.html" target="_blank" rel="external">Resolving different Sprite Atlas scenarios</a></p>
<p>Note:</p>
<ol>
<li><strong>Sprite Atlas支持Objects for Packing设置文件夹</strong></li>
<li><strong>参与打包的图片必须设置成Sprite(2D and UI)格式</strong></li>
<li><strong>Include in Build会影响SpriteAtlas的选择(比如是否要使用Later Bind等)</strong></li>
</ol>
<h4 id="添加图集Variant（变种）">添加图集Variant（变种）</h4><p>什么是图集Variant?<br><a href="https://docs.unity3d.com/Manual/VariantSpriteAtlas.html" target="_blank" rel="external">A Variant Sprite Atlas is a type of Sprite Atlas that does not contain its own list of selected Textures as it has no Objects for Packing list in its properties. Instead, it receives a copy of the content from the Sprite Atlas set as its Master Atlas.</a><br>图集Variant是指不能指定打包内容的图集，图集Variant内容来源于复制指定的Master图集。</p>
<p>图集Variant的适用场景?<br>图集Variant的主要目的是为了用于不同分辨率设备适配不同图集来实现，内存和效果的可控。</p>
<p>图集Variant设置适用：<br><img src="/img/Unity/SpriteAtlas/SpriteAtlasVariants.png" alt="SpriteAtlasVariants"><br>可以看到我们创建一个SpriteAtlas把Type设置成Variant后，然后指定Master Atlas，最后通过调节Scale为0.5我们得到了比playerpreview图集小一倍大小的图集效果。</p>
<p>结论:</p>
<p>图集变体是类似Mipmap的东西，通过多打包多个不同大小的图集到游戏里，Unity自动帮我们选择合适的图集来加载，从而做到高分辨率机型加载高分辨率的，低分辨率机型加载低分辨率的，<strong>典型的空间换时间做法</strong>。</p>
<p>Note:</p>
<ol>
<li><strong>要想只打包使用图集Variant，需要把图集Variant的Include in Build打开，把图集Master的Include in Build关闭</strong></li>
</ol>
<h4 id="运行时访问图集">运行时访问图集</h4><p><a href="https://gameinstitute.qq.com/community/detail/127434" target="_blank" rel="external">Sprite Atlas作为一种资源开放给用户，支持在脚本中直接访问，还可以通过名字获取图集中的精灵。</a></p>
<p><strong>这里我们采用设置不勾选Include in Build的设置打包SpriteAtlas</strong></p>
<p>接下来我们通过SpriteAtlas接口访问打包AB后的Sprite Atlas里的图片资源试试：<br>首先让我们看看SpriteAtlas打包AB后的的资源数据：<br><img src="/img/Unity/SpriteAtlas/SpriteAtlasAssetBundlePreview.png" alt="SpriteAtlasAssetBundlePreview"><br>可以看到SpriteAtlas作为资源参与AB打包，里面包含了SpriteAtlas，图集Texture2D以及Sprite数据。</p>
<p>这里我们看看UI预制件引用SpriteAtlas看看依赖打包的情况：<br><img src="/img/Unity/SpriteAtlas/UIPrefabReferenceNotIncludeBuildSpriteAtlas.png" alt="UIPrefabReferenceNotIncludeBuildSpriteAtlas"><br>从上面可以看出UI窗口预制件包含了依赖的Sprite(这里和以前不一样，以前是不会包含依赖的Sprite的，会直接通过依赖关系加载依赖AB实现自动还原)，个人猜测这个和后续讲到的SpriteAtlas的Later Bind有关。</p>
<p>加载UI窗口预制件后发现Sprite Missing了:<br><img src="/img/Unity/SpriteAtlas/UIPrefabSpriteMissing.png" alt="UIPrefabSpriteMissing"><br>通过查看依赖文件我发现依赖信息是没有对SpriteAtlas的依赖信息的。<strong>不知道这算不算是一个Bug还是设计如此，因为没有依赖信息对资源加载管理会造成问题，忘知道的朋友告知。</strong><br><img src="/img/Unity/SpriteAtlas/UIPrefabDepencency.png" alt="UIPrefabDepencency"></p>
<p>问题:</p>
<ol>
<li><strong>加载使用SpriteAtlas的UI Prefab，SpriteAtlas会自动加载进内存且没有依赖信息。但如果此时主动加载了Sprite Atlas并主动强制卸载该Sprite Atlas的AB会导致UI Prefab使用的Sprite Atlas也跟随被清除。从这里看出UI Prefab对Sprite Atlas的依赖信息是有必要的，不然没法正确的管理资源加载。</strong></li>
</ol>
<p>这里引申出了SpriteAtlas一个很重要的功能，<strong>Later Bind</strong></p>
<p>Note:</p>
<ol>
<li><strong>图集的被动(依赖)加载管理会有使用该图集的资源所决定(比如UI Prefab使用了SpriteAtlas，两个分别打包AB，这时加载UI Prefab后SpriteAtlas会自动加载进内存，而UI Prefab卸载以后，SpriteAtlas没有其他主动加载该SpriteAtlas的会自动卸载。)</strong></li>
</ol>
<h5 id="Later_Bind">Later Bind</h5><p><a href="https://zhuanlan.zhihu.com/p/80584461" target="_blank" rel="external">SpritePacker时代“图集”我们是看不到的，因为设计者的初衷是想让开发者完全不用考虑图集的事。但是，这跟游戏开发时的动态加载图集时矛盾的！我们要动态加载就必须要知道atlas名字和sprite名，这样才能在 运行时动态的找到一张sprite！所以U3D程序员必须要清楚的知道你当前界面用的是哪atlas的哪个sprite。但是按照SpritePacker的做法他的初衷应该是想把图集干掉（干掉的意思让开发者不用关心），只需要考虑sprite即可，但是这是行不通的！<br><strong>SpriteAtlas其实就是为了解决上面说的问题而发布的功能。通过它我们可以将atlas和UIprefab“解耦”。同时，在Unity编辑器状态下我们仍然可以利用未打成SpriteAtlas的Sprite进行开发。等开发完成我们再发布成SpriteAtlas。</strong>Unity提供了所谓“延迟绑定”（late bind）的技术来让我们实现这个功能。</a></p>
<p>AtlasManager.cs<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">public class AtlasManager : SingletonTemplate&lt;AtlasManager&gt;</span><br><span class="line">&#123;</span><br><span class="line">    public AtlasManager()</span><br><span class="line">    &#123;</span><br><span class="line">        DIYLog.Log("添加SpriteAtals图集延时绑定回调!");</span><br><span class="line">        SpriteAtlasManager.atlasRequested += onAtlasRequested;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 响应SpriteAtlas图集加载回调</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    /// &lt;param name="atlasname"&gt;&lt;/param&gt;</span><br><span class="line">    /// &lt;param name="callback"&gt;&lt;/param&gt;</span><br><span class="line">    private void onAtlasRequested(string atlasname, Action&lt;SpriteAtlas&gt; callback)</span><br><span class="line">    &#123;</span><br><span class="line">        DIYLog.Log($"加载SpriteAtlas:&#123;atlasname&#125;");</span><br><span class="line">        // Later Bind -- 依赖使用SpriteAtlas的加载都会触发这里</span><br><span class="line">        ResourceModuleManager.Singleton.requstResource(</span><br><span class="line">        atlasname,</span><br><span class="line">        (abi) =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            DIYLog.Log($"Later Bind加载SpriteAtlas:&#123;atlasname&#125;");</span><br><span class="line">            var sa = abi.loadAsset&lt;SpriteAtlas&gt;(atlasname);</span><br><span class="line">            callback(sa);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ******</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在加载使用SpriteAtlas(<strong>仅当设置成不勾选Include in Build</strong>)的相关资源时(比如UI Prefab)上诉回调会被触发完成对SpriteAtlas的加载，确保引用的Sprite能正确显示。同时这一机制就允许我们做到不同平台的不同图集资源加载适配这样的功能。</p>
<p>疑问:</p>
<ol>
<li>Later Bind只是加载SpriteAtlas提供的一个回调接口(无论是主动还是被动(依赖)加载)，回调接口内只知道加载了指定的SpriteAtlas却不知道具体的详细用法，这样一来基于对象绑定和索引计数的资源管理系统就无法正确的加载管理了(因为被动(依赖)加载得不到SpriteAtlas的依赖信息)。</li>
</ol>
<p>个人方案：</p>
<ol>
<li>当前这套基于对象绑定和索引计数的方案暂时没想到好的方案，可能需要对SpriteAtals的资源管理单独做一套管理策略来支持Later Bind的用法。有更好方案的朋友，望告知。</li>
</ol>
<h5 id="注意事项">注意事项</h5><ol>
<li>开启Sprite Packer的设置Sprite Packer -&gt; Mode(Always Enable)只决定图集合成时机(比如是运行时还是打包时还是编辑器时)。</li>
<li>Sprite Atlas支持Objects for Packing设置文件夹</li>
<li>参与打包的图片必须设置成Sprite(2D and UI)格式</li>
<li><strong>Include in Build会影响SpriteAtlas图集资源的资源是如何关联SpriteAtlas(比如影响是否需要使用Later Bind,不勾选需要使用Later Bind否则会报警告)</strong></li>
</ol>
<h5 id="相关概念">相关概念</h5><ol>
<li>Sprite Atlas把图集打包的概念延迟到特定时刻(比如打包或者打包AB)而编辑模式依然可以使用原始Sprite工作，总的来说就是延时自动化打包图集时机+允许使用原始Sprite的概念。</li>
<li>Include in Build设置主要是看有没有动态适配加载图集需求，有的话就建议不勾选，然后结合Later Bind来做动态图集加载适配。反之勾选Include in Build在依赖使用时会自动加载依赖使用的Sprite Atals。</li>
<li>Include in Build其次还会影响Sprite Atlas变体使用的选择。</li>
<li>SpriteAtlas到了Unity 2018 LTS版本感觉才稳定些，建议使用稳定版本的SpriteAtlas</li>
<li>Later Bind不会区分主动加载还是被动(依赖)加载SpriteAtlas,都会统一回调，要使用Later Bind机制的需要取消勾选Include in Build并解决SpriteAtlas的资源加载管理问题(在沿用原来的对象绑定和索引计数的资源管理方案基础上本人暂时没有好的方案)</li>
<li><strong>Sprite Atlas无论够不够选Include in Build打包AB都得不到Sprite Atlas的依赖信息，感觉这是一个bug</strong></li>
</ol>
<h5 id="Bug记录">Bug记录</h5><ol>
<li><strong>勾选Include in Build会导致资源打包冗余(部分Unity版本比如Unity2018.4.1f1)，建议升级到LTS版本</strong></li>
</ol>
<h5 id="结论">结论</h5><p>SpriteAtlas虽然解决了Atlas和UIPrefab的解耦，同时提供了图集变体的概念来解决适配图集适配方案，但也带来了一些新的问题要解决(e.g. 要解决没有依赖信息的SpriteAtals基础上做到正确的资源加载管理)。</p>
<p><strong>————————————————2021/20/12更新开始———————————————————</strong></p>
<p>正确使用姿势参考：</p>
<p><a href="https://www.cnblogs.com/msxh/p/14194756.html" target="_blank" rel="external">【Unity游戏开发】SpriteAtlas与AssetBundle最佳食用方案</a></p>
<p>简单来说:</p>
<ol>
<li><strong>SpriteAtlas 勾选Include in build</strong></li>
<li><strong>SpriteAtlas不设置AB打包</strong></li>
<li><strong>直接当做单Sprite一样加载</strong></li>
</ol>
<p><strong>————————————————2021/20/12更新结束———————————————————</strong></p>
<h2 id="Timeline">Timeline</h2><p><a href="https://docs.unity3d.com/Manual/TimelineSection.html" target="_blank" rel="external"> <strong>Timeline</strong> to create cinematic content, game-play sequences, audio sequences, and complex particle effects. </a></p>
<p>官方介绍Timeline可以用于制作类似电影过场表现的工具。</p>
<p>Timeline分为两个部分：</p>
<ol>
<li>Timeline Asset(数据)</li>
<li>Timeline instance(数据关联实体对象)</li>
</ol>
<h3 id="Timeline_Asset">Timeline Asset</h3><h4 id="介绍">介绍</h4><p><a href="https://docs.unity3d.com/Manual/TimelineOverview.html" target="_blank" rel="external"> <strong>Timeline Asset</strong>: Stores the tracks, clips, and recorded animations without links to the specific GameObjects being animated.</a></p>
<p>通过介绍可以看出Timeline Asset是类似于Animation Clip一样的资源文件可以用于录制动画<strong>但不需要关联到特定的物体上</strong></p>
<p>Timeline Asset记录的动画数据是以子节点资源的形式挂载在Timeline Asset下的：</p>
<p><img src="/img/Unity/Timeline_Cinemachine/TimelineAssetHierachy.png" alt="TimelineAssetHierachy"></p>
<p>Note:<br>前面说的不需要关联到特定的物体上是指不需要像AnimationClip那样动画是针对指定物体制作的(挂给其他物体用不了该动画)，Timeline可以通过PlayableDirector动态关联动画对象。</p>
<h4 id="分类">分类</h4><p>Timeline Asset是以Track为最小单位。</p>
<p>主要支持以下几种Track:</p>
<ol>
<li>Track Group(仅分层管理用)</li>
<li>Activation Track(激活物体Track)</li>
<li>Animation Track(动画Track)</li>
<li>Audio Track(音频Track)</li>
<li>Control Track(时间相关的控制)</li>
<li>Playable Track(<strong>自定义Track</strong>)</li>
</ol>
<p><img src="/img/Unity/Timeline_Cinemachine/TimelineComponent.png" alt="TimelineComponent"></p>
<p>这里我们着重学习Playable Track,自定义的一些表现行为都是通过Playable Track来做的。其他几个就不一一讲解了。</p>
<h5 id="Playable_Track">Playable Track</h5><p>自定义Playable Track需要知道两个东西：</p>
<ol>
<li>PlayableAsset(用于支持Timeline创建和显示自定义PlayableAsset数据定义)</li>
<li>PlayableBehaviour(用于Playable实际的生命周期等逻辑实现)</li>
</ol>
<p>示例:<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 枚举事件定义</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> EEventId</span><br><span class="line">&#123;</span><br><span class="line">    DefaultEvent = <span class="number">1</span>,				<span class="comment">// 默认事件</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> 事件分发器Asset</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line">[System.Serializable]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EventDispatcherAsset</span> : <span class="title">PlayableAsset</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> 事件</span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> EEventId EventId = EEventId.DefaultEvent;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Factory method that generates a playable based on this asset</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> Playable <span class="title">CreatePlayable</span>(<span class="params">PlayableGraph graph, GameObject go</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> playable = ScriptPlayable&lt;EventDispatcherPlayable&gt;.Create(graph);</span><br><span class="line">        playable.GetBehaviour().EventId = EventId;</span><br><span class="line">        <span class="keyword">return</span> playable;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> 事件分发器Playable</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EventDispatcherPlayable</span> : <span class="title">PlayableBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> 事件</span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line">    [Header(<span class="string">"事件"</span>)]</span><br><span class="line">    <span class="keyword">public</span> EEventId EventId = EEventId.DefaultEvent;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Called when the owning graph starts playing</span></span><br><span class="line">    <span class="comment">// Playable开始执行时</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnGraphStart</span>(<span class="params">Playable playable</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Called when the owning graph stops playing</span></span><br><span class="line">    <span class="comment">// Playable停止执行时</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnGraphStop</span>(<span class="params">Playable playable</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Called when the state of the playable is set to Play</span></span><br><span class="line">    <span class="comment">// 触发Playable执行时</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnBehaviourPlay</span>(<span class="params">Playable playable, FrameData info</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        Debug.Log(<span class="keyword">string</span>.Format(<span class="string">"OnBehaviourPlay() 分发事件 : &#123;0&#125;"</span>, EventId));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Called when the state of the playable is set to Paused</span></span><br><span class="line">    <span class="comment">// Playable暂停执行时</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnBehaviourPause</span>(<span class="params">Playable playable, FrameData info</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Called each frame while the state is set to Play</span></span><br><span class="line">    <span class="comment">// Playable更新执行时</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">PrepareFrame</span>(<span class="params">Playable playable, FrameData info</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/img/Unity/Timeline_Cinemachine/TimelineCustomPlayable.png" alt="TimelineCustomPlayable"></p>
<p>代码不复杂就不详细介绍了。通过上面的代码，我们支持了一个创建自定义分发事件的Playable Track，而这个自定义的事件分发就可以用作我们Timeline和游戏逻辑之间的一个桥梁，帮助我们在Timeline播放的过程中自定义响应做一些表现。</p>
<h3 id="Timeline_instance">Timeline instance</h3><h4 id="介绍-1">介绍</h4><p><a href="https://docs.unity3d.com/Manual/TimelineOverview.html" target="_blank" rel="external"> <strong>Timeline instance</strong>: Stores links to the specific GameObjects being animated or affected by the Timeline Asset. These links, referred to as <strong>bindings</strong>, are saved to the Scene. </a></p>
<p>要想关联场景物体和Timeline Asset让我们制作的电影过场动起来，我们需要创建Timeline instance(这里指的Playable Director组件)。</p>
<p><img src="/img/Unity/Timeline_Cinemachine/TimelinePlayableDirectorInspector.png" alt="TimelinePlayableDirectorInspector"></p>
<p>可以看到我们通过Timeline Asset录制的动画是通过Playable Director的Bindings动态关联到了场景物体上。</p>
<p>Note:<br><strong>因为Timeline Asset是纯数据，Timeline instance决定了数据关联的对象，所以我们可以重用Timeline Asset对不同的物体做动画表现。</strong></p>
<h3 id="Timeline类设计">Timeline类设计</h3><h4 id="Playable">Playable</h4><p><a href="https://docs.unity3d.com/Manual/Playables.html" target="_blank" rel="external">The <strong>Playables</strong> API provides a way to create tools, effects or other gameplay mechanisms by organizing and evaluating data sources in a tree-like structure known as the PlayableGraph. The PlayableGraph allows you to mix, blend, and modify multiple data sources, and play them through a single output.</a></p>
<p>从介绍个人的理解，Playable是一套可自定义数据处理流程成树状结构的工具。而自定义出来的树状结构数据就叫做PlayableGraph(后续会讲到)。而Timeline的核心正是Playable。</p>
<p><a href="https://docs.unity3d.com/Manual/Playables.html" target="_blank" rel="external">使用Playables API的好处:</a></p>
<ul>
<li>The Playables API allows for dynamic animation blending. This means that objects in the <strong>scenes</strong><br>could provide their own animations. For example, animations for weapons, chests, and traps could be dynamically added to the PlayableGraph and used for a certain duration.</li>
<li>The Playables API allows you to easily play a single animation without the overhead involved in creating and managing an AnimatorController asset.</li>
<li>The Playables API allows users to dynamically create blending graphs and control the blending weights directly frame by frame.</li>
<li>A PlayableGraph can be created at runtime, adding playable node as needed, based on conditions. Instead of having a huge “one-size-fit-all” graph where nodes are enabled and disabled, the PlayableGraph can be tailored to fit the requirements of the current situation.</li>
</ul>
<p>官网上介绍了Playable的不少好处，从介绍可以看出最大的好处就是运行时自定义组装数据处理流程，避免离线构建一套过于臃肿的数据定义(比如AnimatorController)</p>
<p>Note:</p>
<ol>
<li><strong>Playable是Struct而非Class，为了避免内存分配导致GC</strong></li>
<li><strong>Playable和PlayableOutput没有提供太多方法，而是通过PlayableExtension和PlayableOutputExtension用扩展方法的方式来提供的方法</strong></li>
</ol>
<h4 id="PlayableGraph">PlayableGraph</h4><p><a href="https://docs.unity3d.com/Manual/Playables-Graph.html" target="_blank" rel="external">The PlayableGraph defines a set of playable outputs that are bound to a <strong>GameObject</strong> or component. The PlayableGraph also defines a set of <strong>playables</strong> and their relationships. Figure 1 provides an example.</a></p>
<p><a href="https://docs.unity3d.com/Manual/Playables-Graph.html" target="_blank" rel="external">The PlayableGraph is responsible for the life cycle of its playables and their outputs. Use the PlayableGraph to create, connect, and destroy playables.</a></p>
<p>从上面的介绍，个人理解，PlayableGraph是一个自定义数据处理流程的完整单位，负责自定义数据处理流程里的节点定义，关联，以及生命周期。PlayableGraph是由Plyable(e.g.Playable,MixPlayable)+PlayableOuput组成。</p>
<h4 id="PlayableAsset">PlayableAsset</h4><p><a href="https://docs.unity3d.com/ScriptReference/Playables.PlayableAsset.html" target="_blank" rel="external">A base class for assets that can be used to instantiate a Playable at runtime.</a></p>
<p>PlayableAsset是自定义Playable时定义数据Asset的基类。</p>
<h4 id="PlayableBehaviour">PlayableBehaviour</h4><p><a href="https://docs.unity3d.com/ScriptReference/Playables.PlayableBehaviour.html" target="_blank" rel="external">PlayableBehaviour is the base class from which every custom playable script derives.</a></p>
<p>PlayableBehaviour是自定义Playable时定义行为实现的脚本基类。</p>
<h4 id="PlayableOutput">PlayableOutput</h4><p>个人理解是定义Playable里面的输出节点。所有的输入节点最后连接成树状结构后连到输出节点上，执行出自定义行为的输出表现。</p>
<p>参考下图:</p>
<p><img src="/img/Unity/Timeline_Cinemachine/PlayableOutputPreview.PNG" alt="PlayableOutputPreview"></p>
<h4 id="PlayableBinding">PlayableBinding</h4><p><a href="https://docs.unity3d.com/ScriptReference/Playables.PlayableBinding.html" target="_blank" rel="external">Struct that holds information regarding an output of a PlayableAsset. PlayableAssets specify the type of outputs it supports using PlayableBindings.</a></p>
<p>看介绍PlayableBinding是用于定义并持有PlayableAsset的数据输出信息。</p>
<h4 id="ExposedReference">ExposedReference</h4><p><a href="https://docs.unity3d.com/ScriptReference/ExposedReference_1.html" target="_blank" rel="external">Creates a type whos value is resolvable at runtime. ExposedReference is a generic type that can be used to create references to Scene objects and resolve their actual values at runtime and by using a context object. This can be used by assets, such as a ScriptableObject or PlayableAsset to create references to Scene objects.</a></p>
<p>从介绍可以看出，ExposedReference是用于创建一个类型(其值在运行时处理绑定的)。用于解决PlayableAsset引用场景对象组件数据等问题。</p>
<h4 id="辅助工具(GraphVisualizer)">辅助工具(GraphVisualizer)</h4><p><a href="https://github.com/Unity-Technologies/graph-visualizer" target="_blank" rel="external">The PlayableGraph Visualizer is a tool that displays the PlayableGraphs in the scene. It can be used in both Play and Edit mode and will always reflect the current state of the graph. </a></p>
<p>因为Playable的设计很庞大，里面有很多类和概念，为了方便理解Playable设计和使用可视化的查看构建出来的PlayableGraph显得额外有用，而PlayableGraph Visualizer正是这么一款工具。</p>
<p>接下来我们结合GraphVisualizer动态通过代码创建模拟用Playable API实现动画Animator Controller里的动画状态机类似的效果，从而深入学习理解Playable里各个类的设计和使用。</p>
<h5 id="单AnimationClip单AniamtionOuput的动画播放">单AnimationClip单AniamtionOuput的动画播放</h5><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建动画播放PlayableGraph</span></span><br><span class="line">mCustomGraph = PlayableGraph.Create(<span class="string">"DIYAnimationPlayableGraph"</span>);</span><br><span class="line"><span class="comment">// 创建动画播放PlyableGraph的PlayableOutput</span></span><br><span class="line"><span class="keyword">var</span> animoutput = AnimationPlayableOutput.Create(mCustomGraph, <span class="string">"AnimationOutput"</span>, CustomAnimator1);</span><br><span class="line"><span class="comment">// 创建动画播放PlyableGraph的动画Playable</span></span><br><span class="line"><span class="keyword">var</span> animationclipplayable = AnimationClipPlayable.Create(mCustomGraph, CustomAnimationClip1);</span><br><span class="line"><span class="comment">// 设置动画播放PlayableOutput的关联Playable</span></span><br><span class="line">animoutput.SetSourcePlayable(animationclipplayable);</span><br><span class="line"><span class="comment">// 播放创建的PlayableGraph</span></span><br><span class="line">mCustomGraph.Play();</span><br></pre></td></tr></table></figure>
<p>通过上面的代码我们动态创建了1个PlayableGraph，1个动画Plyable，1个动画PlayableOutput作为动画播放输出，并设置他们之间的关联，运行代码打开PlayableGraphVisualizer就可以查看到生成的单动画Clip播放PlayableGraph图了。</p>
<p><img src="/img/Unity/Timeline_Cinemachine/PlayableGraphVisualizerPreview.PNG" alt="PlayableGraphVisualizerPreview"></p>
<h5 id="多AnimationClip混合">多AnimationClip混合</h5><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建动画播放PlayableGraph</span></span><br><span class="line">mCustomGraph = PlayableGraph.Create(<span class="string">"DIYAnimationPlayableGraph"</span>);</span><br><span class="line"><span class="comment">// 创建动画播放PlyableGraph的PlayableOutput</span></span><br><span class="line"><span class="keyword">var</span> animationOutput = AnimationPlayableOutput.Create(mCustomGraph, <span class="string">"AnimationOutput"</span>, CustomAnimator1);</span><br><span class="line"><span class="comment">// 创建动画播放混合Playable(设置两个输入Playable)</span></span><br><span class="line">mAnimationMixerPlayable = AnimationMixerPlayable.Create(mCustomGraph, <span class="number">2</span>);</span><br><span class="line"><span class="comment">// 关联动画混合Playable到PlaybleOutput作为唯一输入</span></span><br><span class="line">animationOutput.SetSourcePlayable(mAnimationMixerPlayable);</span><br><span class="line"><span class="comment">// 创建动画播放PlyableGraph的动画播放Playable1和Playable2</span></span><br><span class="line"><span class="keyword">var</span> animationClipPlayable1 = AnimationClipPlayable.Create(mCustomGraph, CustomAnimationClip1);</span><br><span class="line"><span class="keyword">var</span> animationClipPlayable2 = AnimationClipPlayable.Create(mCustomGraph, CustomAnimationClip2);</span><br><span class="line"><span class="comment">// 关联动画播放Playable1和Playable2作为动画混合Playable的输入连接(分别连接输入0和输入1接口)</span></span><br><span class="line">mCustomGraph.Connect(animationClipPlayable1, <span class="number">0</span>, mAnimationMixerPlayable, <span class="number">0</span>);</span><br><span class="line">mCustomGraph.Connect(animationClipPlayable2, <span class="number">0</span>, mAnimationMixerPlayable, <span class="number">1</span>);</span><br><span class="line"><span class="comment">// 播放创建的PlayableGraph</span></span><br><span class="line">mCustomGraph.Play();</span><br></pre></td></tr></table></figure>
<p>通过上面的代码我们动态创建了一个PlayableGraph，2个动画Plyable作为基础输入，1个动画混合Playable作为混合节点，1个动画PlayableOutput作为动画播放输出，并设置他们之间的关联，运行代码打开PlayableGraphVisualizer就可以查看到生成的动画混合播放PlayableGraph图了。</p>
<p><img src="/img/Unity/Timeline_Cinemachine/AnimationClipMixPreview.PNG" alt="AnimationClipMixPreview"></p>
<h5 id="多AnimationClip多AnimationOuput">多AnimationClip多AnimationOuput</h5><p><strong>一个PlayableGraph是可以拥有多个PlayableOutput输出的</strong></p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建动画播放PlayableGraph</span></span><br><span class="line">mCustomGraph = PlayableGraph.Create(<span class="string">"DIYAnimationPlayableGraph"</span>);</span><br><span class="line"><span class="comment">// 创建动画播放PlyableGraph的PlayableOutput1和PlayableOutput2</span></span><br><span class="line"><span class="keyword">var</span> animationOutput1 = AnimationPlayableOutput.Create(mCustomGraph, <span class="string">"AnimationOutput1"</span>, CustomAnimator1);</span><br><span class="line"><span class="keyword">var</span> animationOutput2 = AnimationPlayableOutput.Create(mCustomGraph, <span class="string">"AnimationOutput2"</span>, CustomAnimator2);</span><br><span class="line"><span class="comment">// 创建动画播放PlyableGraph的动画播放Playable1和Playable2</span></span><br><span class="line"><span class="keyword">var</span> animationClipPlayable1 = AnimationClipPlayable.Create(mCustomGraph, CustomAnimationClip1);</span><br><span class="line"><span class="keyword">var</span> animationClipPlayable2 = AnimationClipPlayable.Create(mCustomGraph, CustomAnimationClip2);</span><br><span class="line"><span class="comment">// 关联动画播放Playable1到动画播放PlaybleOutput1</span></span><br><span class="line"><span class="comment">// 关联动画播放Playable2到动画播放PlaybleOutput2</span></span><br><span class="line">animationOutput1.SetSourcePlayable(animationClipPlayable1);</span><br><span class="line">animationOutput2.SetSourcePlayable(animationClipPlayable2);</span><br><span class="line"><span class="comment">// 播放创建的PlayableGraph</span></span><br><span class="line">mCustomGraph.Play();</span><br></pre></td></tr></table></figure>
<p>通过上面的代码我们动态创建了一个PlayableGraph，2个动画Plyable对应2个动画PlayableOutput动画播放输出的输入，并设置他们之间的关联，运行代码打开PlayableGraphVisualizer就可以查看到生成的动画混合播放PlayableGraph图了。</p>
<p><img src="/img/Unity/Timeline_Cinemachine/MultipleAnimationInputAndOutputPreview.PNG" alt="MultipleAnimationInputAndOutputPreview"></p>
<h5 id="多AnimationClip混合并控制权重加播放状态">多AnimationClip混合并控制权重加播放状态</h5><p><strong>不同的Playable是可以设置混合权重加播放状态的</strong></p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建动画播放PlayableGraph</span></span><br><span class="line">mCustomGraph = PlayableGraph.Create(<span class="string">"DIYAnimationPlayableGraph"</span>);</span><br><span class="line"><span class="comment">// 创建动画播放PlyableGraph的PlayableOutput</span></span><br><span class="line"><span class="keyword">var</span> animationOutput = AnimationPlayableOutput.Create(mCustomGraph, <span class="string">"AnimationOutput1"</span>, CustomAnimator1);</span><br><span class="line"><span class="comment">// 创建动画混合Playable</span></span><br><span class="line">mAnimationMixerPlayable = AnimationMixerPlayable.Create(mCustomGraph, <span class="number">2</span>);</span><br><span class="line"><span class="comment">// 设置动画混合Playalbe作为动画播放输出Playable</span></span><br><span class="line">animationOutput.SetSourcePlayable(mAnimationMixerPlayable);</span><br><span class="line"><span class="comment">// 创建动画播放PlyableGraph的动画播放Playable1和Playable2</span></span><br><span class="line"><span class="keyword">var</span> animationClipPlayable1 = AnimationClipPlayable.Create(mCustomGraph, CustomAnimationClip1);</span><br><span class="line"><span class="keyword">var</span> animationClipPlayable2 = AnimationClipPlayable.Create(mCustomGraph, CustomAnimationClip2);</span><br><span class="line"><span class="comment">// 设置动画混合输入和权重</span></span><br><span class="line">mCustomGraph.Connect(animationClipPlayable1, <span class="number">0</span>, mAnimationMixerPlayable, <span class="number">0</span>);</span><br><span class="line">mCustomGraph.Connect(animationClipPlayable2, <span class="number">0</span>, mAnimationMixerPlayable, <span class="number">1</span>);</span><br><span class="line">mAnimationMixerPlayable.SetInputWeight(<span class="number">0</span>, <span class="number">1.0</span>f);</span><br><span class="line">mAnimationMixerPlayable.SetInputWeight(<span class="number">1</span>, <span class="number">1.0</span>f);</span><br><span class="line"><span class="comment">// 暂停动画播放Playable1</span></span><br><span class="line">animationClipPlayable1.Pause();</span><br><span class="line"><span class="comment">// 播放创建的PlayableGraph</span></span><br><span class="line">mCustomGraph.Play();</span><br></pre></td></tr></table></figure>
<p>通过上面的代码我们动态创建了一个PlayableGraph，2个动画Plyable作为动画混合Playable的输入,1个动画混合Playable作为动画播放输出的输入,1个PlayableOutput作为动画播放输出，并设置他们之间的关联和权重，并把其中一个动画播放Playable设置成暂停状态，运行代码打开PlayableGraphVisualizer就可以查看到生成的动画混合播放PlayableGraph图了。</p>
<p><img src="/img/Unity/Timeline_Cinemachine/MultipleAnimationBlendAndSetPlayableState.PNG" alt="MultipleAnimationBlendAndSetPlayableState"></p>
<p>Note:</p>
<ol>
<li><strong>父Playable的播放状态设置会影响所有子节点Playable播放状态</strong></li>
</ol>
<h3 id="Timeline实战">Timeline实战</h3><p>通过上面有了基础的知识后，接下来我们以实战的方式深入学习Timeline。</p>
<ul>
<li>目标</li>
</ul>
<ol>
<li>人物模型移动(Timeline自带)+人物模型动画播放(Timeline自带)+镜头移动(Cinemachine+Timeline)+2D对话+3D气泡对话的剧情表现+特效播放(Timeline自带)+音乐播放控制(扩展自定义Track，方便走自己的音效播放接口)</li>
<li>支持Timeline Editor拖拽预览+运行时播放预览</li>
</ol>
<ul>
<li>功能开发</li>
</ul>
<ol>
<li>音乐播放控制(扩展自定义Track，方便走自己的音效播放接口)</li>
<li>Timeline模型移动控制Track(TimeLine支持)</li>
<li>学习Cinemachine扩展Timeline的Track使用控制镜头移动表现</li>
<li>实现2D气泡对话+3D对话功能</li>
<li>扩展Timneline实现2D气泡对话Track+3D对话Track</li>
<li>动态创建实体对象的自定义Track绑定控制(如何实现?)</li>
</ol>
<ul>
<li>准备工作</li>
</ul>
<ol>
<li>Package Manager里安装Cinemachine模块</li>
<li>下载导入模型特效音效等相关资源</li>
</ol>
<p>安装好Cinemachine后，打开Timeline里面就会看到多了Cinemachine的Track，从而就可以在Timeline里使用Cinemachine相关的扩展功能了:</p>
<p><img src="/img/Unity/Timeline_Cinemachine/TimelineCinemachineTrack.png" alt="TimelineCinemachineTrack"></p>
<p>首先我们先放一下我们自定义制作的Timeline的预制件结构:</p>
<p><img src="/img/Unity/Timeline_Cinemachine/CustomTimelinePrefabHierachyPreview.PNG" alt="CustomTimelinePrefabHierachyPreview"></p>
<hr>
<p><strong>音乐播放控制Track</strong></p>
<p>CustomAduioTrack.cs(自定义音乐播放Track)</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> CustomAudioTrack.cs</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> 自定义音效Track</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line">[TrackClipType(<span class="keyword">typeof</span>(CustomAudioAsset))]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CustomAudioTrack</span> : <span class="title">PlayableTrack</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>CustomAudioAsset.cs(自定义音乐播放Asset数据结构)</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">/// &lt;summary&gt;</span><br><span class="line">/// CustomAudioAsset.cs</span><br><span class="line">/// 自定义音效播放Asset</span><br><span class="line">/// &lt;/summary&gt;</span><br><span class="line">public class CustomAudioAsset : BaseGameAsset, ITimelineClipAsset</span><br><span class="line">&#123;</span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 音效类型</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    public enum AudioType</span><br><span class="line">    &#123;</span><br><span class="line">        Bgm = 1,            // 背景音乐</span><br><span class="line">        Sound = 2,          // 音效</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 音效播放组件</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    public ExposedReference&lt;AudioSource&gt; SourceAudio;</span><br><span class="line"></span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 播放的音效类型</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    public AudioType PlayedAudioType = AudioType.Bgm;</span><br><span class="line"></span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 音效资源路径</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    public string AudioPath;</span><br><span class="line">    </span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 不支持重叠</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    public ClipCaps clipCaps</span><br><span class="line">    &#123;</span><br><span class="line">        get &#123; return ClipCaps.None; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public override Playable CreatePlayable(PlayableGraph graph, GameObject owner)</span><br><span class="line">    &#123;</span><br><span class="line">        var playable = ScriptPlayable&lt;CustomAudioBehaviour&gt;.Create(graph);</span><br><span class="line">        var audiobehaviour = playable.GetBehaviour();</span><br><span class="line">        audiobehaviour.Name = Name;</span><br><span class="line">        audiobehaviour.SourceAudio = SourceAudio.Resolve(graph.GetResolver());</span><br><span class="line">        audiobehaviour.PlayedAudioType = PlayedAudioType;</span><br><span class="line">        audiobehaviour.AudioPath = AudioPath;</span><br><span class="line">        return playable;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>CustomAudioBehaviour.cs(自定义音乐播放行为)</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> CustomAudioBehaviour.cs</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> 自定义音效播放Behaviour</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CustomAudioBehaviour</span> : <span class="title">BaseGameBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> 音效播放组件</span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> AudioSource SourceAudio;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> 播放的音效类型</span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> CustomAudioAsset.AudioType PlayedAudioType;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> 音效资源路径</span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> AudioPath;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> 是否正在播放音乐</span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">bool</span> mIsPlayingAudio;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnBehaviourPlay</span>(<span class="params">Playable playable, FrameData info</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        Debug.Log($<span class="string">"AudioBehaviour:OnBehaviourPlay() 执行指令:&#123;Name&#125;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Called each frame while the state is set to Play</span></span><br><span class="line">    <span class="comment">// Playable更新执行时</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">ProcessFrame</span>(<span class="params">Playable playable, FrameData info, <span class="keyword">object</span> playerData</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">		TryPlayAudio();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Called when the state of the playable is set to Paused</span></span><br><span class="line">    <span class="comment">// Playable暂停执行时</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnBehaviourPause</span>(<span class="params">Playable playable, FrameData info</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        Debug.Log($<span class="string">"AudioBehaviour:OnBehaviourPause() 执行指令:&#123;Name&#125;"</span>);</span><br><span class="line">        <span class="keyword">if</span>(SourceAudio != <span class="keyword">null</span> &amp;&amp; SourceAudio.clip != <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            SourceAudio.clip = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        mIsPlayingAudio = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> 尝试执行音乐播放</span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">TryPlayAudio</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(mIsPlayingAudio == <span class="keyword">false</span> &amp;&amp; SourceAudio != <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (PlayedAudioType == CustomAudioAsset.AudioType.Bgm)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// <span class="doctag">TODO:</span> 走背景音乐播放接口</span></span><br><span class="line">                SourceAudio.clip = Resources.Load&lt;AudioClip&gt;(AudioPath);</span><br><span class="line">                SourceAudio.Play();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">PlayedAudioType == CustomAudioAsset.AudioType.Sound</span>)</span><br><span class="line">            </span>&#123;</span><br><span class="line">                <span class="comment">// <span class="doctag">TODO:</span> 走音效播放接口</span></span><br><span class="line">                SourceAudio.clip = Resources.Load&lt;AudioClip&gt;(AudioPath);</span><br><span class="line">                SourceAudio.Play();</span><br><span class="line">            &#125;</span><br><span class="line">            mIsPlayingAudio = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接下来看下我们自定义的音效播放Track和音乐Asset的使用面板效果:</p>
<p><img src="/img/Unity/Timeline_Cinemachine/CustomAudioTrackPreview.PNG" alt="CustomAudioTrackPreview"></p>
<p><img src="/img/Unity/Timeline_Cinemachine/CustomAudioAssetBGMInspector.PNG" alt="CustomAudioAssetBGMInspector"></p>
<p><img src="/img/Unity/Timeline_Cinemachine/CustomAudioAssetSoundInspector.PNG" alt="CustomAudioAssetSoundInspector"></p>
<p>从上面可以看到，我们通过ExposedReference<audiosource>的方式，挂载绑定了场景里的AudioSource作为背景音乐和音效播放组件。</audiosource></p>
<p>接下来为了避免每一个CustomAudioAsset都自己去指定AudioSource绑定组件，我们可以通过在CustomAudioTrack来支持在Track统一指定AudioSource。</p>
<p>CustomAudioTrack.cs</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> CustomAudioTrack.cs</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> 自定义音效Track</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line">[TrackClipType(<span class="keyword">typeof</span>(CustomAudioAsset))]</span><br><span class="line">[TrackBindingType(<span class="keyword">typeof</span>(AudioSource))]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CustomAudioTrack</span> : <span class="title">PlayableTrack</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>CustomAudioBehaviour.cs</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> CustomAudioBehaviour.cs</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> 自定义音效播放Behaviour</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CustomAudioBehaviour</span> : <span class="title">BaseGameBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    ******</span><br><span class="line">        </span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> 音效播放组件</span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> AudioSource mSourceAudio;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Called each frame while the state is set to Play</span></span><br><span class="line">    <span class="comment">// Playable更新执行时</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">ProcessFrame</span>(<span class="params">Playable playable, FrameData info, <span class="keyword">object</span> playerData</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(mSourceAudio == <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            mSourceAudio = playerData <span class="keyword">as</span> AudioSource;</span><br><span class="line">        &#125;</span><br><span class="line">        TryPlayAudio();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	******</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>CustomAudioTrack通过声明TrackBindingType(typeof(AudioSource))指定Track可以绑定AudioSource组件。</p>
<p>CustomAudioBehaviour通过在运行时ProcessFrame里动态使用Track上指定的AudioSource组件作为音乐播放组件来实现CustomAudioBehaviour采用Track统一绑定组件的的效果。</p>
<p><img src="/img/Unity/Timeline_Cinemachine/CustomAudioTrackWithAudioSourceBindingPreview.PNG" alt="CustomAudioTrackWithAudioSourceBindingPreview"></p>
<h3 id="进阶">进阶</h3><p><a href="https://www.jianshu.com/p/69e60a27bccb" target="_blank" rel="external">Unity使用Cinemachine和Timeline入门</a><br><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.3/manual/CinemachineTimeline.html" target="_blank" rel="external">Cinemachine and Timeline</a></p>
<p><a href="https://learn.unity.com/tutorial/cinemachine" target="_blank" rel="external">Cinemachine</a></p>
<p>Timeline可以看做是自定义展示效果的工具，而Cinemachine可以看做是多摄像机的一套完整控制表现的工具。</p>
<p>更多的Cinemachine学习见后面</p>
<h2 id="Cinemachine">Cinemachine</h2><p><a href="https://unity.com/unity/features/editor/art-and-design/cinemachine" target="_blank" rel="external">Powering cameras for films and games</a></p>
<p>根据官网的简单介绍可以看出，Cinemachine是官方出的一款摄像机强大的控制系统，通过该系统，我们可以轻松的做到电影或者游戏级别的摄像机功能以及表现。</p>
<p>博主这里考虑学习使用Cinemachine的一个重大原因是，做赛车游戏，希望有一个稳定(不抖动)跟随的摄像机。(自己写的效果有抖动问题)</p>
<p>Cinemachine里有两个重要的组件和概念:</p>
<ol>
<li>Cinemachine Brain</li>
<li>Virtual Cameras</li>
</ol>
<h3 id="Cinemachine_Brain">Cinemachine Brain</h3><p><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.3/manual/CinemachineOverview.html" target="_blank" rel="external">The Cinemachine Brain is a component in the Unity Camera itself. Cinemachine Brain monitors all active Virtual Cameras in the Scene. To specify the next live Virtual Camera, you <a href="https://docs.unity3d.com/Manual/DeactivatingGameObjects.html" target="_blank" rel="external">activate or deactivate</a> the desired Virtual Camera’s game object. </a></p>
<p>从上面的介绍可以看出，Cinemachine Brain组件式挂载在摄像机对象上的一个组件，负责管理所有Virual Camera，同一时间只有一个Virtual Camera起作用用于主摄像机，优先选择Priority高的已激活Virutal Camera作为当前起作用的摄像机，优先级相同的情况下看哪个Virtual Camera后激活优先。</p>
<p><img src="/img/Unity/Timeline_Cinemachine/CinemachineBrain.PNG" alt="CinemachineBrain"></p>
<p>关于Cinemachine Brain的详细参数介绍，这里就不深入探讨了，感兴趣的朋友参考文档去自行了解。</p>
<p>Note:</p>
<ol>
<li>Timeline重写了Cinemachine Brain的Priority系统可以更好的控制摄像机达到更精准的摄像机控制。</li>
</ol>
<h3 id="Virtual_Cameras">Virtual Cameras</h3><p><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.3/manual/CinemachineOverview.html" target="_blank" rel="external">Cinemachine does not create new cameras. Instead, it directs a single Unity camera for multiple shots. You compose these shots with <strong>Virtual Cameras</strong>. Virtual Cameras move and rotate the Unity camera and control its settings.</a></p>
<p>从上面的介绍可以知道，Cinemachine里的Virtual Cameras并非真正的Camera组件，而是一个抽象概念，而这个抽象的Virtuel Cameras会去负责控制真正的摄像机达到预定的效果。</p>
<p>每一个Virtual Cameras都会对应一个GameObject和一个CinemachineVirtualCamera组件脚本:</p>
<p><img src="/img/Unity/Timeline_Cinemachine/CinemachineVirtualCamera.PNG" alt="CinemachineVirtualCamera"></p>
<h4 id="Virtual_Camera_States">Virtual Camera States</h4><p>Virtual Camera有三种状态:</p>
<ol>
<li><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.1/manual/index.html" target="_blank" rel="external"><strong>Live</strong>:The virtual camera is actively controlling the Unity Camera. The virtual camera is tracking its targets and being updated every frame.</a></li>
<li><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.1/manual/index.html" target="_blank" rel="external"><strong>Standby</strong>: The virtual camera is tracking its targets and being updated every frame, but no Unity Camera is actively being controlled by it. This is the state of a virtual camera that is enabled in the scene but perhaps at a lower priority than the Live virtual camera.</a></li>
<li><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.1/manual/index.html" target="_blank" rel="external"><strong>Disabled</strong>: The virtual camera is present but disabled in the scene. It is not actively tracking its targets and so consumes no processing power. However, the virtual camera can be made live from the Timeline.</a></li>
</ol>
<p>从介绍可以看到Live是指当前Virtual Camera优先级最高起作用的那个。而Standby是优先级低于当前起作用的Virtual Camera但没有Disable的Virtual Camera，这些摄像机逻辑上依然会更新跟随自己设定的对象，但不会影响真实摄像机运作。最后Disabled是即低于当前最高优先级Virtual Camera也没有激活的Virtual Camera，这类摄像机不会有任何运行开销，逻辑层面也不会在继续跟随自己的目标对象。</p>
<h4 id="Virtual_Camera_Params">Virtual Camera Params</h4><p>关于Virtual Camera的细节参数学习，接下来学习几个重要的参数，更多的细节参考:</p>
<p><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.3/manual/CinemachineOverview.html" target="_blank" rel="external">Cinemachine overview</a></p>
<p><strong>Priority</strong>正如前面提到的，决定了Virtual Camera在Cinemachine Brain里的选择优先级。</p>
<p><strong>Follow</strong>和<strong>Look At</strong>两个参数分别决定了摄像机的跟随对象和对焦对象，这两个参数是常规游戏类型里都需要的概念，好比博主当前要做的赛车游戏，Follow和Look At对象都是赛车就能做到跟随和聚焦赛车的效果。</p>
<p><strong>Body</strong>属性提供了Virtual Camera对于摄像机移动的算法选择，从而达到适配各种游戏类型的摄像机镜头移动要求。</p>
<p><img src="/img/Unity/Timeline_Cinemachine/CinemachineBodyProperties.PNG" alt="CinemachineBodyProperties"></p>
<p>这里博主的赛车游戏默认选择Transposer来达到平滑跟随效果。</p>
<p><strong>Aim</strong>属性提供了Virtual Camera对于佘香即旋转的算法选择，从而达到适配各种游戏类型的摄像机镜头选择要求。</p>
<p><img src="/img/Unity/Timeline_Cinemachine/CinemachineAimProperties.PNG" alt="CinemachineAimProperties"></p>
<p><strong>Body</strong>和<strong>Aim</strong>通过细节的参数调整能实现各种角度以及各种游戏类型需求的摄像机跟随聚焦效果，这里博主暂时就不深入学习讨论了，有兴趣的可以参考文档去了解细节。</p>
<p>那么Virtual Camera的聚焦效果是如何实现的了？</p>
<p>了解聚焦效果之前有几个重钙的概念需要了解:</p>
<ol>
<li><p><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.3/manual/CinemachineOverview.html" target="_blank" rel="external"><strong>Dead zone</strong>: The area of the frame that Cinemachine keeps the target in.</a></p>
</li>
<li><p><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.3/manual/CinemachineOverview.html" target="_blank" rel="external"><strong>Soft zone</strong>: If the target enters this region of the frame, the camera will re-orient to put it back in the dead zone. It will do this slowly or quickly, according to the time specified in the Damping settings.</a></p>
</li>
<li><p><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.3/manual/CinemachineOverview.html" target="_blank" rel="external"><strong>Screen</strong>: The screen position of the center of the dead zone. 0.5 is the center of the screen.</a></p>
</li>
<li><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.3/manual/CinemachineOverview.html" target="_blank" rel="external"><strong>Damping</strong>: Simulates the lag that a real camera operator introduces while operating a heavy physical camera. Damping specifies quickly or slowly the camera reacts when the target enters the <strong>soft zone</strong> while the camera tracks the target. Use small numbers to simulate a more responsive camera, rapidly moving or aiming the camera to keep the target in the <strong>dead zone</strong>. Larger numbers simulate heavier cameras, The larger the value, the more Cinemachine allows the target to enter the soft zone.</a></li>
</ol>
<p><img src="/img/Unity/Timeline_Cinemachine/CinemachineZone.PNG" alt="CinemachineZone"></p>
<p>Dead Zone, Soft Zone, Screen参数在Body和Aim的属性面板上有体现，他们决定了摄像机是如何应对Look At对象走出指定区域时响应变化以及如何确保Look At对象在指定区域内的。</p>
<h3 id="Cinemachine_Camera_Types">Cinemachine Camera Types</h3><p>Unity Cinemachine自带了很多种摄像机用于不同的游戏种类:</p>
<p><img src="/img/Unity/Timeline_Cinemachine/CinemachineCameraTypes.PNG" alt="CinemachineCameraTypes"></p>
<p>不同的摄像机种类适用于不同的游戏类型。</p>
<h4 id="Virtual_Camera">Virtual Camera</h4><p>Virtual Camera在前面的介绍已经提过了，这里就不再重复了，后续的摄像机类型大部分也是基于Virtual Camera的，只是在Virtual Camera的基础上实现了一套各自摄像机管理方式从而达到不同的摄像机类型效果。</p>
<h4 id="FreeLook_Camera">FreeLook Camera</h4><p>此类摄像机没有基于Virtual Camera而是单独挂载了一个Cinemachine Free Look的脚本实现的。</p>
<p><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.1/manual/index.html#collision-avoidance-and-shot-evaluation" target="_blank" rel="external">A Cinemachine Camera geared towards a 3rd person camera experience. The camera orbits around its subject with three separate camera rigs defining rings around the target. Each rig has its own radius, height offset, composer, and lens settings. Depending on the camera’s position along the spline connecting these three rigs, these settings are interpolated to give the final camera position and state.</a></p>
<p>从介绍可以看出，FreeLook Camera是用于第三人称围绕目标对象旋转控制的一套摄像机类型(比如第三人称RPG等游戏，有围绕主角相关的摄像机旋转控制等)。</p>
<h4 id="State-Driven_Camera">State-Driven Camera</h4><p>这里的State指的是Animator里的State，通过State-Drive Camera我们可以轻易的实现Animator State和Virtual Camera选择的绑定。这样就能轻易实现Walk状态用什么Virtual Camera，Idle状态使用什么Virtual Camera的效果。</p>
<p>更多的摄像机类型参考:</p>
<p><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.1/manual/index.html" target="_blank" rel="external">About Cinemachine</a></p>
<p>这里还值得一提的是摄像机限定移动范围和摄像机被障碍物主档导致目标对象不可见时Cinemachine提供的一种解决方案：</p>
<h3 id="Collision_Avoidance_and_Shot_Evaluation">Collision Avoidance and Shot Evaluation</h3><h4 id="CinemachineCollider">CinemachineCollider</h4><p><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.1/manual/index.html#collision-avoidance-and-shot-evaluation" target="_blank" rel="external">An add-on module for Cinemachine Virtual Camera that post-processes the final position of the virtual camera. Based on the supplied settings, the Collider will attempt to preserve the line of sight with the LookAt target of the virtual camera by moving away from objects that will obstruct the view.</a></p>
<p>简单来说CinemachineCollider是通过相关设置，通过射线检测评估出当前摄像机最优的位置，从而避免被障碍物遮挡视线等问题。</p>
<p>Note:</p>
<ol>
<li><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.1/manual/index.html#collision-avoidance-and-shot-evaluation" target="_blank" rel="external">The collider uses Physics Raycasts to do these things, hence obstacles in the scene must have collider volumes in order to be visible to the CinemachineCollider.</a></li>
</ol>
<h4 id="CinemachineConfiner">CinemachineConfiner</h4><p><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.1/manual/index.html#collision-avoidance-and-shot-evaluation" target="_blank" rel="external">An add-on module for Cinemachine Virtual Camera that post-processes the final position of the virtual camera. It will confine the virtual camera’s position to the volume specified in the Bounding Volume field.</a></p>
<p>从介绍可以看出CinemachineConfiner相比CinemachineCollider，这是一个单纯限制摄像机运动范围的组件，更加轻量，没有过多多射线检测评估等过程，用于简单的限制摄像机运动范围，此组件更佳。</p>
<p>Note:</p>
<ol>
<li><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.1/manual/index.html#collision-avoidance-and-shot-evaluation" target="_blank" rel="external">This is less resource-intensive than CinemachineCollider, but it does not perform shot evaluation.</a></li>
</ol>
<h3 id="实战">实战</h3><p>实战前，先让我们明确下个人的摄像机需求，需求明确了才能更加正确的使用Cinemachine达到效果。</p>
<p>摄像机需求:</p>
<ol>
<li>支持相机单独控制操作</li>
<li>支持相机限定移动范围操作</li>
<li>支持相机锁定目标操作</li>
<li>支持相机锁定目标和自由操作自由切换操作</li>
<li>支持相机锁定目标操作回调上层逻辑(用于配合逻辑层做事情)</li>
<li>场景摄像机支持多个摄像机同时控制(比如:MainCamera和3D UI Camera)</li>
</ol>
<p>待续……</p>
<h2 id="TextMeshPro">TextMeshPro</h2><h3 id="What-1">What</h3><p><a href="https://docs.unity3d.com/Manual/com.unity.textmeshpro.html" target="_blank" rel="external">TextMesh Pro is the ultimate text solution for Unity. It’s the perfect replacement for Unity’s UI Text and the legacy Text Mesh.</a></p>
<p>TextMeshPro原本是第三方个人编写的一款更优的Unity文本替代方案，后被Unity官方收购。</p>
<h3 id="Why-1">Why</h3><p>使用TextMeshPro替代原生文本的原因有很多：</p>
<ol>
<li>TMP使用了SDF(<strong>Signed Distance Field</strong>)技术达到不失真的放大缩小渲染</li>
<li>TMP自带实现了图文混排(通过富文本打Tag的形式)以及很多文本所需的功能(e.g. 字间距，自定义字体大小，段落格式，对齐方式等)</li>
<li>TMP使用Shader去实现更好的文本表现效果(类似PS的一些效果)满足文本需求</li>
</ol>
<p>缺点:</p>
<ol>
<li>不支持动态字体(看网上说是TMP1.4支持动态字体(Generating Settings)，但我在Unity2018.4.1.f1上导入的TMP没有找到动态字体设置的入口，望知道的朋友告知一声在哪里设置)，需要生成对应的字体纹理库(对于文字多的比如中文来说有很大的内存压力)</li>
</ol>
<p>SDF(<strong>Signed Distance Field</strong>)介绍:<br><a href="http://www.sardinefish.com/blog/?pid=296" target="_blank" rel="external">一个空间区域的SDF函数定义为，从空间中任意给定的一点到该区域边界的距离，SDF函数值的符号取决于该点在区域的内部还是外部，外部为正，内部为负。</a></p>
<p>这里可以简单的理解成TMP通过函数式的定义方式(类似矢量图的定义方式)来解决像素图放大模糊的问题来渲染出可动态放大缩小不模糊的图像。深入理解参考下面的链接：<a href="http://www.sardinefish.com/blog/?pid=296" target="_blank" rel="external">函数式编程与 Signed Distance Field</a></p>
<h3 id="How-1">How</h3><p>TMP需要通过TMP提供的字体库制作工具制作所需的对应字体文件：<br><img src="/img/Unity/TextMeshPro/FontAssetCreatePanel.png" alt="FontAssetCreatePanel"><br>如果想要使用图文混排还需要自己制作SpriteAsset:<br><img src="/img/Unity/TextMeshPro/SpriteAssetCreatePanel.png" alt="SpriteAssetCreatePanel"><br>制作好后创建TextMeshPro组件后指定需要使用的Font Asset和Sprite Asset即可:<br><img src="/img/Unity/TextMeshPro/TextMeshProAssignFontAssetAndSpriteAsset.png" alt="TextMeshProAssignFontAssetAndSpriteAsset"></p>
<p>最终效果：<br><img src="/img/Unity/TextMeshPro/TextMeshProUsing.png" alt="TextMeshProUsing"><br>TextMeshPro同一个Font Asset需要制作不同的渲染效果需要通过制作不同的Material来实现：<br><img src="/img/Unity/TextMeshPro/CreateFontAssetMaterial.png" alt="CreateFontAssetMaterial"></p>
<p>然后在针对新创建的Material Asset调整Shader和具体效果即可，创建完成后就可以在Font Asset的材质下拉列表里选择需要使用的效果：<br><img src="/img/Unity/TextMeshPro/FontAssetMaterialChosen.png" alt="FontAssetMaterialChosen"></p>
<p>关于TextMeshPro的默认相关设置(e.g. 默认创建的Font Asset，默认Fallback到的Font Asset等)是通过TMP Settings文件里的设置来完成的:<br><img src="/img/Unity/TextMeshPro/TMPSettings.png" alt="TMPSettings"></p>
<p>Note:</p>
<ol>
<li>TMP的Fallback的使用是在原始设定的Font Asset里找不到对应文字时的一种回退安全机制，官方的建议是真正使用的Font Asset采用高分率图集，Fallback的Font Asset采用低分辨率图集。</li>
</ol>
<h1 id="引用">引用</h1><h2 id="Sprite_Atlas-1">Sprite Atlas</h2><p><a href="https://docs.unity3d.com/Manual/class-SpriteAtlas.html" target="_blank" rel="external">Sprite Atlas</a><br><a href="https://docs.unity3d.com/Manual/MasterVariantAtlases.html" target="_blank" rel="external">Master and Variant Sprite Atlases</a><br><a href="https://docs.unity3d.com/Manual/VariantSpriteAtlas.html" target="_blank" rel="external">Variant Sprite Atlas</a><br><a href="https://docs.unity3d.com/Manual/SpriteAtlasWorkflow.html" target="_blank" rel="external">Sprite Atlas workflow</a><br><a href="https://docs.unity3d.com/Manual/SpriteAtlasDistribution.html" target="_blank" rel="external">Preparing Sprite Atlases for distribution</a><br><a href="https://docs.unity3d.com/Manual/SpritePackerModes.html" target="_blank" rel="external">Sprite Packer Modes</a><br><a href="https://gameinstitute.qq.com/community/detail/127434" target="_blank" rel="external">Unity2017新功能之Sprite Atlas详解</a><br><a href="https://zhuanlan.zhihu.com/p/80584461" target="_blank" rel="external">UGUI的图集处理方式-SpriteAtlas的前世今生</a></p>
<h2 id="Timeline-1">Timeline</h2><p><a href="https://blog.csdn.net/qq826364410/article/details/80511057" target="_blank" rel="external">Unity—Timeline自定义PlayableTrack</a><br><a href="https://blog.csdn.net/beihuanlihe130/article/details/79233320" target="_blank" rel="external">Unity2017中Timeline的简单使用方法</a><br><a href="https://www.jianshu.com/p/69e60a27bccb" target="_blank" rel="external">Unity使用Cinemachine和Timeline入门</a></p>
<p><a href="https://github.com/Unity-Technologies/graph-visualizer" target="_blank" rel="external">graph-visualizer</a></p>
<p><a href="https://learn.unity.com/tutorial/timeline#" target="_blank" rel="external">Timeline</a></p>
<p><a href="https://blog.unity.com/technology/extending-timeline-a-practical-guide" target="_blank" rel="external"><strong>xtending Timeline: A Practical Guide</strong></a></p>
<p><a href="https://blog.unity.com/technology/creative-scripting-for-timeline" target="_blank" rel="external"><strong>Creative Scripting for Timeline</strong></a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzU5MjQ1NTEwOA==&amp;mid=2247493316&amp;idx=1&amp;sn=7e4fef834a8066faca3d2f1f1a090bb4&amp;chksm=fe1dd26fc96a5b79856840f556cf65026facb83520ac1891605e42d5e777d30a0d5219060e21&amp;mpshare=1&amp;scene=1&amp;srcid=0606YJLYnfprk9UjpPQCnre1#rd" target="_blank" rel="external">Playable API：定制你的动画系统</a></p>
<p><a href="https://docs.unity3d.com/Manual/Playables.html" target="_blank" rel="external">Playables API</a></p>
<p><a href="https://docs.unity3d.com/Manual/Playables-Graph.html" target="_blank" rel="external">The PlayableGraph</a></p>
<p><a href="https://docs.unity3d.com/Manual/Playables-ScriptPlayable.html" target="_blank" rel="external">ScriptPlayable and PlayableBehaviour</a></p>
<p><a href="https://docs.unity3d.com/Manual/Playables-Examples.html" target="_blank" rel="external">Playables Examples</a></p>
<h2 id="TextMesh_Pro">TextMesh Pro</h2><p><a href="https://docs.unity3d.com/Manual/com.unity.textmeshpro.html" target="_blank" rel="external">TextMesh Pro</a><br><a href="http://www.sardinefish.com/blog/?pid=296" target="_blank" rel="external">函数式编程与 Signed Distance Field</a><br><a href="https://zhuanlan.zhihu.com/p/84700094" target="_blank" rel="external">Unity游戏开发——TextMeshPro的使用</a><br><a href="https://mp.weixin.qq.com/s?__biz=MzU5MjQ1NTEwOA==&amp;mid=2247495323&amp;idx=1&amp;sn=3100249c5c4a88c20435d129d23eb727&amp;chksm=fe1dda30c96a53267a53ed2bc0dd47bc73273f4e76f3a0d8f0ce322992e2e7e0b284d9a1df32&amp;mpshare=1&amp;scene=1&amp;srcid=102134Bhmm1T67EKpzswm7mz#rd" target="_blank" rel="external">在Unity 2018中充分使用TextMesh Pro</a><br><a href="https://blogs.unity3d.com/2018/10/16/making-the-most-of-textmesh-pro-in-unity-2018/" target="_blank" rel="external">Making the most of TextMesh Pro in Unity 2018</a></p>
<h2 id="Cinemachine-1">Cinemachine</h2><p><a href="https://docs.unity3d.com/Packages/com.unity.cinemachine@2.3/manual/CinemachineOverview.html" target="_blank" rel="external">Cinemachine overview</a></p>
<p><a href="https://learn.unity.com/tutorial/cinemachine#" target="_blank" rel="external">Cinemachine Learn</a></p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/Unity/">Unity</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://tonytang1990.github.io/2019/11/25/Unity官方插件/" data-title="Unity官方插件 | 走停人生路" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2020/02/01/Unity嵌套预制件/" title="Unity嵌套预制件">
  <strong>上一篇：</strong><br/>
  <span>
  Unity嵌套预制件</span>
</a>
</div>


<div class="next">
<a href="/2019/05/20/网络通信和服务器学习/"  title="网络通信和服务器学习">
 <strong>下一篇：</strong><br/> 
 <span>网络通信和服务器学习
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2019/11/25/Unity官方插件/" data-title="Unity官方插件" data-url="http://tonytang1990.github.io/2019/11/25/Unity官方插件/"></div>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="顯示側邊欄"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目錄</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Sprite_Atlas"><span class="toc-number">1.1.</span> <span class="toc-text">Sprite Atlas</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#What"><span class="toc-number">1.1.1.</span> <span class="toc-text">What</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Why"><span class="toc-number">1.1.2.</span> <span class="toc-text">Why</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How"><span class="toc-number">1.1.3.</span> <span class="toc-text">How</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#创建、编辑图集以及设定图集参数"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">创建、编辑图集以及设定图集参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#添加图集Variant（变种）"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">添加图集Variant（变种）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#运行时访问图集"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">运行时访问图集</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Later_Bind"><span class="toc-number">1.1.3.3.1.</span> <span class="toc-text">Later Bind</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#注意事项"><span class="toc-number">1.1.3.3.2.</span> <span class="toc-text">注意事项</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#相关概念"><span class="toc-number">1.1.3.3.3.</span> <span class="toc-text">相关概念</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Bug记录"><span class="toc-number">1.1.3.3.4.</span> <span class="toc-text">Bug记录</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#结论"><span class="toc-number">1.1.3.3.5.</span> <span class="toc-text">结论</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Timeline"><span class="toc-number">1.2.</span> <span class="toc-text">Timeline</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Timeline_Asset"><span class="toc-number">1.2.1.</span> <span class="toc-text">Timeline Asset</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#介绍"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#分类"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">分类</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Playable_Track"><span class="toc-number">1.2.1.2.1.</span> <span class="toc-text">Playable Track</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Timeline_instance"><span class="toc-number">1.2.2.</span> <span class="toc-text">Timeline instance</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#介绍-1"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">介绍</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Timeline类设计"><span class="toc-number">1.2.3.</span> <span class="toc-text">Timeline类设计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Playable"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">Playable</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PlayableGraph"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">PlayableGraph</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PlayableAsset"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">PlayableAsset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PlayableBehaviour"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">PlayableBehaviour</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PlayableOutput"><span class="toc-number">1.2.3.5.</span> <span class="toc-text">PlayableOutput</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PlayableBinding"><span class="toc-number">1.2.3.6.</span> <span class="toc-text">PlayableBinding</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ExposedReference"><span class="toc-number">1.2.3.7.</span> <span class="toc-text">ExposedReference</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#辅助工具(GraphVisualizer)"><span class="toc-number">1.2.3.8.</span> <span class="toc-text">辅助工具(GraphVisualizer)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#单AnimationClip单AniamtionOuput的动画播放"><span class="toc-number">1.2.3.8.1.</span> <span class="toc-text">单AnimationClip单AniamtionOuput的动画播放</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#多AnimationClip混合"><span class="toc-number">1.2.3.8.2.</span> <span class="toc-text">多AnimationClip混合</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#多AnimationClip多AnimationOuput"><span class="toc-number">1.2.3.8.3.</span> <span class="toc-text">多AnimationClip多AnimationOuput</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#多AnimationClip混合并控制权重加播放状态"><span class="toc-number">1.2.3.8.4.</span> <span class="toc-text">多AnimationClip混合并控制权重加播放状态</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Timeline实战"><span class="toc-number">1.2.4.</span> <span class="toc-text">Timeline实战</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#进阶"><span class="toc-number">1.2.5.</span> <span class="toc-text">进阶</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cinemachine"><span class="toc-number">1.3.</span> <span class="toc-text">Cinemachine</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cinemachine_Brain"><span class="toc-number">1.3.1.</span> <span class="toc-text">Cinemachine Brain</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Virtual_Cameras"><span class="toc-number">1.3.2.</span> <span class="toc-text">Virtual Cameras</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Virtual_Camera_States"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">Virtual Camera States</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Virtual_Camera_Params"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">Virtual Camera Params</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cinemachine_Camera_Types"><span class="toc-number">1.3.3.</span> <span class="toc-text">Cinemachine Camera Types</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Virtual_Camera"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">Virtual Camera</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#FreeLook_Camera"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">FreeLook Camera</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#State-Driven_Camera"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">State-Driven Camera</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Collision_Avoidance_and_Shot_Evaluation"><span class="toc-number">1.3.4.</span> <span class="toc-text">Collision Avoidance and Shot Evaluation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CinemachineCollider"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">CinemachineCollider</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CinemachineConfiner"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">CinemachineConfiner</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实战"><span class="toc-number">1.3.5.</span> <span class="toc-text">实战</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TextMeshPro"><span class="toc-number">1.4.</span> <span class="toc-text">TextMeshPro</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#What-1"><span class="toc-number">1.4.1.</span> <span class="toc-text">What</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Why-1"><span class="toc-number">1.4.2.</span> <span class="toc-text">Why</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-1"><span class="toc-number">1.4.3.</span> <span class="toc-text">How</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#引用"><span class="toc-number">2.</span> <span class="toc-text">引用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Sprite_Atlas-1"><span class="toc-number">2.1.</span> <span class="toc-text">Sprite Atlas</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Timeline-1"><span class="toc-number">2.2.</span> <span class="toc-text">Timeline</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TextMesh_Pro"><span class="toc-number">2.3.</span> <span class="toc-text">TextMesh Pro</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cinemachine-1"><span class="toc-number">2.4.</span> <span class="toc-text">Cinemachine</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隱藏側邊欄"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分類</p>
		<ul>
		
		  
			<li><a href="/categories/Algorithm/" title="Algorithm">Algorithm<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android/" title="Android">Android<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Automation/" title="Automation">Automation<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Editor/" title="Editor">Editor<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Game-Engine/" title="Game_Engine">Game_Engine<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Programming-Language/" title="Programming Language">Programming Language<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Rendering/" title="Rendering">Rendering<sup>3</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">標簽</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Unity/" title="Unity">Unity<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Resource/" title="Resource">Resource<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/OpenGL/" title="OpenGL">OpenGL<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/AI/" title="AI">AI<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Editor/" title="Editor">Editor<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/VersionControl/" title="VersionControl">VersionControl<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/HotUpdate/" title="HotUpdate">HotUpdate<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Math/" title="Math">Math<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Sort/" title="Sort">Sort<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Optimization/" title="Optimization">Optimization<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/GameDesignPattern/" title="GameDesignPattern">GameDesignPattern<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Art/" title="Art">Art<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Prefab/" title="Prefab">Prefab<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Rendering/" title="Rendering">Rendering<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Network/" title="Network">Network<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Shader/" title="Shader">Shader<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/UI/" title="UI">UI<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Programming/" title="Programming">Programming<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Android/" title="Android">Android<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情鏈接</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 訂閱</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Tony Tang. <br/>
			This is my new blog.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2021 
		
		<a href="/about" target="_blank" title="Tony Tang">Tony Tang</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"TonyTang1990"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回頂部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
